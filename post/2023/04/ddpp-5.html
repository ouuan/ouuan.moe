<!DOCTYPE html><html lang="zh-CN"><head>
    <meta charset="UTF-8">
<title>DDPP 第五章学习笔记 - ouuan's blog</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="DDPP5 第五章 “Verilog Hardware Description Language” 的学习笔记。
也就是初学 (System)Verilog 的笔记。">
<meta property="og:url" content="https://ouuan.moe/post/2023/04/ddpp-5">
<meta property="og:site_name" content="ouuan's blog">
<meta property="og:title" content="DDPP 第五章学习笔记 · ouuan's blog">
<meta property="og:description" content="DDPP5 第五章 “Verilog Hardware Description Language” 的学习笔记。
也就是初学 (System)Verilog 的笔记。">
<meta property="twitter:domain" content="ouuan.moe">
<meta property="twitter:title" content="DDPP 第五章学习笔记 · ouuan's blog">
<meta property="twitter:description" content="DDPP5 第五章 “Verilog Hardware Description Language” 的学习笔记。
也就是初学 (System)Verilog 的笔记。">
<meta property="twitter:url" content="https://ouuan.moe/post/2023/04/ddpp-5">
<style>html:not(.dark):not(.light) { visibility: hidden; } body { visibility: hidden; }</style>
<script>(() => { let dark; try { const theme = localStorage && localStorage.getItem('vueuse-color-scheme'); if (theme === 'dark') dark = true; else if (theme === 'light') dark = false; else dark = window.matchMedia('(prefers-color-scheme: dark)').matches; } catch (e) { dark = false; } document.documentElement.classList.add(dark ? 'dark' : 'light'); })()</script>
<noscript><style>@media (prefers-color-scheme: light) { :root:not(.dark):not(.light) { color-scheme: light; --text-color: #232637; --bg-color: #DEE6EE; --card-color: #EFF3F7; --link-color: #1E66B8; --hover-color: #2E80DD; --active-color: #164C89; --bghover-color: #D6E0EA; --popup-color: #F7F9FB; --footer-color: #5F627B; --area-color: #E1E2E8; --nested-color: #F0F0F3; } } @media (prefers-color-scheme: dark) { :root:not(.dark):not(.light) { color-scheme: dark; --text-color: #E6EDF2; --bg-color: #0D0E15; --card-color: #1F2130; --link-color: #8BB8EC; --hover-color: #A2C6F0; --active-color: #74AAE8; --bghover-color: #353853; --popup-color: #2C2F45; --footer-color: #9699AE; --area-color: #2F313D; --nested-color: #3C3E4E; } } html { visibility:visible !important; }</style></noscript>
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="canonical" href="https://ouuan.moe/post/2023/04/ddpp-5">
<link rel="alternate" type="application/rss+xml" href="/feed.xml" title="RSS Feed - ouuan's blog">
<link rel="alternate" type="application/atom+xml" href="/feed.atom" title="Atom Feed - ouuan's blog">
<link rel="alternate" type="application/json" href="/feed.json" title="JSON Feed - ouuan's blog">
<link rel="dns-prefetch" href="https://plausible.ouuan.moe">
<link rel="preconnect" href="https://blog-visitor-count.ouuan.moe">
<link rel="stylesheet" href="/vendors/katex/katex.css">
<link rel="sitemap" href="https://ouuan.moe/sitemap.xml">
<meta name="author" content="ouuan">
<meta name="twitter:creator" content="@ouuan">
<meta name="twitter:card" content="summary">
<meta property="og:image" content="https://ouuan.moe/images/2023/04/ddpp-5.png">
<meta property="generator" content="îles">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-04-29T16:24:36.000Z">
<meta property="article:modified_time" content="2023-04-29T16:24:36.000Z">
<meta property="article:author" content="ouuan">
<meta property="article:tag" content="ddpp">
<meta property="article:tag" content="学习笔记">
<link rel="preconnect" href="https://giscus.app">
<link rel="dns-prefetch" href="https://avatars.githubusercontent.com">
    <link rel="stylesheet" href="/assets/style-9a87bfec.css">
    
  <link rel="modulepreload" href="/assets/iles.e30597ee.js" crossorigin=""><link rel="modulepreload" href="/assets/vendor-vue.f543892e.js" crossorigin=""><link rel="modulepreload" href="/assets/vite.5ce4fca4.js" crossorigin=""><link rel="modulepreload" href="/assets/SearchBar.3bec00c3.js" crossorigin=""><link rel="modulepreload" href="/assets/PostHead.f34853a3.js" crossorigin=""><link rel="modulepreload" href="/assets/VisitorCount.b65d15cd.js" crossorigin=""><link rel="modulepreload" href="/assets/site.0440d0dc.js" crossorigin=""><link rel="modulepreload" href="/assets/GiscusCommentsInner.cc959b9e.js" crossorigin=""><link rel="modulepreload" href="/assets/useTheme.84274661.js" crossorigin=""><link rel="modulepreload" href="/assets/TableOfContents.a1f1ec5b.js" crossorigin=""><style>@font-face { font-family: "Noto Serif SC Web Font"; font-weight: 400; font-style: normal; font-display: swap; src: url('/assets/fonts/NotoSerifSC-Regular.unique.fdef167b.woff2') format('woff2'), url('/assets/fonts/NotoSerifSC-Regular.unique.45e6d626.woff') format('woff'); unicode-range: U+0-9ed8; } @font-face { font-family: "Noto Serif SC Web Font"; font-weight: 400; font-style: normal; font-display: swap; src: url('/assets/fonts/NotoSerifSC-Regular.common.e2282ae2.woff2') format('woff2'), url('/assets/fonts/NotoSerifSC-Regular.common.521c3682.woff') format('woff'); unicode-range: U+0-ff1b; } @font-face { font-family: "Noto Serif SC Web Font"; font-weight: 700; font-style: normal; font-display: swap; src: url('/assets/fonts/NotoSerifSC-Bold.unique.82f5d44d.woff2') format('woff2'), url('/assets/fonts/NotoSerifSC-Bold.unique.daa00b4e.woff') format('woff'); unicode-range: U+0-9879; } @font-face { font-family: "Noto Serif SC Web Font"; font-weight: 700; font-style: normal; font-display: swap; src: url('/assets/fonts/NotoSerifSC-Bold.common.bbdbde9e.woff2') format('woff2'), url('/assets/fonts/NotoSerifSC-Bold.common.ee74a68c.woff') format('woff'); unicode-range: U+0-8868; }</style><link rel="preload" href="/assets/fonts/NotoSerifSC-Regular.unique.fdef167b.woff2" as="font" type="font/woff2" crossorigin=""><link rel="preload" href="/assets/fonts/NotoSerifSC-Regular.common.e2282ae2.woff2" as="font" type="font/woff2" crossorigin=""><link rel="preload" href="/assets/fonts/NotoSerifSC-Bold.unique.82f5d44d.woff2" as="font" type="font/woff2" crossorigin=""><link rel="preload" href="/assets/fonts/NotoSerifSC-Bold.common.bbdbde9e.woff2" as="font" type="font/woff2" crossorigin=""></head>
  <body itemscope="" itemtype="https://schema.org/ItemPage">
    <div id="app"><header class="bg-card shadow print:hidden" itemprop="hasPart" itemscope="" itemtype="https://schema.org/WPHeader"><div class="flex flex-wrap justify-center whitespace-nowrap px-4 page-container sm:flex-nowrap"><div class="flex basis-full items-stretch justify-center sm:mr-3 sm:basis-auto"><a class="flex items-center p-3 text-xl font-serif bghover" href="/"><span>ouuan<span class="mojikumi-narrow-left">’</span>s blog</span></a></div><nav class="flex"><ul class="flex"><li class="flex flex-1 items-stretch justify-center"><a class="flex items-center p-3 bghover" href="/"><span>首页</span></a></li><li class="flex flex-1 items-stretch justify-center"><a class="flex items-center p-3 bghover" href="/posts"><span>文章</span></a></li><li class="flex flex-1 items-stretch justify-center"><a class="flex items-center p-3 bghover" href="/tags"><span>标签</span></a></li><li class="flex flex-1 items-stretch justify-center"><a class="flex items-center p-3 bghover" href="/about"><span>关于</span></a></li></ul></nav><div class="sm:basis-full"></div><ul class="flex"><li class="flex"><ile-root id="ile-1"><div class="flex items-stretch lg:hidden"><a class="flex items-center p-2 bghover" href="/search" title="全站搜索"><span class="i-mdi-magnify text-xl"></span></a></div><form role="search" class="hidden items-stretch justify-center lg:flex"><div class="flex items-center"><input value="" class="w-48 rd-full bg-area px-3 py-1" type="search" placeholder="关键词" aria-label="全站搜索"></div><a class="flex items-center p-2 bghover" href="/search?q=" title="全站搜索"><span class="i-mdi-magnify text-xl"></span></a></form></ile-root><script></script><script type="module" async="">import{h as r,c as a}from"/assets/iles.e30597ee.js";import{_ as m}from"/assets/SearchBar.3bec00c3.js";import"/assets/vendor-vue.f543892e.js";import"/assets/vite.5ce4fca4.js";r(a,m,"ile-1",{},{});
</script></li><li class="flex items-stretch"><a class="flex items-center p-2 bghover" href="/feed.xml" title="RSS 订阅"><span class="i-mdi-rss text-xl"></span></a></li><li class="flex"><ile-root id="ile-2"><div class="relative flex items-stretch"><button title="暗色模式设置" class="flex items-center p-2 bghover" aria-haspopup="menu" aria-controls="__theme-switcher" aria-expanded="false"><span class="i-mdi-theme-light-dark text-xl"></span></button><ul style="display:none;" id="__theme-switcher" class="absolute right-0 top-full z-20 whitespace-nowrap rd-1 bg-popup shadow-md" role="menu" aria-label="暗色模式选项"><li class="bghover" role="menuitemradio" aria-checked="true"><button class="flex items-center p-1 text-hover"><span class="i-mdi-cellphone md:i-mdi-tablet lg:i-mdi-monitor mr-1"></span><span>跟随系统</span></button></li><li class="bghover" role="menuitemradio" aria-checked="false"><button class="flex items-center p-1"><span class="i-mdi-white-balance-sunny mr-1"></span><span>总是亮色</span></button></li><li class="bghover" role="menuitemradio" aria-checked="false"><button class="flex items-center p-1"><span class="i-mdi-weather-night mr-1"></span><span>总是暗色</span></button></li></ul></div></ile-root><script></script><script type="module" async="">var p=(o,a)=>()=>(a||o((a={exports:{}}).exports,a),a.exports);var r=(o,a,_)=>new Promise((c,n)=>{var f=t=>{try{e(_.next(t))}catch(i){n(i)}},l=t=>{try{e(_.throw(t))}catch(i){n(i)}},e=t=>t.done?c(t.value):Promise.resolve(t.value).then(f,l);e((_=_.apply(o,a)).next())});import{_ as d}from"/assets/vite.5ce4fca4.js";import{a as s}from"/assets/iles.e30597ee.js";import"/assets/vendor-vue.f543892e.js";var E=p(m=>{const u=()=>r(m,null,function*(){return(yield d(()=>import("/assets/iles.e30597ee.js").then(o=>o.v),["assets/iles.e30597ee.js","assets/vendor-vue.f543892e.js","assets/vite.5ce4fca4.js"])).default}),v=()=>r(m,null,function*(){return(yield d(()=>import("/assets/ThemeSwitcher.358e828c.js"),["assets/ThemeSwitcher.358e828c.js","assets/vendor-vue.f543892e.js","assets/vite.5ce4fca4.js","assets/useTheme.84274661.js"])).default});s(u,v,"ile-2",{},{})});export default E();
</script></li></ul></div></header><main class="min-h-100vh py-6 page-container" itemprop="mainContentOfPage" itemscope="" itemtype="https://schema.org/WebPageElement"><div class="flex justify-center"><div class="grow m-4 standard-card max-w-200"><article itemprop="mainEntity" itemscope="" itemtype="https://schema.org/BlogPosting"><div class="hidden" itemscope="" itemtype="https://schema.org/Person" itemprop="author"><meta itemprop="name" content="ouuan"><meta itemprop="givenName" content="Yufan"><meta itemprop="familyName" content="You"><meta itemprop="url" content="https://github.com/ouuan"><link itemprop="gender" href="https://schema.org/Male"><meta itemprop="image" content="/android-chrome-512x512.png"></div><meta itemprop="inLanguage" content="zh-CN"><meta itemprop="mainEntityOfPage" content="https://ouuan.moe/post/2023/04/ddpp-5"><meta itemprop="image" content="https://ouuan.moe/images/2023/04/ddpp-5.png"><ile-root id="ile-3" class="my-12"><header class="my-12" data-v-2045e486=""><h1 class="mb-3 mt-6 text-center text-8" itemprop="headline" data-v-2045e486=""><span class="inline-block font-serif break-anywhere" data-v-2045e486=""><span data-v-2045e486="" data-v-6544d8e8="">DDPP 第五章学习笔记</span></span></h1><div class="flex flex-wrap justify-center gap-x-4 gap-y-1 text-footer md:text-sm" data-v-2045e486=""><span class="flex items-center" title="创建于 2023-04-06 16:52:53 GMT+8" data-v-2045e486=""><span class="i-mdi-folder-plus-outline mr-1" data-v-2045e486=""></span><span class="sr-only" data-v-2045e486="">创建于</span><a class="hover:underline" href="https://github.com/ouuan/iles-blog/blob/master/src/pages/post/2023/04/ddpp-5.mdx?plain=1" data-v-2045e486=""><time datetime="2023-04-06T16:52:53+08:00" itemprop="dateCreated" data-v-2045e486="">2023-04-06</time></a></span><span class="flex items-center" title="修改于 2023-04-30 00:24:36 GMT+8" data-v-2045e486=""><span class="i-mdi-update mr-1" data-v-2045e486=""></span><span class="sr-only" data-v-2045e486="">修改于</span><a class="hover:underline" href="https://github.com/ouuan/iles-blog/commits/master/src/pages/post/2023/04/ddpp-5.mdx" data-v-2045e486=""><time datetime="2023-04-30T00:24:36+08:00" itemprop="dateModified" data-v-2045e486="">2023-04-30</time></a></span><span class="flex items-center" title="访问量" data-v-2045e486=""><span class="i-mdi-eye-outline mr-1" data-v-2045e486=""></span><span class="sr-only" data-v-2045e486="">访问量</span><span data-v-2045e486="">170</span></span><span class="flex flex-wrap justify-center gap-x-2 gap-y-1" data-v-2045e486=""><span title="标签: ddpp" class="flex items-center" data-v-2045e486=""><span class="i-mdi-tag-outline mr-1" data-v-2045e486=""></span><span class="sr-only" data-v-2045e486="">标签</span><a href="/tag/ddpp" class="hover:underline" data-v-2045e486=""><span itemprop="keywords" data-v-2045e486="" data-v-6544d8e8="">ddpp</span></a></span><span title="标签: 学习笔记" class="flex items-center" data-v-2045e486=""><span class="i-mdi-tag-outline mr-1" data-v-2045e486=""></span><span class="sr-only" data-v-2045e486="">标签</span><a href="/tag/学习笔记" class="hover:underline" data-v-2045e486=""><span itemprop="keywords" data-v-2045e486="" data-v-6544d8e8="">学习笔记</span></a></span></span></div></header></ile-root><script></script><script type="module" async="">import{h as e,c as t}from"/assets/iles.e30597ee.js";import{c as a}from"/assets/PostHead.f34853a3.js";import"/assets/vendor-vue.f543892e.js";import"/assets/vite.5ce4fca4.js";import"/assets/VisitorCount.b65d15cd.js";import"/assets/site.0440d0dc.js";e(t,a,"ile-3",{class:"my-12",href:"/post/2023/04/ddpp-5",filename:"src/pages/post/2023/04/ddpp-5.mdx",frontmatter:{title:"DDPP 第五章学习笔记",date:new Date(1680771173e3),image:"/images/2023/04/ddpp-5.png",tags:["ddpp","学习笔记"],lastUpdated:new Date(1682785476e3),published:new Date(1682785476e3),visitor:170,description:`DDPP5 第五章 “Verilog Hardware Description Language” 的学习笔记。
也就是初学 (System)Verilog 的笔记。`}},{});
</script><section class="article-style" itemprop="articleBody"><p><a href="https://wakerly.org/DDPP/">DDPP5</a> 第五章 <span class="mojikumi">“</span>Verilog Hardware Description Language<span class="mojikumi">”</span> 的学习笔记<span class="mojikumi-line-end">。</span></p>
<p>也就是初学 (System)Verilog 的笔记<span class="mojikumi-line-end">。</span></p>

<p>本来想寒假学<span class="mojikumi-line-end">，</span>结果还是拖到了数字逻辑实验开始用 FPGA<span class="mojikumi-line-end">，</span>只不过手上有模块了再来学也挺好的<span class="mojikumi-line-end">。</span></p>
<p>虽然从创建到发布拖了很久<span class="mojikumi-line-end">，</span>但其实大部分内容都是新建文件后一周内写的<span class="mojikumi-line-end">，</span>只是后来感觉学的东西已经差不多能应付上课了<span class="mojikumi-line-end">，</span>就一直咕着没把最后一点学完 &amp; 写完<span class="mojikumi-line-start">（</span></p>
<aside role="note" data-v-a2ab257f=""><div class="shadow-md rd-1 b-l-6 my-6 bg-blue-1 dark:bg-blue-9 b-blue" data-v-a2ab257f=""><div class="p-3 flex justify-between items-center" data-v-a2ab257f=""><h2 class="flex items-center gap-1 font-bold" data-v-a2ab257f=""><span class="text-5 i-mdi-info-circle-outline text-blue" data-v-a2ab257f=""></span><span class="sr-only" data-v-a2ab257f="">Info: </span><span data-v-a2ab257f="">SystemVerilog</span></h2><!--v-if--></div><div class="overflow-auto rd-br-1 bg-card px-6 dark:bg-bghover" data-v-a2ab257f=""><p>DDPP5 中讲的是 Verilog 而不是 SystemVerilog<span class="mojikumi-line-end">，</span>我根据在其他地方找到的一些资料补充了少量 SystemVerilog 的内容<span class="mojikumi-line-end">。</span></p></div></div></aside>
<h2 id="neovim-配置" class="heading"><a href="#neovim-配置" class="heading-anchor" aria-label="章节： neovim 配置" tabindex="-1"></a><span>neovim 配置</span></h2>
<p>用的是老师推荐的 Vivado 2019.2 WebPack<span class="mojikumi-line-end">，</span>而它自带的文本编辑器多少有点拉胯<span class="mojikumi-line-end">，</span>所以研究了一下配 neovim<span class="mojikumi-line-end">。</span></p>
<p>最后选择的是 <a href="https://github.com/vivekmalneedi/veridian">veridian</a> + 通过 <a href="https://github.com/jose-elias-alvarez/null-ls.nvim">null-ls</a> 使用 Vivado 的 <code>xvlog</code><span class="mojikumi-line-end">。</span>一开始我还看 veridian 没在维护而且 star 少<span class="mojikumi-line-start">（</span><s>但它好歹最后更新是在 2021<span class="mojikumi-line-end">，</span>Vivado 还在用 2019</s><span class="mojikumi">）</span><span class="mojikumi-line-end">，</span>先试了另外几个<span class="mojikumi-line-end">，</span>后来发现<span class="mojikumi-line-end">，</span>不说别的<span class="mojikumi-line-end">，</span>只有 veridian 支持 hover<span class="mojikumi-line-end">。</span>同时使用 <code>xvlog</code> 是觉得还是 Vivado 自带的 lint 比较靠谱<span class="mojikumi-line-end">。</span></p>
<p>veridian 就是用 <a href="https://github.com/neovim/nvim-lspconfig/blob/master/doc/server_configurations.md#veridian">lspconfig</a><span class="mojikumi-line-end">，</span>记得同时装 <a href="https://github.com/chipsalliance/verible">verible</a> 才能使用某些 feature<span class="mojikumi-line-start">（</span>在 lspconfig 里只需启用 veridian<span class="mojikumi">）</span><span class="mojikumi-line-end">。</span>可以把 <code>root_dir</code> 设为 <code>util<wbr>.<wbr>root_pattern<wbr>('*.<wbr>xpr<wbr>', '.<wbr>git<wbr>')</code> 来检测 Vivado 项目的根目录<span class="mojikumi-line-end">。</span></p>
<p>null-ls 的配置如下<span class="mojikumi-line-end">，</span>因为 <code>xvlog</code> 实际上是一个不能禁用文件输出的 simulator<span class="mojikumi-line-end">，</span>采取了一些措施来防止它到处倒垃圾<span class="mojikumi-line-end">。</span></p>
<section class="code-block relative my-6 shadow" itemprop="hasPart" itemscope="" itemtype="https://schema.org/SoftwareSourceCode" data-v-c675dba6=""><div class="h-6 items-center rd-t-1 bg-area px-4 dark:bg-#2A313A media-screen:important-flex" style="display:none;" data-v-c675dba6=""><h3 class="text-3 text-footer" itemprop="programmingLanguage" aria-label="Lua 代码块" data-v-c675dba6="">Lua</h3><ile-root id="ile-4"><button title="复制到剪贴板" class="copy-button b-footer text-footer" data-v-9288569d=""><span class="i-mdi-content-copy" data-v-9288569d=""></span><span class="sr-only" role="status" data-v-9288569d=""></span></button></ile-root><script></script><script type="module" async="">var s=(i,a)=>()=>(a||i((a={exports:{}}).exports,a),a.exports);var r=(i,a,o)=>new Promise((c,n)=>{var f=t=>{try{_(o.next(t))}catch(e){n(e)}},l=t=>{try{_(o.throw(t))}catch(e){n(e)}},_=t=>t.done?c(t.value):Promise.resolve(t.value).then(f,l);_((o=o.apply(i,a)).next())});import{_ as d}from"/assets/vite.5ce4fca4.js";import{b as p}from"/assets/iles.e30597ee.js";import"/assets/vendor-vue.f543892e.js";var E=s(m=>{const u=()=>r(m,null,function*(){return(yield d(()=>import("/assets/iles.e30597ee.js").then(i=>i.v),["assets/iles.e30597ee.js","assets/vendor-vue.f543892e.js","assets/vite.5ce4fca4.js"])).default}),v=()=>r(m,null,function*(){return(yield d(()=>import("/assets/CopyButton.1e9a24a4.js"),["assets/CopyButton.1e9a24a4.js","assets/vendor-vue.f543892e.js","assets/vite.5ce4fca4.js"])).default});p(u,v,"ile-4",{},{})});export default E();
</script></div><div class="dark:hidden" itemprop="text" data-v-c675dba6=""><pre class="shiki light" style="background-color: #FBFBFB" tabindex="0"><code><span><span style="color: #994CC3">local</span><span style="color: #403F53"> </span><span style="color: #4876D6">null_ls</span><span style="color: #403F53"> </span><span style="color: #0C969B">=</span><span style="color: #403F53"> </span><span style="color: #4876D6">require</span><span style="color: #403F53"> </span><span style="color: #111111">"</span><span style="color: #C96765">null-ls</span><span style="color: #111111">"</span></span>
<span><span style="color: #994CC3">local</span><span style="color: #403F53"> </span><span style="color: #4876D6">utils</span><span style="color: #403F53"> </span><span style="color: #0C969B">=</span><span style="color: #403F53"> </span><span style="color: #4876D6">require</span><span style="color: #403F53"> </span><span style="color: #111111">"</span><span style="color: #C96765">null-ls.utils</span><span style="color: #111111">"</span></span>
<span><span style="color: #994CC3">local</span><span style="color: #403F53"> </span><span style="color: #4876D6">helpers</span><span style="color: #403F53"> </span><span style="color: #0C969B">=</span><span style="color: #403F53"> </span><span style="color: #4876D6">require</span><span style="color: #403F53"> </span><span style="color: #111111">"</span><span style="color: #C96765">null-ls.helpers</span><span style="color: #111111">"</span></span>
<span></span>
<span><span style="color: #994CC3">local</span><span style="color: #403F53"> </span><span style="color: #4876D6">xvlog_sv</span><span style="color: #403F53"> </span><span style="color: #0C969B">=</span><span style="color: #403F53"> {</span></span>
<span><span style="color: #403F53">  </span><span style="color: #4876D6">name</span><span style="color: #403F53"> </span><span style="color: #0C969B">=</span><span style="color: #403F53"> </span><span style="color: #111111">"</span><span style="color: #C96765">xvlog</span><span style="color: #111111">"</span><span style="color: #403F53">,</span></span>
<span><span style="color: #403F53">  </span><span style="color: #4876D6">method</span><span style="color: #403F53"> </span><span style="color: #0C969B">=</span><span style="color: #403F53"> </span><span style="color: #4876D6">null_ls</span><span style="color: #403F53">.methods.DIAGNOSTICS,</span></span>
<span><span style="color: #403F53">  </span><span style="color: #4876D6">filetypes</span><span style="color: #403F53"> </span><span style="color: #0C969B">=</span><span style="color: #403F53"> { </span><span style="color: #111111">"</span><span style="color: #C96765">systemverilog</span><span style="color: #111111">" </span><span style="color: #403F53">},</span></span>
<span><span style="color: #403F53">  </span><span style="color: #4876D6">generator</span><span style="color: #403F53"> </span><span style="color: #0C969B">=</span><span style="color: #403F53"> </span><span style="color: #4876D6">null_ls</span><span style="color: #403F53">.</span><span style="color: #4876D6">generator</span><span style="color: #403F53"> {</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">command</span><span style="color: #403F53"> </span><span style="color: #0C969B">=</span><span style="color: #403F53"> </span><span style="color: #111111">"</span><span style="color: #C96765">bwrap</span><span style="color: #111111">"</span><span style="color: #403F53">, </span><span style="color: #989FB1">-- only permit writing in /tmp</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">args</span><span style="color: #403F53"> </span><span style="color: #0C969B">=</span><span style="color: #403F53"> {</span></span>
<span><span style="color: #403F53">      </span><span style="color: #111111">"</span><span style="color: #C96765">--ro-bind</span><span style="color: #111111">"</span><span style="color: #403F53">, </span><span style="color: #111111">"</span><span style="color: #C96765">/</span><span style="color: #111111">"</span><span style="color: #403F53">, </span><span style="color: #111111">"</span><span style="color: #C96765">/</span><span style="color: #111111">"</span><span style="color: #403F53">,</span></span>
<span><span style="color: #403F53">      </span><span style="color: #111111">"</span><span style="color: #C96765">--bind</span><span style="color: #111111">"</span><span style="color: #403F53">, </span><span style="color: #111111">"</span><span style="color: #C96765">/tmp/xvlog</span><span style="color: #111111">"</span><span style="color: #403F53">, </span><span style="color: #111111">"</span><span style="color: #C96765">/tmp/xvlog</span><span style="color: #111111">"</span><span style="color: #403F53">,</span></span>
<span><span style="color: #403F53">      </span><span style="color: #111111">"</span><span style="color: #C96765">--dev</span><span style="color: #111111">"</span><span style="color: #403F53">, </span><span style="color: #111111">"</span><span style="color: #C96765">/dev</span><span style="color: #111111">"</span><span style="color: #403F53">,</span></span>
<span><span style="color: #403F53">      </span><span style="color: #111111">"</span><span style="color: #C96765">/home/ouuan/Xilinx/Vivado/2019.2/bin/xvlog</span><span style="color: #111111">"</span><span style="color: #403F53">,</span></span>
<span><span style="color: #403F53">      </span><span style="color: #111111">"</span><span style="color: #C96765">--sv</span><span style="color: #111111">"</span><span style="color: #403F53">, </span><span style="color: #111111">"</span><span style="color: #C96765">$FILENAME</span><span style="color: #111111">"</span><span style="color: #403F53">,</span></span>
<span><span style="color: #403F53">    },</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">cwd</span><span style="color: #403F53"> </span><span style="color: #0C969B">=</span><span style="color: #403F53"> </span><span style="color: #994CC3">function</span><span style="color: #111111">(</span><span style="color: #0C969B">params</span><span style="color: #111111">)</span></span>
<span><span style="color: #403F53">      </span><span style="color: #989FB1">-- output in /tmp</span></span>
<span><span style="color: #403F53">      </span><span style="color: #994CC3">local</span><span style="color: #403F53"> </span><span style="color: #4876D6">dir</span><span style="color: #403F53"> </span><span style="color: #0C969B">=</span><span style="color: #403F53"> </span><span style="color: #111111">'</span><span style="color: #C96765">/tmp/xvlog/</span><span style="color: #111111">' </span><span style="color: #0C969B">..</span><span style="color: #403F53"> </span><span style="color: #4876D6">params</span><span style="color: #403F53">.bufnr</span></span>
<span><span style="color: #403F53">      </span><span style="color: #4876D6">vim</span><span style="color: #403F53">.fn.</span><span style="color: #4876D6">mkdir</span><span style="color: #403F53">(</span><span style="color: #4876D6">dir</span><span style="color: #403F53">, </span><span style="color: #111111">'</span><span style="color: #C96765">p</span><span style="color: #111111">'</span><span style="color: #403F53">)</span></span>
<span><span style="color: #403F53">      </span><span style="color: #994CC3">return</span><span style="color: #403F53"> </span><span style="color: #4876D6">dir</span></span>
<span><span style="color: #403F53">    </span><span style="color: #994CC3">end</span><span style="color: #403F53">,</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">to_temp_file</span><span style="color: #403F53"> </span><span style="color: #0C969B">=</span><span style="color: #403F53"> </span><span style="color: #4876D6">true</span><span style="color: #403F53">,</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">format</span><span style="color: #403F53"> </span><span style="color: #0C969B">=</span><span style="color: #403F53"> </span><span style="color: #111111">"</span><span style="color: #C96765">line</span><span style="color: #111111">"</span><span style="color: #403F53">,</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">check_exit_code</span><span style="color: #403F53"> </span><span style="color: #0C969B">=</span><span style="color: #403F53"> { </span><span style="color: #AA0982">0</span><span style="color: #403F53">, </span><span style="color: #AA0982">1</span><span style="color: #403F53"> },</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">on_output</span><span style="color: #403F53"> </span><span style="color: #0C969B">=</span><span style="color: #403F53"> </span><span style="color: #4876D6">helpers</span><span style="color: #403F53">.diagnostics.</span><span style="color: #4876D6">from_patterns</span><span style="color: #403F53"> {</span></span>
<span><span style="color: #403F53">      {</span></span>
<span><span style="color: #403F53">        </span><span style="color: #4876D6">pattern</span><span style="color: #403F53"> </span><span style="color: #0C969B">=</span><span style="color: #403F53"> </span><span style="color: #111111">'</span><span style="color: #C96765">(.+): %[.+%] (.+) %[.+:(%d+)%]</span><span style="color: #111111">'</span><span style="color: #403F53">,</span></span>
<span><span style="color: #403F53">        </span><span style="color: #4876D6">groups</span><span style="color: #403F53"> </span><span style="color: #0C969B">=</span><span style="color: #403F53"> { </span><span style="color: #111111">"</span><span style="color: #C96765">severity</span><span style="color: #111111">"</span><span style="color: #403F53">, </span><span style="color: #111111">"</span><span style="color: #C96765">message</span><span style="color: #111111">"</span><span style="color: #403F53">, </span><span style="color: #111111">"</span><span style="color: #C96765">row</span><span style="color: #111111">" </span><span style="color: #403F53">},</span></span>
<span><span style="color: #403F53">        </span><span style="color: #4876D6">overrides</span><span style="color: #403F53"> </span><span style="color: #0C969B">=</span><span style="color: #403F53"> {</span></span>
<span><span style="color: #403F53">          </span><span style="color: #4876D6">severities</span><span style="color: #403F53"> </span><span style="color: #0C969B">=</span><span style="color: #403F53"> {</span></span>
<span><span style="color: #403F53">            [</span><span style="color: #111111">"</span><span style="color: #C96765">ERROR</span><span style="color: #111111">"</span><span style="color: #403F53">] </span><span style="color: #0C969B">=</span><span style="color: #403F53"> </span><span style="color: #AA0982">1</span><span style="color: #403F53">,</span></span>
<span><span style="color: #403F53">            [</span><span style="color: #111111">"</span><span style="color: #C96765">WARNING</span><span style="color: #111111">"</span><span style="color: #403F53">] </span><span style="color: #0C969B">=</span><span style="color: #403F53"> </span><span style="color: #AA0982">2</span><span style="color: #403F53">,</span></span>
<span><span style="color: #403F53">            [</span><span style="color: #111111">"</span><span style="color: #C96765">INFO</span><span style="color: #111111">"</span><span style="color: #403F53">] </span><span style="color: #0C969B">=</span><span style="color: #403F53"> </span><span style="color: #AA0982">3</span><span style="color: #403F53">,</span></span>
<span><span style="color: #403F53">          },</span></span>
<span><span style="color: #403F53">        },</span></span>
<span><span style="color: #403F53">      },</span></span>
<span><span style="color: #403F53">    },</span></span>
<span><span style="color: #403F53">  },</span></span>
<span><span style="color: #403F53">}</span></span>
<span></span>
<span><span style="color: #4876D6">null_ls</span><span style="color: #403F53">.</span><span style="color: #4876D6">setup</span><span style="color: #403F53"> {</span></span>
<span><span style="color: #403F53">  </span><span style="color: #4876D6">sources</span><span style="color: #403F53"> </span><span style="color: #0C969B">=</span><span style="color: #403F53"> {</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">xvlog_sv</span><span style="color: #403F53">,</span></span>
<span><span style="color: #403F53">  },</span></span>
<span><span style="color: #403F53">  </span><span style="color: #4876D6">root_dir</span><span style="color: #403F53"> </span><span style="color: #0C969B">=</span><span style="color: #403F53"> </span><span style="color: #4876D6">utils</span><span style="color: #403F53">.</span><span style="color: #4876D6">root_pattern</span><span style="color: #403F53">(</span><span style="color: #111111">"</span><span style="color: #C96765">*.xpr</span><span style="color: #111111">"</span><span style="color: #403F53">, </span><span style="color: #111111">"</span><span style="color: #C96765">.git</span><span style="color: #111111">"</span><span style="color: #403F53">)</span></span>
<span><span style="color: #403F53">}</span></span></code></pre></div><div class="dark:important-block" style="display:none;" data-v-c675dba6=""><pre class="shiki dark" style="background-color: #011627" tabindex="0"><code><span><span style="color: #C792EA">local</span><span style="color: #D6DEEB"> </span><span style="color: #C5E478">null_ls</span><span style="color: #D6DEEB"> </span><span style="color: #7FDBCA">=</span><span style="color: #D6DEEB"> </span><span style="color: #C5E478">require</span><span style="color: #D6DEEB"> </span><span style="color: #D9F5DD">"</span><span style="color: #ECC48D">null-ls</span><span style="color: #D9F5DD">"</span></span>
<span><span style="color: #C792EA">local</span><span style="color: #D6DEEB"> </span><span style="color: #C5E478">utils</span><span style="color: #D6DEEB"> </span><span style="color: #7FDBCA">=</span><span style="color: #D6DEEB"> </span><span style="color: #C5E478">require</span><span style="color: #D6DEEB"> </span><span style="color: #D9F5DD">"</span><span style="color: #ECC48D">null-ls.utils</span><span style="color: #D9F5DD">"</span></span>
<span><span style="color: #C792EA">local</span><span style="color: #D6DEEB"> </span><span style="color: #C5E478">helpers</span><span style="color: #D6DEEB"> </span><span style="color: #7FDBCA">=</span><span style="color: #D6DEEB"> </span><span style="color: #C5E478">require</span><span style="color: #D6DEEB"> </span><span style="color: #D9F5DD">"</span><span style="color: #ECC48D">null-ls.helpers</span><span style="color: #D9F5DD">"</span></span>
<span></span>
<span><span style="color: #C792EA">local</span><span style="color: #D6DEEB"> </span><span style="color: #C5E478">xvlog_sv</span><span style="color: #D6DEEB"> </span><span style="color: #7FDBCA">=</span><span style="color: #D6DEEB"> {</span></span>
<span><span style="color: #D6DEEB">  </span><span style="color: #C5E478">name</span><span style="color: #D6DEEB"> </span><span style="color: #7FDBCA">=</span><span style="color: #D6DEEB"> </span><span style="color: #D9F5DD">"</span><span style="color: #ECC48D">xvlog</span><span style="color: #D9F5DD">"</span><span style="color: #D6DEEB">,</span></span>
<span><span style="color: #D6DEEB">  </span><span style="color: #C5E478">method</span><span style="color: #D6DEEB"> </span><span style="color: #7FDBCA">=</span><span style="color: #D6DEEB"> </span><span style="color: #C5E478">null_ls</span><span style="color: #D6DEEB">.methods.DIAGNOSTICS,</span></span>
<span><span style="color: #D6DEEB">  </span><span style="color: #C5E478">filetypes</span><span style="color: #D6DEEB"> </span><span style="color: #7FDBCA">=</span><span style="color: #D6DEEB"> { </span><span style="color: #D9F5DD">"</span><span style="color: #ECC48D">systemverilog</span><span style="color: #D9F5DD">" </span><span style="color: #D6DEEB">},</span></span>
<span><span style="color: #D6DEEB">  </span><span style="color: #C5E478">generator</span><span style="color: #D6DEEB"> </span><span style="color: #7FDBCA">=</span><span style="color: #D6DEEB"> </span><span style="color: #C5E478">null_ls</span><span style="color: #D6DEEB">.</span><span style="color: #C5E478">generator</span><span style="color: #D6DEEB"> {</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C5E478">command</span><span style="color: #D6DEEB"> </span><span style="color: #7FDBCA">=</span><span style="color: #D6DEEB"> </span><span style="color: #D9F5DD">"</span><span style="color: #ECC48D">bwrap</span><span style="color: #D9F5DD">"</span><span style="color: #D6DEEB">, </span><span style="color: #637777">-- only permit writing in /tmp</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C5E478">args</span><span style="color: #D6DEEB"> </span><span style="color: #7FDBCA">=</span><span style="color: #D6DEEB"> {</span></span>
<span><span style="color: #D6DEEB">      </span><span style="color: #D9F5DD">"</span><span style="color: #ECC48D">--ro-bind</span><span style="color: #D9F5DD">"</span><span style="color: #D6DEEB">, </span><span style="color: #D9F5DD">"</span><span style="color: #ECC48D">/</span><span style="color: #D9F5DD">"</span><span style="color: #D6DEEB">, </span><span style="color: #D9F5DD">"</span><span style="color: #ECC48D">/</span><span style="color: #D9F5DD">"</span><span style="color: #D6DEEB">,</span></span>
<span><span style="color: #D6DEEB">      </span><span style="color: #D9F5DD">"</span><span style="color: #ECC48D">--bind</span><span style="color: #D9F5DD">"</span><span style="color: #D6DEEB">, </span><span style="color: #D9F5DD">"</span><span style="color: #ECC48D">/tmp/xvlog</span><span style="color: #D9F5DD">"</span><span style="color: #D6DEEB">, </span><span style="color: #D9F5DD">"</span><span style="color: #ECC48D">/tmp/xvlog</span><span style="color: #D9F5DD">"</span><span style="color: #D6DEEB">,</span></span>
<span><span style="color: #D6DEEB">      </span><span style="color: #D9F5DD">"</span><span style="color: #ECC48D">--dev</span><span style="color: #D9F5DD">"</span><span style="color: #D6DEEB">, </span><span style="color: #D9F5DD">"</span><span style="color: #ECC48D">/dev</span><span style="color: #D9F5DD">"</span><span style="color: #D6DEEB">,</span></span>
<span><span style="color: #D6DEEB">      </span><span style="color: #D9F5DD">"</span><span style="color: #ECC48D">/home/ouuan/Xilinx/Vivado/2019.2/bin/xvlog</span><span style="color: #D9F5DD">"</span><span style="color: #D6DEEB">,</span></span>
<span><span style="color: #D6DEEB">      </span><span style="color: #D9F5DD">"</span><span style="color: #ECC48D">--sv</span><span style="color: #D9F5DD">"</span><span style="color: #D6DEEB">, </span><span style="color: #D9F5DD">"</span><span style="color: #ECC48D">$FILENAME</span><span style="color: #D9F5DD">"</span><span style="color: #D6DEEB">,</span></span>
<span><span style="color: #D6DEEB">    },</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #82AAFF">cwd</span><span style="color: #D6DEEB"> </span><span style="color: #7FDBCA">=</span><span style="color: #D6DEEB"> </span><span style="color: #C792EA">function</span><span style="color: #D9F5DD">(</span><span style="color: #7FDBCA">params</span><span style="color: #D9F5DD">)</span></span>
<span><span style="color: #D6DEEB">      </span><span style="color: #637777">-- output in /tmp</span></span>
<span><span style="color: #D6DEEB">      </span><span style="color: #C792EA">local</span><span style="color: #D6DEEB"> </span><span style="color: #C5E478">dir</span><span style="color: #D6DEEB"> </span><span style="color: #7FDBCA">=</span><span style="color: #D6DEEB"> </span><span style="color: #D9F5DD">'</span><span style="color: #ECC48D">/tmp/xvlog/</span><span style="color: #D9F5DD">' </span><span style="color: #7FDBCA">..</span><span style="color: #D6DEEB"> </span><span style="color: #C5E478">params</span><span style="color: #D6DEEB">.bufnr</span></span>
<span><span style="color: #D6DEEB">      </span><span style="color: #C5E478">vim</span><span style="color: #D6DEEB">.fn.</span><span style="color: #C5E478">mkdir</span><span style="color: #D6DEEB">(</span><span style="color: #C5E478">dir</span><span style="color: #D6DEEB">, </span><span style="color: #D9F5DD">'</span><span style="color: #ECC48D">p</span><span style="color: #D9F5DD">'</span><span style="color: #D6DEEB">)</span></span>
<span><span style="color: #D6DEEB">      </span><span style="color: #C792EA">return</span><span style="color: #D6DEEB"> </span><span style="color: #C5E478">dir</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C792EA">end</span><span style="color: #D6DEEB">,</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C5E478">to_temp_file</span><span style="color: #D6DEEB"> </span><span style="color: #7FDBCA">=</span><span style="color: #D6DEEB"> </span><span style="color: #82AAFF">true</span><span style="color: #D6DEEB">,</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C5E478">format</span><span style="color: #D6DEEB"> </span><span style="color: #7FDBCA">=</span><span style="color: #D6DEEB"> </span><span style="color: #D9F5DD">"</span><span style="color: #ECC48D">line</span><span style="color: #D9F5DD">"</span><span style="color: #D6DEEB">,</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C5E478">check_exit_code</span><span style="color: #D6DEEB"> </span><span style="color: #7FDBCA">=</span><span style="color: #D6DEEB"> { </span><span style="color: #F78C6C">0</span><span style="color: #D6DEEB">, </span><span style="color: #F78C6C">1</span><span style="color: #D6DEEB"> },</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C5E478">on_output</span><span style="color: #D6DEEB"> </span><span style="color: #7FDBCA">=</span><span style="color: #D6DEEB"> </span><span style="color: #C5E478">helpers</span><span style="color: #D6DEEB">.diagnostics.</span><span style="color: #C5E478">from_patterns</span><span style="color: #D6DEEB"> {</span></span>
<span><span style="color: #D6DEEB">      {</span></span>
<span><span style="color: #D6DEEB">        </span><span style="color: #C5E478">pattern</span><span style="color: #D6DEEB"> </span><span style="color: #7FDBCA">=</span><span style="color: #D6DEEB"> </span><span style="color: #D9F5DD">'</span><span style="color: #ECC48D">(.+): %[.+%] (.+) %[.+:(%d+)%]</span><span style="color: #D9F5DD">'</span><span style="color: #D6DEEB">,</span></span>
<span><span style="color: #D6DEEB">        </span><span style="color: #C5E478">groups</span><span style="color: #D6DEEB"> </span><span style="color: #7FDBCA">=</span><span style="color: #D6DEEB"> { </span><span style="color: #D9F5DD">"</span><span style="color: #ECC48D">severity</span><span style="color: #D9F5DD">"</span><span style="color: #D6DEEB">, </span><span style="color: #D9F5DD">"</span><span style="color: #ECC48D">message</span><span style="color: #D9F5DD">"</span><span style="color: #D6DEEB">, </span><span style="color: #D9F5DD">"</span><span style="color: #ECC48D">row</span><span style="color: #D9F5DD">" </span><span style="color: #D6DEEB">},</span></span>
<span><span style="color: #D6DEEB">        </span><span style="color: #C5E478">overrides</span><span style="color: #D6DEEB"> </span><span style="color: #7FDBCA">=</span><span style="color: #D6DEEB"> {</span></span>
<span><span style="color: #D6DEEB">          </span><span style="color: #C5E478">severities</span><span style="color: #D6DEEB"> </span><span style="color: #7FDBCA">=</span><span style="color: #D6DEEB"> {</span></span>
<span><span style="color: #D6DEEB">            [</span><span style="color: #D9F5DD">"</span><span style="color: #ECC48D">ERROR</span><span style="color: #D9F5DD">"</span><span style="color: #D6DEEB">] </span><span style="color: #7FDBCA">=</span><span style="color: #D6DEEB"> </span><span style="color: #F78C6C">1</span><span style="color: #D6DEEB">,</span></span>
<span><span style="color: #D6DEEB">            [</span><span style="color: #D9F5DD">"</span><span style="color: #ECC48D">WARNING</span><span style="color: #D9F5DD">"</span><span style="color: #D6DEEB">] </span><span style="color: #7FDBCA">=</span><span style="color: #D6DEEB"> </span><span style="color: #F78C6C">2</span><span style="color: #D6DEEB">,</span></span>
<span><span style="color: #D6DEEB">            [</span><span style="color: #D9F5DD">"</span><span style="color: #ECC48D">INFO</span><span style="color: #D9F5DD">"</span><span style="color: #D6DEEB">] </span><span style="color: #7FDBCA">=</span><span style="color: #D6DEEB"> </span><span style="color: #F78C6C">3</span><span style="color: #D6DEEB">,</span></span>
<span><span style="color: #D6DEEB">          },</span></span>
<span><span style="color: #D6DEEB">        },</span></span>
<span><span style="color: #D6DEEB">      },</span></span>
<span><span style="color: #D6DEEB">    },</span></span>
<span><span style="color: #D6DEEB">  },</span></span>
<span><span style="color: #D6DEEB">}</span></span>
<span></span>
<span><span style="color: #C5E478">null_ls</span><span style="color: #D6DEEB">.</span><span style="color: #C5E478">setup</span><span style="color: #D6DEEB"> {</span></span>
<span><span style="color: #D6DEEB">  </span><span style="color: #C5E478">sources</span><span style="color: #D6DEEB"> </span><span style="color: #7FDBCA">=</span><span style="color: #D6DEEB"> {</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C5E478">xvlog_sv</span><span style="color: #D6DEEB">,</span></span>
<span><span style="color: #D6DEEB">  },</span></span>
<span><span style="color: #D6DEEB">  </span><span style="color: #C5E478">root_dir</span><span style="color: #D6DEEB"> </span><span style="color: #7FDBCA">=</span><span style="color: #D6DEEB"> </span><span style="color: #C5E478">utils</span><span style="color: #D6DEEB">.</span><span style="color: #C5E478">root_pattern</span><span style="color: #D6DEEB">(</span><span style="color: #D9F5DD">"</span><span style="color: #ECC48D">*.xpr</span><span style="color: #D9F5DD">"</span><span style="color: #D6DEEB">, </span><span style="color: #D9F5DD">"</span><span style="color: #ECC48D">.git</span><span style="color: #D9F5DD">"</span><span style="color: #D6DEEB">)</span></span>
<span><span style="color: #D6DEEB">}</span></span></code></pre></div></section>
<p>另外可以用 <a href="https://github.com/amal-khailtash/vim-xdc-syntax">vim-xdc-syntax</a> 添加管脚约束文件的高亮<span class="mojikumi-line-end">。</span></p>
<p>Vivado 的 custom text editor 使用下面的脚本<span class="mojikumi-line-end">。</span>是针对 <a href="https://i3wm.org/">i3</a> 配的<span class="mojikumi-line-end">，</span>给 konsole 设了 name 参数<span class="mojikumi-line-end">，</span>i3 设成 <code>assign<wbr> [<wbr>instance<wbr>="<wbr>konsole<wbr>"]</code><span class="mojikumi-line-start">（</span><code>instance</code> 而非 <code>class</code><span class="mojikumi-line-end">）</span>就可以不把这个 konsole 挪到其他 konsole 所在的 workspace<span class="mojikumi-line-end">，</span>并且可以在打开新文件时 focus 过去<span class="mojikumi-line-end">。</span></p>
<section class="code-block relative my-6 shadow" itemprop="hasPart" itemscope="" itemtype="https://schema.org/SoftwareSourceCode" data-v-c675dba6=""><div class="h-6 items-center rd-t-1 bg-area px-4 dark:bg-#2A313A media-screen:important-flex" style="display:none;" data-v-c675dba6=""><h3 class="text-3 text-footer" itemprop="programmingLanguage" aria-label="Shell 代码块" data-v-c675dba6="">Shell</h3><ile-root id="ile-5"><button title="复制到剪贴板" class="copy-button b-footer text-footer" data-v-9288569d=""><span class="i-mdi-content-copy" data-v-9288569d=""></span><span class="sr-only" role="status" data-v-9288569d=""></span></button></ile-root><script></script><script type="module" async="">var s=(i,a)=>()=>(a||i((a={exports:{}}).exports,a),a.exports);var r=(i,a,o)=>new Promise((c,n)=>{var f=t=>{try{_(o.next(t))}catch(e){n(e)}},l=t=>{try{_(o.throw(t))}catch(e){n(e)}},_=t=>t.done?c(t.value):Promise.resolve(t.value).then(f,l);_((o=o.apply(i,a)).next())});import{_ as d}from"/assets/vite.5ce4fca4.js";import{b as p}from"/assets/iles.e30597ee.js";import"/assets/vendor-vue.f543892e.js";var E=s(m=>{const u=()=>r(m,null,function*(){return(yield d(()=>import("/assets/iles.e30597ee.js").then(i=>i.v),["assets/iles.e30597ee.js","assets/vendor-vue.f543892e.js","assets/vite.5ce4fca4.js"])).default}),v=()=>r(m,null,function*(){return(yield d(()=>import("/assets/CopyButton.1e9a24a4.js"),["assets/CopyButton.1e9a24a4.js","assets/vendor-vue.f543892e.js","assets/vite.5ce4fca4.js"])).default});p(u,v,"ile-5",{},{})});export default E();
</script></div><div class="dark:hidden" itemprop="text" data-v-c675dba6=""><pre class="shiki light" style="background-color: #FBFBFB" tabindex="0"><code><span><span style="color: #989FB1">#!/bin/bash</span></span>
<span></span>
<span><span style="color: #989FB1"># vivado-nvim.sh "[file name]" [line number]</span></span>
<span></span>
<span><span style="color: #4876D6">set</span><span style="color: #403F53"> </span><span style="color: #4876D6">-euo</span><span style="color: #403F53"> </span><span style="color: #4876D6">pipefail</span></span>
<span></span>
<span><span style="color: #4876D6">unset</span><span style="color: #403F53"> </span><span style="color: #4876D6">LD_LIBRARY_PATH</span></span>
<span></span>
<span><span style="color: #4876D6">NVIM_LISTEN_ADDRESS</span><span style="color: #994CC3">=</span><span style="color: #4876D6">/tmp/vivado-nvim.pipe</span></span>
<span></span>
<span><span style="color: #994CC3">if</span><span style="color: #403F53"> [[ </span><span style="color: #994CC3">!</span><span style="color: #403F53"> </span><span style="color: #994CC3">-e</span><span style="color: #403F53"> </span><span style="color: #4876D6">$NVIM_LISTEN_ADDRESS</span><span style="color: #403F53"> ]]; </span><span style="color: #994CC3">then</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">exec</span><span style="color: #403F53"> </span><span style="color: #4876D6">konsole</span><span style="color: #403F53"> </span><span style="color: #4876D6">--name</span><span style="color: #403F53"> </span><span style="color: #111111">"</span><span style="color: #C96765">vivado-nvim</span><span style="color: #111111">"</span><span style="color: #403F53"> </span><span style="color: #4876D6">-e</span><span style="color: #403F53"> </span><span style="color: #4876D6">nvim</span><span style="color: #403F53"> </span><span style="color: #4876D6">--listen</span><span style="color: #403F53"> </span><span style="color: #4876D6">$NVIM_LISTEN_ADDRESS</span><span style="color: #403F53"> </span><span style="color: #111111">"</span><span style="color: #403F53">$1</span><span style="color: #111111">"</span><span style="color: #403F53"> </span><span style="color: #111111">"</span><span style="color: #C96765">+</span><span style="color: #403F53">$2</span><span style="color: #111111">"</span></span>
<span><span style="color: #994CC3">else</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">nvim</span><span style="color: #403F53"> </span><span style="color: #4876D6">--server</span><span style="color: #403F53"> </span><span style="color: #4876D6">$NVIM_LISTEN_ADDRESS</span><span style="color: #403F53"> </span><span style="color: #4876D6">--remote</span><span style="color: #403F53"> </span><span style="color: #111111">"</span><span style="color: #403F53">$1</span><span style="color: #111111">"</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">nvim</span><span style="color: #403F53"> </span><span style="color: #4876D6">--server</span><span style="color: #403F53"> </span><span style="color: #4876D6">$NVIM_LISTEN_ADDRESS</span><span style="color: #403F53"> </span><span style="color: #4876D6">--remote-send</span><span style="color: #403F53"> </span><span style="color: #111111">"</span><span style="color: #C96765">:</span><span style="color: #403F53">$2</span><span style="color: #C96765">&lt;CR&gt;</span><span style="color: #111111">"</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">i3-msg</span><span style="color: #403F53"> </span><span style="color: #111111">'</span><span style="color: #C96765">[instance="vivado-nvim"] focus</span><span style="color: #111111">'</span></span>
<span><span style="color: #994CC3">fi</span></span></code></pre></div><div class="dark:important-block" style="display:none;" data-v-c675dba6=""><pre class="shiki dark" style="background-color: #011627" tabindex="0"><code><span><span style="color: #637777">#!/bin/bash</span></span>
<span></span>
<span><span style="color: #637777"># vivado-nvim.sh "[file name]" [line number]</span></span>
<span></span>
<span><span style="color: #C5E478">set</span><span style="color: #D6DEEB"> </span><span style="color: #82AAFF">-euo</span><span style="color: #D6DEEB"> </span><span style="color: #ECC48D">pipefail</span></span>
<span></span>
<span><span style="color: #C5E478">unset</span><span style="color: #D6DEEB"> </span><span style="color: #ECC48D">LD_LIBRARY_PATH</span></span>
<span></span>
<span><span style="color: #C5E478">NVIM_LISTEN_ADDRESS</span><span style="color: #C792EA">=</span><span style="color: #ECC48D">/tmp/vivado-nvim.pipe</span></span>
<span></span>
<span><span style="color: #C792EA">if</span><span style="color: #D6DEEB"> [[ </span><span style="color: #C792EA">!</span><span style="color: #D6DEEB"> </span><span style="color: #C792EA">-e</span><span style="color: #D6DEEB"> </span><span style="color: #C5E478">$NVIM_LISTEN_ADDRESS</span><span style="color: #D6DEEB"> ]]; </span><span style="color: #C792EA">then</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C5E478">exec</span><span style="color: #D6DEEB"> </span><span style="color: #ECC48D">konsole</span><span style="color: #D6DEEB"> </span><span style="color: #82AAFF">--name</span><span style="color: #D6DEEB"> </span><span style="color: #D9F5DD">"</span><span style="color: #ECC48D">vivado-nvim</span><span style="color: #D9F5DD">"</span><span style="color: #D6DEEB"> </span><span style="color: #82AAFF">-e</span><span style="color: #D6DEEB"> </span><span style="color: #ECC48D">nvim</span><span style="color: #D6DEEB"> </span><span style="color: #82AAFF">--listen</span><span style="color: #D6DEEB"> </span><span style="color: #C5E478">$NVIM_LISTEN_ADDRESS</span><span style="color: #D6DEEB"> </span><span style="color: #D9F5DD">"</span><span style="color: #D7DBE0">$1</span><span style="color: #D9F5DD">"</span><span style="color: #D6DEEB"> </span><span style="color: #D9F5DD">"</span><span style="color: #ECC48D">+</span><span style="color: #D7DBE0">$2</span><span style="color: #D9F5DD">"</span></span>
<span><span style="color: #C792EA">else</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #82AAFF">nvim</span><span style="color: #D6DEEB"> </span><span style="color: #82AAFF">--server</span><span style="color: #D6DEEB"> </span><span style="color: #C5E478">$NVIM_LISTEN_ADDRESS</span><span style="color: #D6DEEB"> </span><span style="color: #82AAFF">--remote</span><span style="color: #D6DEEB"> </span><span style="color: #D9F5DD">"</span><span style="color: #D7DBE0">$1</span><span style="color: #D9F5DD">"</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #82AAFF">nvim</span><span style="color: #D6DEEB"> </span><span style="color: #82AAFF">--server</span><span style="color: #D6DEEB"> </span><span style="color: #C5E478">$NVIM_LISTEN_ADDRESS</span><span style="color: #D6DEEB"> </span><span style="color: #82AAFF">--remote-send</span><span style="color: #D6DEEB"> </span><span style="color: #D9F5DD">"</span><span style="color: #ECC48D">:</span><span style="color: #D7DBE0">$2</span><span style="color: #ECC48D">&lt;CR&gt;</span><span style="color: #D9F5DD">"</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #82AAFF">i3-msg</span><span style="color: #D6DEEB"> </span><span style="color: #D9F5DD">'</span><span style="color: #ECC48D">[instance="vivado-nvim"] focus</span><span style="color: #D9F5DD">'</span></span>
<span><span style="color: #C792EA">fi</span></span></code></pre></div></section>
<h2 id="基础语法" class="heading"><a href="#基础语法" class="heading-anchor" aria-label="章节： 基础语法" tabindex="-1"></a><span>基础语法</span></h2>
<h3 id="module" class="heading"><a href="#module" class="heading-anchor" aria-label="章节： module" tabindex="-1"></a><span>module</span></h3>
<p>Verilog 以 module 为基本单位<span class="mojikumi-line-start">（</span>和前端的 component 有点类似<span class="mojikumi">）</span><span class="mojikumi-line-end">。</span></p>
<p>例子<span class="mojikumi-line-end">：</span></p>
<section class="code-block relative my-6 shadow" itemprop="hasPart" itemscope="" itemtype="https://schema.org/SoftwareSourceCode" data-v-c675dba6=""><div class="h-6 items-center rd-t-1 bg-area px-4 dark:bg-#2A313A media-screen:important-flex" style="display:none;" data-v-c675dba6=""><h4 class="text-3 text-footer" itemprop="programmingLanguage" aria-label="SystemVerilog 代码块" data-v-c675dba6="">SystemVerilog</h4><ile-root id="ile-6"><button title="复制到剪贴板" class="copy-button b-footer text-footer" data-v-9288569d=""><span class="i-mdi-content-copy" data-v-9288569d=""></span><span class="sr-only" role="status" data-v-9288569d=""></span></button></ile-root><script></script><script type="module" async="">var s=(i,a)=>()=>(a||i((a={exports:{}}).exports,a),a.exports);var r=(i,a,o)=>new Promise((c,n)=>{var f=t=>{try{_(o.next(t))}catch(e){n(e)}},l=t=>{try{_(o.throw(t))}catch(e){n(e)}},_=t=>t.done?c(t.value):Promise.resolve(t.value).then(f,l);_((o=o.apply(i,a)).next())});import{_ as d}from"/assets/vite.5ce4fca4.js";import{b as p}from"/assets/iles.e30597ee.js";import"/assets/vendor-vue.f543892e.js";var E=s(m=>{const u=()=>r(m,null,function*(){return(yield d(()=>import("/assets/iles.e30597ee.js").then(i=>i.v),["assets/iles.e30597ee.js","assets/vendor-vue.f543892e.js","assets/vite.5ce4fca4.js"])).default}),v=()=>r(m,null,function*(){return(yield d(()=>import("/assets/CopyButton.1e9a24a4.js"),["assets/CopyButton.1e9a24a4.js","assets/vendor-vue.f543892e.js","assets/vite.5ce4fca4.js"])).default});p(u,v,"ile-6",{},{})});export default E();
</script></div><div class="dark:hidden" itemprop="text" data-v-c675dba6=""><pre class="shiki light" style="background-color: #FBFBFB" tabindex="0"><code><span><span style="color: #994CC3">module</span><span style="color: #403F53"> inhibit (</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">input</span><span style="color: #403F53">  in,</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">input</span><span style="color: #403F53">  invin,</span></span>
<span><span style="color: #4876D6">    output</span><span style="color: #403F53"> out</span></span>
<span><span style="color: #403F53">);</span></span>
<span><span style="color: #403F53">  </span><span style="color: #994CC3">assign</span><span style="color: #403F53"> out </span><span style="color: #994CC3">=</span><span style="color: #403F53"> in </span><span style="color: #994CC3">&amp;</span><span style="color: #403F53"> </span><span style="color: #994CC3">~</span><span style="color: #403F53">invin;</span></span>
<span><span style="color: #994CC3">endmodule</span></span></code></pre></div><div class="dark:important-block" style="display:none;" data-v-c675dba6=""><pre class="shiki dark" style="background-color: #011627" tabindex="0"><code><span><span style="color: #C792EA">module</span><span style="color: #D6DEEB"> inhibit (</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C5E478">input</span><span style="color: #D6DEEB">  in,</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C5E478">input</span><span style="color: #D6DEEB">  invin,</span></span>
<span><span style="color: #C5E478">    output</span><span style="color: #D6DEEB"> out</span></span>
<span><span style="color: #D6DEEB">);</span></span>
<span><span style="color: #D6DEEB">  </span><span style="color: #C792EA">assign</span><span style="color: #D6DEEB"> out </span><span style="color: #C792EA">=</span><span style="color: #D6DEEB"> in </span><span style="color: #C792EA">&amp;</span><span style="color: #D6DEEB"> </span><span style="color: #C792EA">~</span><span style="color: #D6DEEB">invin;</span></span>
<span><span style="color: #C792EA">endmodule</span></span></code></pre></div></section>
<p>convention 是每个文件只写一个 module<span class="mojikumi-line-end">。</span></p>
<h3 id="signal-net-variable" class="heading"><a href="#signal-net-variable" class="heading-anchor" aria-label="章节： signal (net &amp; variable)" tabindex="-1"></a><span>signal (net &amp; variable)</span></h3>
<p>一个 1-bit 的 signal 有四种取值<span class="mojikumi-line-end">：</span>0<span class="mojikumi-line-end">、</span>1<span class="mojikumi-line-end">、</span>x<span class="mojikumi-line-start">（</span>未知<span class="mojikumi">）</span><span class="mojikumi-line-end">、</span>z<span class="mojikumi-line-start">（</span>高阻抗<span class="mojikumi">）</span><span class="mojikumi-line-end">。</span></p>
<p>位运算<span class="mojikumi-line-end">：</span><code>&amp;</code><span class="mojikumi-line-end">、</span><code>|</code><span class="mojikumi-line-end">、</span><code>~</code><span class="mojikumi-line-end">、</span><code>^</code><span class="mojikumi-line-end">、</span><code>~^</code>/<code>^~</code><span class="mojikumi-line-end">。</span></p>
<p>signal 有两大类<span class="mojikumi-line-end">：</span><i>net</i> 和 <i>variable</i><span class="mojikumi-line-end">：</span></p>
<ul>
<li>net 表示线路<span class="mojikumi-line-end">，</span>一般是 <code>wire</code><span class="mojikumi-line-end">，</span>还可以是 <code>supply0</code><span class="mojikumi-line-end">、</span><code>supply1</code> 等<span class="mojikumi-line-start">（</span>我用 <code>supply1</code> 的时候出现了神秘的问题<span class="mojikumi-line-end">，</span>没细究<span class="mojikumi-line-end">，</span>反正用恒为 1 的 <code>logic</code> 也差不多<span class="mojikumi">）</span><span class="mojikumi-line-end">。</span></li>
<li>variable 用于 procedural statement 中<span class="mojikumi-line-end">，</span>不一定对应到物理上的线路<span class="mojikumi-line-end">，</span>可以是 <code>reg</code> 或者 <code>integer</code><span class="mojikumi-line-end">。</span>其中 <code>reg</code> 就是变量的意思<span class="mojikumi-line-start">（</span>名字取得不太好<span class="mojikumi">）</span><span class="mojikumi-line-end">，</span>表示单个 bit 或者 vector<span class="mojikumi-line-end">，</span>与基于 flip-flop 的寄存器无关<span class="mojikumi-line-end">。</span><code>integer</code> 是有符号整型<span class="mojikumi-line-end">，</span>一般不用来存储数据或信号<span class="mojikumi-line-end">，</span>而是用于 for 循环之类的地方<span class="mojikumi-line-end">。</span></li>
</ul>
<p>input 只能是 net<span class="mojikumi-line-end">，</span>而 output 可以是 net 或 <code>reg</code><span class="mojikumi-line-end">。</span>不写 <code>wire</code> / <code>reg</code> 时默认是 <code>wire</code><span class="mojikumi-line-end">。</span></p>
<p>在 SystemVerilog 中推荐用 <code>logic</code> 来代替 <code>reg</code><span class="mojikumi-line-end">。</span></p>
<h3 id="数字字面量-parameter" class="heading"><a href="#数字字面量-parameter" class="heading-anchor" aria-label="章节： 数字字面量 &amp; parameter" tabindex="-1"></a><span>数字字面量 &amp; parameter</span></h3>
<p>直接写十进制数会得到一个 signed number<span class="mojikumi-line-end">。</span></p>
<p>可以指定位数和进制<span class="mojikumi-line-end">：</span><code>1'b0</code> 是 1 bit 的 0<span class="mojikumi-line-end">，</span><code>4'ha</code> 是 4 bit 的 10<span class="mojikumi-line-start">（</span>十六进制的 A<span class="mojikumi">）</span><span class="mojikumi-line-end">，</span><code>8<wbr>'<wbr>b01x0z1x1</code> 的一些 bit 是未知 / 高阻抗<span class="mojikumi-line-end">。</span>如果后面写的值的位数超过前面指定的位数<span class="mojikumi-line-end">，</span>高位会被扔掉<span class="mojikumi-line-end">，</span>如果少了则会高位补零<span class="mojikumi-line-start">（</span>或者补 <code>x</code> 或 <code>z</code><span class="mojikumi-line-end">，</span>如果最高位是 <code>x</code> 或 <code>z</code><span class="mojikumi">）</span><span class="mojikumi-line-end">。</span>这样得到的会是一个 unsigned vector<span class="mojikumi-line-end">，</span>可以加上 <code>s</code> 得到 signed vector<span class="mojikumi-line-end">：</span><code>4'sb1101</code><span class="mojikumi-line-end">。</span></p>
<p><code>parameter</code> 用来设置带默认值的参数<span class="mojikumi-line-end">：</span><code>parameter SIZE = 32, MSB = SIZE - 1, LSB = 0</code><span class="mojikumi-line-end">，</span><code>parameter ESC = 7'h1b</code><span class="mojikumi">。</span> <code>parameter</code> 一般用作常量<span class="mojikumi-line-end">，</span>而在 <a href="#structural-model">instance statement</a> 中可以被修改<span class="mojikumi-line-end">。</span></p>
<h3 id="vector-算术运算" class="heading"><a href="#vector-算术运算" class="heading-anchor" aria-label="章节： vector &amp; 算术运算" tabindex="-1"></a><span>vector &amp; 算术运算</span></h3>
<p>多个 bit 可以组成一个 vector<span class="mojikumi-line-end">，</span>net<span class="mojikumi-line-end">、</span><code>reg</code><span class="mojikumi-line-end">、</span><code>parameter</code> 都可以是 vector<span class="mojikumi-line-end">。</span></p>
<p>vector 的下标可以是左边<span class="mojikumi-line-start">（</span>MSB<span class="mojikumi-line-end">）</span>大<span class="mojikumi-line-start">（</span><code>reg [7:0] byte1, byte2</code><span class="mojikumi-line-end">）</span>也可以是右边<span class="mojikumi-line-start">（</span>LSB<span class="mojikumi-line-end">）</span>大<span class="mojikumi-line-start">（</span><code>reg [1:16] bus</code><span class="mojikumi">）</span><span class="mojikumi-line-end">，</span>起止的下标都可以指定<span class="mojikumi-line-end">。</span>左边的下标对应字面量中左边的 bit<span class="mojikumi-line-end">。</span><code>byte1[7]</code> 是 <code>byte1</code> 最左边的 bit<span class="mojikumi-line-end">，</span><code>bus[16]</code> 是 <code>bus</code> 最右边的 bit<span class="mojikumi-line-end">。</span><code>bus[1:8]</code> 和 <code>bus[9:16]</code> 是 <code>bus</code> 的左右两边<span class="mojikumi-line-end">。</span>读取越界会读到 <code>x</code><span class="mojikumi-line-end">，</span>写入会忽略越界的部分<span class="mojikumi-line-end">。</span></p>
<p><code>{}</code> 用来连接 vector<span class="mojikumi-line-end">，</span>例如 <code>{2'b10, 2'b01}</code> 等于 <code>4'b1001</code><span class="mojikumi-line-end">，</span><code>{2{byte1}, 2{byte2}}</code> 等于 <code>{byte1, byte1, byte2, byte2}</code><span class="mojikumi-line-end">。</span></p>
<p>vector 可以按位进行位运算<span class="mojikumi-line-end">，</span>在二元运算中短的会高位补零后进行运算<span class="mojikumi-line-end">。</span></p>
<p>二元位运算符也有一元的版本<span class="mojikumi-line-end">，</span>表示将 vector 内所有 bit 运算在一起得到 1-bit 的结果<span class="mojikumi-line-end">，</span>例如 <code>&amp;byte1</code> 是 <code>1'b1</code> 表示 <code>byte1</code> 的所有 bit 都是 1<span class="mojikumi-line-end">。</span></p>
<p>vector 之间进行赋值时会截低位或高位补零<span class="mojikumi-line-end">。</span></p>
<p>vector 之间可以进行算术<span class="mojikumi-line-end">：</span><code>+</code><span class="mojikumi-line-end">、</span><code>-</code><span class="mojikumi-line-end">、</span><code>*</code><span class="mojikumi-line-end">、</span><code>/</code><span class="mojikumi-line-end">、</span><code>%</code><span class="mojikumi-line-end">、</span><code>**</code><span class="mojikumi-line-end">、</span><code>&lt;&lt;</code><span class="mojikumi-line-end">、</span><code>&gt;&gt;</code><span class="mojikumi-line-end">、</span><code>&lt;&lt;&lt;</code><span class="mojikumi-line-start">（</span>算术左移<span class="mojikumi">）</span><span class="mojikumi-line-end">、</span><code>&gt;&gt;&gt;</code><span class="mojikumi-line-start">（</span>算术右移<span class="mojikumi">）</span><span class="mojikumi-line-end">。</span></p>
<p>算术的高位和低位基于左右而与下标大小无关<span class="mojikumi-line-end">。</span></p>
<p>除法和取模在某些情况下可能不 synthesizable<span class="mojikumi-line-end">，</span>除非除数是 2 的次幂<span class="mojikumi-line-end">。</span>synthesizable 时也可能会生成除法器的电路而非常昂贵<span class="mojikumi-line-end">。</span></p>
<p>逻辑移位得到 unsigned<span class="mojikumi-line-end">，</span>算术移位保持原来的 signed/unsigned<span class="mojikumi-line-end">，</span>算术右移高位补符号位<span class="mojikumi-line-end">。</span>二元算术中只要有一个是 unsigned 就会将另一个转成 unsigned 再计算<span class="mojikumi-line-end">。</span>signal 可以声明为 signed<span class="mojikumi-line-end">：</span><code>reg signed [15:0] a</code><span class="mojikumi-line-end">。</span></p>
<h3 id="array" class="heading"><a href="#array" class="heading-anchor" aria-label="章节： array" tabindex="-1"></a><span>array</span></h3>
<p>array 是相同类型的一列东西<span class="mojikumi-line-start">（</span>一列 <code>reg</code><span class="mojikumi-line-end">、</span><code>integer</code><span class="mojikumi-line-end">、</span><code>wire</code> 等<span class="mojikumi">）</span><span class="mojikumi-line-end">。</span>array 也可以指定下标范围<span class="mojikumi-line-end">，</span>而与 vector 相反<span class="mojikumi-line-end">，</span>声明 array 时框放在右边<span class="mojikumi-line-end">，</span>例如 <code>reg<wbr> [<wbr>7<wbr>:<wbr>0<wbr>] <wbr>byte1<wbr>, <wbr>mem1<wbr>[<wbr>0<wbr>:<wbr>255<wbr>]</code> 表示一个 8-bit <code>reg</code> 和一个由 256 个 8-bit <code>reg</code> 组成的 array<span class="mojikumi-line-end">。</span></p>
<p>array 可以嵌套为高维数组<span class="mojikumi-line-end">，</span>而访问只能访问单个下标<span class="mojikumi-line-end">，</span>不能像 vector 一样一下访问一个区间<span class="mojikumi-line-end">。</span>总之除了能指定下标范围都和 C 的数组差不多<span class="mojikumi-line-end">。</span></p>
<h3 id="逻辑运算" class="heading"><a href="#逻辑运算" class="heading-anchor" aria-label="章节： 逻辑运算" tabindex="-1"></a><span>逻辑运算</span></h3>
<p>含 <code>x</code> / <code>z</code> 或者全 0 的 vector<span class="mojikumi-line-start">（</span>或者 <code>1'b0</code><span class="mojikumi-line-end">）</span>是 false<span class="mojikumi-line-end">，</span>不含 <code>x</code> / <code>z</code> 且含 1 的 vector<span class="mojikumi-line-start">（</span>或者 <code>1'b1</code><span class="mojikumi-line-end">）</span>是 true<span class="mojikumi-line-end">。</span>false 的值是 <code>1'b0</code><span class="mojikumi-line-end">，</span>true 的值是 <code>1'b1</code><span class="mojikumi-line-end">。</span></p>
<p>逻辑运算符和比较运算符和 C 是一样的<span class="mojikumi-line-end">。</span>比较时如果一侧是 unsigned 则会按 unsigned 比较<span class="mojikumi-line-end">。</span>比较运算在电路中可能需要比较器<span class="mojikumi-line-start">（</span>尤其是两侧都不是常量时<span class="mojikumi">）</span><span class="mojikumi-line-end">，</span>所以可能是昂贵的<span class="mojikumi-line-end">。</span></p>
<p>三目运算符 <code>?:</code> 和 C 是一样的<span class="mojikumi-line-end">。</span></p>
<p>在 test bench 中<span class="mojikumi-line-end">，</span>带 <code>x</code> / <code>z</code> 的值在比较时结果为 <code>x</code><span class="mojikumi-line-start">（</span>用在条件判断时即为 false<span class="mojikumi">）</span><span class="mojikumi-line-end">，</span>可以使用 <code>===</code> / <code>!==</code> 来逐位比较<span class="mojikumi-line-start">（</span><code>x === x</code>, <code>z === z</code><span class="mojikumi">）</span><span class="mojikumi-line-end">，</span>但它们不能用在 synthesizable module 中<span class="mojikumi-line-end">。</span></p>
<h3 id="compiler-directives" class="heading"><a href="#compiler-directives" class="heading-anchor" aria-label="章节： compiler directives" tabindex="-1"></a><span>compiler directives</span></h3>
<p><code>`include</code> 和 <code>`define</code><span class="mojikumi-line-end">，</span>和 C 是一样的<span class="mojikumi-line-end">。</span></p>
<h2 id="model" class="heading"><a href="#model" class="heading-anchor" aria-label="章节： model" tabindex="-1"></a><span>model</span></h2>
<h3 id="structural-model" class="heading"><a href="#structural-model" class="heading-anchor" aria-label="章节： structural model" tabindex="-1"></a><span>structural model</span></h3>
<p>可以使用 <i>instance statement</i> 来写 structural model<span class="mojikumi-line-end">，</span>说白了就是将其他 module 实例化并连线<span class="mojikumi-line-end">。</span></p>
<p>built-in gate 有<span class="mojikumi-line-end">：</span></p>
<ul>
<li><code>and</code><span class="mojikumi-line-end">、</span><code>nand</code><span class="mojikumi-line-end">、</span><code>or</code><span class="mojikumi-line-end">、</span><code>nor</code><span class="mojikumi-line-end">、</span><code>xor</code><span class="mojikumi-line-end">、</span><code>xnor</code><span class="mojikumi-line-end">，</span>接受任意个输入</li>
<li><code>buf</code><span class="mojikumi-line-end">、</span><code>not</code><span class="mojikumi-line-end">，</span>接受单个输入</li>
<li><code>bufif0</code><span class="mojikumi-line-end">、</span><code>bufif1</code><span class="mojikumi-line-end">、</span><code>notif0</code><span class="mojikumi-line-end">、</span><code>notif1</code><span class="mojikumi-line-end">，</span>三态门<span class="mojikumi-line-end">，</span>接受一个 data input 和一个 enable input<span class="mojikumi-line-start">（</span>data input 在前<span class="mojikumi-line-end">，</span>enable input 在后<span class="mojikumi">）</span><span class="mojikumi-line-end">，</span>if 表示 enable 的 active level</li>
</ul>
<p>使用 built-in gate 的例子<span class="mojikumi">：</span><wbr><span class="mojikumi-line-start">（</span>built-in gate 的 port 没有名字<span class="mojikumi-line-end">，</span>只能通过顺序指定<span class="mojikumi-line-end">，</span>output 在前<span class="mojikumi-line-end">）</span></p>
<section class="code-block relative my-6 shadow" itemprop="hasPart" itemscope="" itemtype="https://schema.org/SoftwareSourceCode" data-v-c675dba6=""><div class="h-6 items-center rd-t-1 bg-area px-4 dark:bg-#2A313A media-screen:important-flex" style="display:none;" data-v-c675dba6=""><h4 class="text-3 text-footer" itemprop="programmingLanguage" aria-label="SystemVerilog 代码块" data-v-c675dba6="">SystemVerilog</h4><ile-root id="ile-7"><button title="复制到剪贴板" class="copy-button b-footer text-footer" data-v-9288569d=""><span class="i-mdi-content-copy" data-v-9288569d=""></span><span class="sr-only" role="status" data-v-9288569d=""></span></button></ile-root><script></script><script type="module" async="">var s=(i,a)=>()=>(a||i((a={exports:{}}).exports,a),a.exports);var r=(i,a,o)=>new Promise((c,n)=>{var f=t=>{try{_(o.next(t))}catch(e){n(e)}},l=t=>{try{_(o.throw(t))}catch(e){n(e)}},_=t=>t.done?c(t.value):Promise.resolve(t.value).then(f,l);_((o=o.apply(i,a)).next())});import{_ as d}from"/assets/vite.5ce4fca4.js";import{b as p}from"/assets/iles.e30597ee.js";import"/assets/vendor-vue.f543892e.js";var E=s(m=>{const u=()=>r(m,null,function*(){return(yield d(()=>import("/assets/iles.e30597ee.js").then(i=>i.v),["assets/iles.e30597ee.js","assets/vendor-vue.f543892e.js","assets/vite.5ce4fca4.js"])).default}),v=()=>r(m,null,function*(){return(yield d(()=>import("/assets/CopyButton.1e9a24a4.js"),["assets/CopyButton.1e9a24a4.js","assets/vendor-vue.f543892e.js","assets/vite.5ce4fca4.js"])).default});p(u,v,"ile-7",{},{})});export default E();
</script></div><div class="dark:hidden" itemprop="text" data-v-c675dba6=""><pre class="shiki light" style="background-color: #FBFBFB" tabindex="0"><code><span><span style="color: #994CC3">module</span><span style="color: #403F53"> inhibit (</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">input</span><span style="color: #403F53">  in,</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">input</span><span style="color: #403F53">  invin,</span></span>
<span><span style="color: #4876D6">    output</span><span style="color: #403F53"> out</span></span>
<span><span style="color: #403F53">);</span></span>
<span><span style="color: #994CC3">  wire</span><span style="color: #403F53"> notinvin;</span></span>
<span><span style="color: #403F53">  </span><span style="color: #4876D6">not</span><span style="color: #403F53"> </span><span style="color: #4876D6">U1</span><span style="color: #403F53"> (notinvin, invin);</span></span>
<span><span style="color: #403F53">  </span><span style="color: #4876D6">and</span><span style="color: #403F53"> </span><span style="color: #4876D6">U2</span><span style="color: #403F53"> (out, in, notinvin);</span></span>
<span><span style="color: #994CC3">endmodule</span></span></code></pre></div><div class="dark:important-block" style="display:none;" data-v-c675dba6=""><pre class="shiki dark" style="background-color: #011627" tabindex="0"><code><span><span style="color: #C792EA">module</span><span style="color: #D6DEEB"> inhibit (</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C5E478">input</span><span style="color: #D6DEEB">  in,</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C5E478">input</span><span style="color: #D6DEEB">  invin,</span></span>
<span><span style="color: #C5E478">    output</span><span style="color: #D6DEEB"> out</span></span>
<span><span style="color: #D6DEEB">);</span></span>
<span><span style="color: #C792EA">  wire</span><span style="color: #D6DEEB"> notinvin;</span></span>
<span><span style="color: #D6DEEB">  </span><span style="color: #C5E478">not</span><span style="color: #D6DEEB"> </span><span style="color: #C5E478">U1</span><span style="color: #D6DEEB"> (notinvin, invin);</span></span>
<span><span style="color: #D6DEEB">  </span><span style="color: #C5E478">and</span><span style="color: #D6DEEB"> </span><span style="color: #C5E478">U2</span><span style="color: #D6DEEB"> (out, in, notinvin);</span></span>
<span><span style="color: #C792EA">endmodule</span></span></code></pre></div></section>
<p>使用其他 module 的例子<span class="mojikumi">：</span><wbr><span class="mojikumi-line-start">（</span>可以指定每个 port 的名字从而不依赖于顺序<span class="mojikumi-line-end">）</span></p>
<section class="code-block relative my-6 shadow" itemprop="hasPart" itemscope="" itemtype="https://schema.org/SoftwareSourceCode" data-v-c675dba6=""><div class="h-6 items-center rd-t-1 bg-area px-4 dark:bg-#2A313A media-screen:important-flex" style="display:none;" data-v-c675dba6=""><h4 class="text-3 text-footer" itemprop="programmingLanguage" aria-label="SystemVerilog 代码块" data-v-c675dba6="">SystemVerilog</h4><ile-root id="ile-8"><button title="复制到剪贴板" class="copy-button b-footer text-footer" data-v-9288569d=""><span class="i-mdi-content-copy" data-v-9288569d=""></span><span class="sr-only" role="status" data-v-9288569d=""></span></button></ile-root><script></script><script type="module" async="">var s=(i,a)=>()=>(a||i((a={exports:{}}).exports,a),a.exports);var r=(i,a,o)=>new Promise((c,n)=>{var f=t=>{try{_(o.next(t))}catch(e){n(e)}},l=t=>{try{_(o.throw(t))}catch(e){n(e)}},_=t=>t.done?c(t.value):Promise.resolve(t.value).then(f,l);_((o=o.apply(i,a)).next())});import{_ as d}from"/assets/vite.5ce4fca4.js";import{b as p}from"/assets/iles.e30597ee.js";import"/assets/vendor-vue.f543892e.js";var E=s(m=>{const u=()=>r(m,null,function*(){return(yield d(()=>import("/assets/iles.e30597ee.js").then(i=>i.v),["assets/iles.e30597ee.js","assets/vendor-vue.f543892e.js","assets/vite.5ce4fca4.js"])).default}),v=()=>r(m,null,function*(){return(yield d(()=>import("/assets/CopyButton.1e9a24a4.js"),["assets/CopyButton.1e9a24a4.js","assets/vendor-vue.f543892e.js","assets/vite.5ce4fca4.js"])).default});p(u,v,"ile-8",{},{})});export default E();
</script></div><div class="dark:hidden" itemprop="text" data-v-c675dba6=""><pre class="shiki light" style="background-color: #FBFBFB" tabindex="0"><code><span><span style="color: #994CC3">module</span><span style="color: #403F53"> silly_xor (</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">input</span><span style="color: #403F53">  in1,</span></span>
<span><span style="color: #4876D6">    input</span><span style="color: #403F53"> in2,</span></span>
<span><span style="color: #4876D6">    output</span><span style="color: #403F53"> out</span></span>
<span><span style="color: #403F53">);</span></span>
<span><span style="color: #994CC3">  wire</span><span style="color: #403F53"> inh1, inh2, notinh2, notout;</span></span>
<span><span style="color: #403F53">  </span><span style="color: #994CC3">inhibit</span><span style="color: #403F53"> U1 (</span></span>
<span><span style="color: #403F53">      .</span><span style="color: #4876D6">out</span><span style="color: #403F53">(inh1),</span></span>
<span><span style="color: #403F53">      .</span><span style="color: #4876D6">in</span><span style="color: #403F53">(in1),</span></span>
<span><span style="color: #403F53">      .</span><span style="color: #4876D6">invin</span><span style="color: #403F53">(in2)</span></span>
<span><span style="color: #403F53">  );</span></span>
<span><span style="color: #403F53">  </span><span style="color: #994CC3">inhibit</span><span style="color: #403F53"> U2 (</span></span>
<span><span style="color: #403F53">      .</span><span style="color: #4876D6">out</span><span style="color: #403F53">(inh2),</span></span>
<span><span style="color: #403F53">      .</span><span style="color: #4876D6">in</span><span style="color: #403F53">(in2),</span></span>
<span><span style="color: #403F53">      .</span><span style="color: #4876D6">invin</span><span style="color: #403F53">(in1)</span></span>
<span><span style="color: #403F53">  );</span></span>
<span><span style="color: #403F53">  </span><span style="color: #4876D6">not</span><span style="color: #403F53"> </span><span style="color: #4876D6">U3</span><span style="color: #403F53"> (notinh2, inh2);</span></span>
<span><span style="color: #403F53">  </span><span style="color: #994CC3">inhibit</span><span style="color: #403F53"> U4 (</span></span>
<span><span style="color: #403F53">      .</span><span style="color: #4876D6">out</span><span style="color: #403F53">(notout),</span></span>
<span><span style="color: #403F53">      .</span><span style="color: #4876D6">in</span><span style="color: #403F53">(notinh2),</span></span>
<span><span style="color: #403F53">      .</span><span style="color: #4876D6">invin</span><span style="color: #403F53">(inh1)</span></span>
<span><span style="color: #403F53">  );</span></span>
<span><span style="color: #403F53">  </span><span style="color: #4876D6">not</span><span style="color: #403F53"> </span><span style="color: #4876D6">U5</span><span style="color: #403F53"> (out, notout);</span></span>
<span><span style="color: #994CC3">endmodule</span></span></code></pre></div><div class="dark:important-block" style="display:none;" data-v-c675dba6=""><pre class="shiki dark" style="background-color: #011627" tabindex="0"><code><span><span style="color: #C792EA">module</span><span style="color: #D6DEEB"> silly_xor (</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C5E478">input</span><span style="color: #D6DEEB">  in1,</span></span>
<span><span style="color: #C5E478">    input</span><span style="color: #D6DEEB"> in2,</span></span>
<span><span style="color: #C5E478">    output</span><span style="color: #D6DEEB"> out</span></span>
<span><span style="color: #D6DEEB">);</span></span>
<span><span style="color: #C792EA">  wire</span><span style="color: #D6DEEB"> inh1, inh2, notinh2, notout;</span></span>
<span><span style="color: #D6DEEB">  </span><span style="color: #C792EA">inhibit</span><span style="color: #D6DEEB"> U1 (</span></span>
<span><span style="color: #D6DEEB">      .</span><span style="color: #C5E478">out</span><span style="color: #D6DEEB">(inh1),</span></span>
<span><span style="color: #D6DEEB">      .</span><span style="color: #C5E478">in</span><span style="color: #D6DEEB">(in1),</span></span>
<span><span style="color: #D6DEEB">      .</span><span style="color: #C5E478">invin</span><span style="color: #D6DEEB">(in2)</span></span>
<span><span style="color: #D6DEEB">  );</span></span>
<span><span style="color: #D6DEEB">  </span><span style="color: #C792EA">inhibit</span><span style="color: #D6DEEB"> U2 (</span></span>
<span><span style="color: #D6DEEB">      .</span><span style="color: #C5E478">out</span><span style="color: #D6DEEB">(inh2),</span></span>
<span><span style="color: #D6DEEB">      .</span><span style="color: #C5E478">in</span><span style="color: #D6DEEB">(in2),</span></span>
<span><span style="color: #D6DEEB">      .</span><span style="color: #C5E478">invin</span><span style="color: #D6DEEB">(in1)</span></span>
<span><span style="color: #D6DEEB">  );</span></span>
<span><span style="color: #D6DEEB">  </span><span style="color: #C5E478">not</span><span style="color: #D6DEEB"> </span><span style="color: #C5E478">U3</span><span style="color: #D6DEEB"> (notinh2, inh2);</span></span>
<span><span style="color: #D6DEEB">  </span><span style="color: #C792EA">inhibit</span><span style="color: #D6DEEB"> U4 (</span></span>
<span><span style="color: #D6DEEB">      .</span><span style="color: #C5E478">out</span><span style="color: #D6DEEB">(notout),</span></span>
<span><span style="color: #D6DEEB">      .</span><span style="color: #C5E478">in</span><span style="color: #D6DEEB">(notinh2),</span></span>
<span><span style="color: #D6DEEB">      .</span><span style="color: #C5E478">invin</span><span style="color: #D6DEEB">(inh1)</span></span>
<span><span style="color: #D6DEEB">  );</span></span>
<span><span style="color: #D6DEEB">  </span><span style="color: #C5E478">not</span><span style="color: #D6DEEB"> </span><span style="color: #C5E478">U5</span><span style="color: #D6DEEB"> (out, notout);</span></span>
<span><span style="color: #C792EA">endmodule</span></span></code></pre></div></section>
<p>修改 <code>parameter</code> 的例子<span class="mojikumi-line-end">：</span></p>
<section class="code-block relative my-6 shadow" itemprop="hasPart" itemscope="" itemtype="https://schema.org/SoftwareSourceCode" data-v-c675dba6=""><div class="h-6 items-center rd-t-1 bg-area px-4 dark:bg-#2A313A media-screen:important-flex" style="display:none;" data-v-c675dba6=""><h4 class="text-3 text-footer" itemprop="programmingLanguage" aria-label="SystemVerilog 代码块" data-v-c675dba6="">SystemVerilog</h4><ile-root id="ile-9"><button title="复制到剪贴板" class="copy-button b-footer text-footer" data-v-9288569d=""><span class="i-mdi-content-copy" data-v-9288569d=""></span><span class="sr-only" role="status" data-v-9288569d=""></span></button></ile-root><script></script><script type="module" async="">var s=(i,a)=>()=>(a||i((a={exports:{}}).exports,a),a.exports);var r=(i,a,o)=>new Promise((c,n)=>{var f=t=>{try{_(o.next(t))}catch(e){n(e)}},l=t=>{try{_(o.throw(t))}catch(e){n(e)}},_=t=>t.done?c(t.value):Promise.resolve(t.value).then(f,l);_((o=o.apply(i,a)).next())});import{_ as d}from"/assets/vite.5ce4fca4.js";import{b as p}from"/assets/iles.e30597ee.js";import"/assets/vendor-vue.f543892e.js";var E=s(m=>{const u=()=>r(m,null,function*(){return(yield d(()=>import("/assets/iles.e30597ee.js").then(i=>i.v),["assets/iles.e30597ee.js","assets/vendor-vue.f543892e.js","assets/vite.5ce4fca4.js"])).default}),v=()=>r(m,null,function*(){return(yield d(()=>import("/assets/CopyButton.1e9a24a4.js"),["assets/CopyButton.1e9a24a4.js","assets/vendor-vue.f543892e.js","assets/vite.5ce4fca4.js"])).default});p(u,v,"ile-9",{},{})});export default E();
</script></div><div class="dark:hidden" itemprop="text" data-v-c675dba6=""><pre class="shiki light" style="background-color: #FBFBFB" tabindex="0"><code><span><span style="color: #994CC3">module</span><span style="color: #403F53"> maj </span><span style="color: #0C969B">#</span><span style="color: #403F53">(</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">WID</span><span style="color: #403F53"> </span><span style="color: #994CC3">=</span><span style="color: #403F53"> </span><span style="color: #AA0982">1</span></span>
<span><span style="color: #403F53">) (</span></span>
<span><span style="color: #4876D6">    output</span><span style="color: #403F53"> [</span><span style="color: #4876D6">WID</span><span style="color: #994CC3">-</span><span style="color: #AA0982">1</span><span style="color: #994CC3">:</span><span style="color: #AA0982">0</span><span style="color: #403F53">] out,</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">input</span><span style="color: #403F53">  [</span><span style="color: #4876D6">WID</span><span style="color: #994CC3">-</span><span style="color: #AA0982">1</span><span style="color: #994CC3">:</span><span style="color: #AA0982">0</span><span style="color: #403F53">] i0,</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">input</span><span style="color: #403F53">  [</span><span style="color: #4876D6">WID</span><span style="color: #994CC3">-</span><span style="color: #AA0982">1</span><span style="color: #994CC3">:</span><span style="color: #AA0982">0</span><span style="color: #403F53">] i1,</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">input</span><span style="color: #403F53">  [</span><span style="color: #4876D6">WID</span><span style="color: #994CC3">-</span><span style="color: #AA0982">1</span><span style="color: #994CC3">:</span><span style="color: #AA0982">0</span><span style="color: #403F53">] i2</span></span>
<span><span style="color: #403F53">);</span></span>
<span><span style="color: #403F53">  </span><span style="color: #994CC3">assign</span><span style="color: #403F53"> out </span><span style="color: #994CC3">=</span><span style="color: #403F53"> i0 </span><span style="color: #994CC3">&amp;</span><span style="color: #403F53"> i1 </span><span style="color: #994CC3">|</span><span style="color: #403F53"> i0 </span><span style="color: #994CC3">&amp;</span><span style="color: #403F53"> i2 </span><span style="color: #994CC3">|</span><span style="color: #403F53"> i1 </span><span style="color: #994CC3">&amp;</span><span style="color: #403F53"> i2;</span></span>
<span><span style="color: #994CC3">endmodule</span></span></code></pre></div><div class="dark:important-block" style="display:none;" data-v-c675dba6=""><pre class="shiki dark" style="background-color: #011627" tabindex="0"><code><span><span style="color: #C792EA">module</span><span style="color: #D6DEEB"> maj </span><span style="color: #7FDBCA">#</span><span style="color: #D6DEEB">(</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #82AAFF">WID</span><span style="color: #D6DEEB"> </span><span style="color: #C792EA">=</span><span style="color: #D6DEEB"> </span><span style="color: #F78C6C">1</span></span>
<span><span style="color: #D6DEEB">) (</span></span>
<span><span style="color: #C5E478">    output</span><span style="color: #D6DEEB"> [</span><span style="color: #82AAFF">WID</span><span style="color: #C792EA">-</span><span style="color: #F78C6C">1</span><span style="color: #C792EA">:</span><span style="color: #F78C6C">0</span><span style="color: #D6DEEB">] out,</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C5E478">input</span><span style="color: #D6DEEB">  [</span><span style="color: #82AAFF">WID</span><span style="color: #C792EA">-</span><span style="color: #F78C6C">1</span><span style="color: #C792EA">:</span><span style="color: #F78C6C">0</span><span style="color: #D6DEEB">] i0,</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C5E478">input</span><span style="color: #D6DEEB">  [</span><span style="color: #82AAFF">WID</span><span style="color: #C792EA">-</span><span style="color: #F78C6C">1</span><span style="color: #C792EA">:</span><span style="color: #F78C6C">0</span><span style="color: #D6DEEB">] i1,</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C5E478">input</span><span style="color: #D6DEEB">  [</span><span style="color: #82AAFF">WID</span><span style="color: #C792EA">-</span><span style="color: #F78C6C">1</span><span style="color: #C792EA">:</span><span style="color: #F78C6C">0</span><span style="color: #D6DEEB">] i2</span></span>
<span><span style="color: #D6DEEB">);</span></span>
<span><span style="color: #D6DEEB">  </span><span style="color: #C792EA">assign</span><span style="color: #D6DEEB"> out </span><span style="color: #C792EA">=</span><span style="color: #D6DEEB"> i0 </span><span style="color: #C792EA">&amp;</span><span style="color: #D6DEEB"> i1 </span><span style="color: #C792EA">|</span><span style="color: #D6DEEB"> i0 </span><span style="color: #C792EA">&amp;</span><span style="color: #D6DEEB"> i2 </span><span style="color: #C792EA">|</span><span style="color: #D6DEEB"> i1 </span><span style="color: #C792EA">&amp;</span><span style="color: #D6DEEB"> i2;</span></span>
<span><span style="color: #C792EA">endmodule</span></span></code></pre></div></section>
<p>然后就可以 <code>maj #(8) U1 (.out(W), .i0(X), .i1(Y), .i2(Z))</code> 或者 <code>maj #(.WID(8)) U1 (.out(W), .i0(X), .i1(Y), .i2(Z))</code> 了<span class="mojikumi-line-end">。</span></p>
<p>不指定 <code>parameter</code> 时会使用其默认值<span class="mojikumi-line-end">，</span><code>parameter</code> 只能在 instance statement 也就是 structural model 中被修改<span class="mojikumi-line-end">，</span>在其他类型的 model 中只能使用默认值<span class="mojikumi-line-end">。</span></p>
<p>可以使用 <code>generate</code> block<span class="mojikumi-line-end">，</span>作用类似于 <code>v-for</code><span class="mojikumi-line-end">、</span><code>v-if</code><span class="mojikumi-line-end">，</span>里面可以用 <code>for</code><span class="mojikumi-line-start">（</span>循环变量需要是 <code>genvar</code><span class="mojikumi">）</span><span class="mojikumi-line-end">、</span><code>if</code><span class="mojikumi-line-end">、</span><code>case</code><span class="mojikumi-line-start">（</span>被判断的要是 parameter<span class="mojikumi">）</span><span class="mojikumi-line-end">，</span>例如<span class="mojikumi-line-end">：</span></p>
<section class="code-block relative my-6 shadow" itemprop="hasPart" itemscope="" itemtype="https://schema.org/SoftwareSourceCode" data-v-c675dba6=""><div class="h-6 items-center rd-t-1 bg-area px-4 dark:bg-#2A313A media-screen:important-flex" style="display:none;" data-v-c675dba6=""><h4 class="text-3 text-footer" itemprop="programmingLanguage" aria-label="SystemVerilog 代码块" data-v-c675dba6="">SystemVerilog</h4><ile-root id="ile-10"><button title="复制到剪贴板" class="copy-button b-footer text-footer" data-v-9288569d=""><span class="i-mdi-content-copy" data-v-9288569d=""></span><span class="sr-only" role="status" data-v-9288569d=""></span></button></ile-root><script></script><script type="module" async="">var s=(i,a)=>()=>(a||i((a={exports:{}}).exports,a),a.exports);var r=(i,a,o)=>new Promise((c,n)=>{var f=t=>{try{_(o.next(t))}catch(e){n(e)}},l=t=>{try{_(o.throw(t))}catch(e){n(e)}},_=t=>t.done?c(t.value):Promise.resolve(t.value).then(f,l);_((o=o.apply(i,a)).next())});import{_ as d}from"/assets/vite.5ce4fca4.js";import{b as p}from"/assets/iles.e30597ee.js";import"/assets/vendor-vue.f543892e.js";var E=s(m=>{const u=()=>r(m,null,function*(){return(yield d(()=>import("/assets/iles.e30597ee.js").then(i=>i.v),["assets/iles.e30597ee.js","assets/vendor-vue.f543892e.js","assets/vite.5ce4fca4.js"])).default}),v=()=>r(m,null,function*(){return(yield d(()=>import("/assets/CopyButton.1e9a24a4.js"),["assets/CopyButton.1e9a24a4.js","assets/vendor-vue.f543892e.js","assets/vite.5ce4fca4.js"])).default});p(u,v,"ile-10",{},{})});export default E();
</script></div><div class="dark:hidden" itemprop="text" data-v-c675dba6=""><pre class="shiki light" style="background-color: #FBFBFB" tabindex="0"><code><span><span style="color: #994CC3">genvar</span><span style="color: #403F53"> i;</span></span>
<span><span style="color: #994CC3">generate</span></span>
<span><span style="color: #403F53">  </span><span style="color: #994CC3">for</span><span style="color: #403F53"> (i </span><span style="color: #994CC3">=</span><span style="color: #403F53"> </span><span style="color: #AA0982">0</span><span style="color: #403F53">; i </span><span style="color: #994CC3">&lt;</span><span style="color: #403F53"> </span><span style="color: #4876D6">N</span><span style="color: #403F53">; i </span><span style="color: #994CC3">=</span><span style="color: #403F53"> i </span><span style="color: #994CC3">+</span><span style="color: #403F53"> </span><span style="color: #AA0982">1</span><span style="color: #403F53">) </span><span style="color: #994CC3">begin</span></span>
<span><span style="color: #403F53">    </span><span style="color: #994CC3">half_adder</span><span style="color: #403F53"> u0 (a[i], b[i], sum[i], cout[i]);</span></span>
<span><span style="color: #403F53">  </span><span style="color: #994CC3">end</span></span>
<span><span style="color: #994CC3">endgenerate</span></span></code></pre></div><div class="dark:important-block" style="display:none;" data-v-c675dba6=""><pre class="shiki dark" style="background-color: #011627" tabindex="0"><code><span><span style="color: #C792EA">genvar</span><span style="color: #D6DEEB"> i;</span></span>
<span><span style="color: #C792EA">generate</span></span>
<span><span style="color: #D6DEEB">  </span><span style="color: #C792EA">for</span><span style="color: #D6DEEB"> (i </span><span style="color: #C792EA">=</span><span style="color: #D6DEEB"> </span><span style="color: #F78C6C">0</span><span style="color: #D6DEEB">; i </span><span style="color: #C792EA">&lt;</span><span style="color: #D6DEEB"> </span><span style="color: #82AAFF">N</span><span style="color: #D6DEEB">; i </span><span style="color: #C792EA">=</span><span style="color: #D6DEEB"> i </span><span style="color: #C792EA">+</span><span style="color: #D6DEEB"> </span><span style="color: #F78C6C">1</span><span style="color: #D6DEEB">) </span><span style="color: #C792EA">begin</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C792EA">half_adder</span><span style="color: #D6DEEB"> u0 (a[i], b[i], sum[i], cout[i]);</span></span>
<span><span style="color: #D6DEEB">  </span><span style="color: #C792EA">end</span></span>
<span><span style="color: #C792EA">endgenerate</span></span></code></pre></div></section>
<h3 id="dataflow-model" class="heading"><a href="#dataflow-model" class="heading-anchor" aria-label="章节： dataflow model" tabindex="-1"></a><span>dataflow model</span></h3>
<p>可以使用 <i>continuous-assignment statement</i> 来写 dataflow model<span class="mojikumi-line-end">，</span>也就是 <code>assign</code><span class="mojikumi-line-end">，</span>例如<span class="mojikumi-line-end">：</span></p>
<section class="code-block relative my-6 shadow" itemprop="hasPart" itemscope="" itemtype="https://schema.org/SoftwareSourceCode" data-v-c675dba6=""><div class="h-6 items-center rd-t-1 bg-area px-4 dark:bg-#2A313A media-screen:important-flex" style="display:none;" data-v-c675dba6=""><h4 class="text-3 text-footer" itemprop="programmingLanguage" aria-label="SystemVerilog 代码块" data-v-c675dba6="">SystemVerilog</h4><ile-root id="ile-11"><button title="复制到剪贴板" class="copy-button b-footer text-footer" data-v-9288569d=""><span class="i-mdi-content-copy" data-v-9288569d=""></span><span class="sr-only" role="status" data-v-9288569d=""></span></button></ile-root><script></script><script type="module" async="">var s=(i,a)=>()=>(a||i((a={exports:{}}).exports,a),a.exports);var r=(i,a,o)=>new Promise((c,n)=>{var f=t=>{try{_(o.next(t))}catch(e){n(e)}},l=t=>{try{_(o.throw(t))}catch(e){n(e)}},_=t=>t.done?c(t.value):Promise.resolve(t.value).then(f,l);_((o=o.apply(i,a)).next())});import{_ as d}from"/assets/vite.5ce4fca4.js";import{b as p}from"/assets/iles.e30597ee.js";import"/assets/vendor-vue.f543892e.js";var E=s(m=>{const u=()=>r(m,null,function*(){return(yield d(()=>import("/assets/iles.e30597ee.js").then(i=>i.v),["assets/iles.e30597ee.js","assets/vendor-vue.f543892e.js","assets/vite.5ce4fca4.js"])).default}),v=()=>r(m,null,function*(){return(yield d(()=>import("/assets/CopyButton.1e9a24a4.js"),["assets/CopyButton.1e9a24a4.js","assets/vendor-vue.f543892e.js","assets/vite.5ce4fca4.js"])).default});p(u,v,"ile-11",{},{})});export default E();
</script></div><div class="dark:hidden" itemprop="text" data-v-c675dba6=""><pre class="shiki light" style="background-color: #FBFBFB" tabindex="0"><code><span><span style="color: #994CC3">module</span><span style="color: #403F53"> is_prime (</span></span>
<span><span style="color: #4876D6">    input</span><span style="color: #403F53"> [</span><span style="color: #AA0982">3</span><span style="color: #994CC3">:</span><span style="color: #AA0982">0</span><span style="color: #403F53">] </span><span style="color: #4876D6">N</span><span style="color: #403F53">,</span></span>
<span><span style="color: #4876D6">    output</span><span style="color: #403F53"> </span><span style="color: #4876D6">F</span></span>
<span><span style="color: #403F53">);</span></span>
<span><span style="color: #403F53">  </span><span style="color: #994CC3">assign</span><span style="color: #403F53"> </span><span style="color: #4876D6">F</span><span style="color: #403F53"> </span><span style="color: #994CC3">=</span><span style="color: #403F53"> </span><span style="color: #4876D6">N</span><span style="color: #403F53">[</span><span style="color: #AA0982">3</span><span style="color: #403F53">] </span><span style="color: #994CC3">?</span><span style="color: #403F53"> (</span><span style="color: #4876D6">N</span><span style="color: #403F53">[</span><span style="color: #AA0982">0</span><span style="color: #403F53">] </span><span style="color: #994CC3">&amp;</span><span style="color: #403F53"> (</span><span style="color: #4876D6">N</span><span style="color: #403F53">[</span><span style="color: #AA0982">1</span><span style="color: #403F53">] </span><span style="color: #994CC3">^</span><span style="color: #403F53"> </span><span style="color: #4876D6">N</span><span style="color: #403F53">[</span><span style="color: #AA0982">2</span><span style="color: #403F53">])) </span><span style="color: #994CC3">:</span><span style="color: #403F53"> (</span><span style="color: #4876D6">N</span><span style="color: #403F53">[</span><span style="color: #AA0982">0</span><span style="color: #403F53">] </span><span style="color: #994CC3">|</span><span style="color: #403F53"> (</span><span style="color: #994CC3">~</span><span style="color: #4876D6">N</span><span style="color: #403F53">[</span><span style="color: #AA0982">2</span><span style="color: #403F53">] </span><span style="color: #994CC3">&amp;</span><span style="color: #403F53"> </span><span style="color: #4876D6">N</span><span style="color: #403F53">[</span><span style="color: #AA0982">1</span><span style="color: #403F53">]));</span></span>
<span><span style="color: #994CC3">endmodule</span></span></code></pre></div><div class="dark:important-block" style="display:none;" data-v-c675dba6=""><pre class="shiki dark" style="background-color: #011627" tabindex="0"><code><span><span style="color: #C792EA">module</span><span style="color: #D6DEEB"> is_prime (</span></span>
<span><span style="color: #C5E478">    input</span><span style="color: #D6DEEB"> [</span><span style="color: #F78C6C">3</span><span style="color: #C792EA">:</span><span style="color: #F78C6C">0</span><span style="color: #D6DEEB">] </span><span style="color: #82AAFF">N</span><span style="color: #D6DEEB">,</span></span>
<span><span style="color: #C5E478">    output</span><span style="color: #D6DEEB"> </span><span style="color: #82AAFF">F</span></span>
<span><span style="color: #D6DEEB">);</span></span>
<span><span style="color: #D6DEEB">  </span><span style="color: #C792EA">assign</span><span style="color: #D6DEEB"> </span><span style="color: #82AAFF">F</span><span style="color: #D6DEEB"> </span><span style="color: #C792EA">=</span><span style="color: #D6DEEB"> </span><span style="color: #82AAFF">N</span><span style="color: #D6DEEB">[</span><span style="color: #F78C6C">3</span><span style="color: #D6DEEB">] </span><span style="color: #C792EA">?</span><span style="color: #D6DEEB"> (</span><span style="color: #82AAFF">N</span><span style="color: #D6DEEB">[</span><span style="color: #F78C6C">0</span><span style="color: #D6DEEB">] </span><span style="color: #C792EA">&amp;</span><span style="color: #D6DEEB"> (</span><span style="color: #82AAFF">N</span><span style="color: #D6DEEB">[</span><span style="color: #F78C6C">1</span><span style="color: #D6DEEB">] </span><span style="color: #C792EA">^</span><span style="color: #D6DEEB"> </span><span style="color: #82AAFF">N</span><span style="color: #D6DEEB">[</span><span style="color: #F78C6C">2</span><span style="color: #D6DEEB">])) </span><span style="color: #C792EA">:</span><span style="color: #D6DEEB"> (</span><span style="color: #82AAFF">N</span><span style="color: #D6DEEB">[</span><span style="color: #F78C6C">0</span><span style="color: #D6DEEB">] </span><span style="color: #C792EA">|</span><span style="color: #D6DEEB"> (</span><span style="color: #C792EA">~</span><span style="color: #82AAFF">N</span><span style="color: #D6DEEB">[</span><span style="color: #F78C6C">2</span><span style="color: #D6DEEB">] </span><span style="color: #C792EA">&amp;</span><span style="color: #D6DEEB"> </span><span style="color: #82AAFF">N</span><span style="color: #D6DEEB">[</span><span style="color: #F78C6C">1</span><span style="color: #D6DEEB">]));</span></span>
<span><span style="color: #C792EA">endmodule</span></span></code></pre></div></section>
<h3 id="behavioral-model" class="heading"><a href="#behavioral-model" class="heading-anchor" aria-label="章节： behavioral model" tabindex="-1"></a><span>behavioral model</span></h3>
<h4 id="always-begin-end-block" class="heading"><a href="#always-begin-end-block" class="heading-anchor" aria-label="章节： always &amp; begin-end block" tabindex="-1"></a><span><code>always</code> &amp; <code>begin</code>-<code>end</code> block</span></h4>
<p><code>always</code> statement 用来执行一句 procedural statement<span class="mojikumi-line-end">，</span>begin-end block 用来将若干 procedural statement 合成一句<span class="mojikumi-line-end">。</span>begin-end block 里的语句是顺序执行的<span class="mojikumi-line-end">，</span>而 <code>always</code> 是和 module 中的其他语句一起并行执行的<span class="mojikumi-line-end">。</span></p>
<p>在 SystemVerilog 中<span class="mojikumi-line-end">，</span>推荐使用 <code>always_comb</code><span class="mojikumi-line-end">、</span><code>always_ff</code><span class="mojikumi-line-end">、</span><code>always_latch</code> 来代替 <code>always</code><span class="mojikumi-line-end">，</span>分别用于组合逻辑<span class="mojikumi-line-end">、</span>ff 和 latch<span class="mojikumi-line-start">（</span>但一般不会特意去写 latch<span class="mojikumi">）</span><span class="mojikumi-line-end">。</span><code>always_comb</code> 会检查条件判断语句没有漏情况<span class="mojikumi-line-end">，</span>避免意外生成 latch<span class="mojikumi-line-end">。</span><code>always_ff</code> 需要加形如 <code>always_ff @(posedge clk)</code> 的 sensitivity list<span class="mojikumi-line-end">。</span></p>
<p>如果 begin-end 里有 local <code>logic</code> 则需要给 block 起名字<span class="mojikumi-line-start">（</span>在 <code>begin</code> 的后面写上 <code>: name</code><span class="mojikumi-line-end">）</span>才能在 simulation 之类的地方看到可读的变量名<span class="mojikumi-line-end">。</span></p>
<section class="code-block relative my-6 shadow" itemprop="hasPart" itemscope="" itemtype="https://schema.org/SoftwareSourceCode" data-v-c675dba6=""><div class="h-6 items-center rd-t-1 bg-area px-4 dark:bg-#2A313A media-screen:important-flex" style="display:none;" data-v-c675dba6=""><h5 class="text-3 text-footer" itemprop="programmingLanguage" aria-label="SystemVerilog 代码块" data-v-c675dba6="">SystemVerilog</h5><ile-root id="ile-12"><button title="复制到剪贴板" class="copy-button b-footer text-footer" data-v-9288569d=""><span class="i-mdi-content-copy" data-v-9288569d=""></span><span class="sr-only" role="status" data-v-9288569d=""></span></button></ile-root><script></script><script type="module" async="">var s=(i,a)=>()=>(a||i((a={exports:{}}).exports,a),a.exports);var r=(i,a,o)=>new Promise((c,n)=>{var f=t=>{try{_(o.next(t))}catch(e){n(e)}},l=t=>{try{_(o.throw(t))}catch(e){n(e)}},_=t=>t.done?c(t.value):Promise.resolve(t.value).then(f,l);_((o=o.apply(i,a)).next())});import{_ as d}from"/assets/vite.5ce4fca4.js";import{b as p}from"/assets/iles.e30597ee.js";import"/assets/vendor-vue.f543892e.js";var E=s(m=>{const u=()=>r(m,null,function*(){return(yield d(()=>import("/assets/iles.e30597ee.js").then(i=>i.v),["assets/iles.e30597ee.js","assets/vendor-vue.f543892e.js","assets/vite.5ce4fca4.js"])).default}),v=()=>r(m,null,function*(){return(yield d(()=>import("/assets/CopyButton.1e9a24a4.js"),["assets/CopyButton.1e9a24a4.js","assets/vendor-vue.f543892e.js","assets/vite.5ce4fca4.js"])).default});p(u,v,"ile-12",{},{})});export default E();
</script></div><div class="dark:hidden" itemprop="text" data-v-c675dba6=""><pre class="shiki light" style="background-color: #FBFBFB" tabindex="0"><code><span><span style="color: #994CC3">module</span><span style="color: #403F53"> alarm_circuit (</span></span>
<span><span style="color: #4876D6">    input</span><span style="color: #403F53"> panic,</span></span>
<span><span style="color: #4876D6">    input</span><span style="color: #403F53"> enable,</span></span>
<span><span style="color: #4876D6">    input</span><span style="color: #403F53"> exiting,</span></span>
<span><span style="color: #4876D6">    input</span><span style="color: #403F53"> window,</span></span>
<span><span style="color: #4876D6">    input</span><span style="color: #403F53"> door,</span></span>
<span><span style="color: #4876D6">    input</span><span style="color: #403F53"> garage,</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">output</span><span style="color: #403F53"> </span><span style="color: #994CC3">logic</span><span style="color: #403F53"> alarm</span></span>
<span><span style="color: #403F53">);</span></span>
<span><span style="color: #403F53">  </span><span style="color: #994CC3">always_comb</span><span style="color: #403F53"> </span><span style="color: #994CC3">begin</span><span style="color: #403F53"> </span><span style="color: #0C969B">:</span><span style="color: #403F53"> blk</span></span>
<span><span style="color: #994CC3">    logic</span><span style="color: #403F53"> secure;</span></span>
<span><span style="color: #403F53">    secure </span><span style="color: #994CC3">=</span><span style="color: #403F53"> window </span><span style="color: #994CC3">&amp;</span><span style="color: #403F53"> door </span><span style="color: #994CC3">&amp;</span><span style="color: #403F53"> garage;</span></span>
<span><span style="color: #403F53">    alarm  </span><span style="color: #994CC3">=</span><span style="color: #403F53"> panic </span><span style="color: #994CC3">|</span><span style="color: #403F53"> (enable </span><span style="color: #994CC3">&amp;</span><span style="color: #403F53"> </span><span style="color: #994CC3">~</span><span style="color: #403F53">exiting </span><span style="color: #994CC3">&amp;</span><span style="color: #403F53"> </span><span style="color: #994CC3">~</span><span style="color: #403F53">secure);</span></span>
<span><span style="color: #403F53">  </span><span style="color: #994CC3">end</span></span>
<span><span style="color: #994CC3">endmodule</span></span></code></pre></div><div class="dark:important-block" style="display:none;" data-v-c675dba6=""><pre class="shiki dark" style="background-color: #011627" tabindex="0"><code><span><span style="color: #C792EA">module</span><span style="color: #D6DEEB"> alarm_circuit (</span></span>
<span><span style="color: #C5E478">    input</span><span style="color: #D6DEEB"> panic,</span></span>
<span><span style="color: #C5E478">    input</span><span style="color: #D6DEEB"> enable,</span></span>
<span><span style="color: #C5E478">    input</span><span style="color: #D6DEEB"> exiting,</span></span>
<span><span style="color: #C5E478">    input</span><span style="color: #D6DEEB"> window,</span></span>
<span><span style="color: #C5E478">    input</span><span style="color: #D6DEEB"> door,</span></span>
<span><span style="color: #C5E478">    input</span><span style="color: #D6DEEB"> garage,</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C5E478">output</span><span style="color: #D6DEEB"> </span><span style="color: #C792EA">logic</span><span style="color: #D6DEEB"> alarm</span></span>
<span><span style="color: #D6DEEB">);</span></span>
<span><span style="color: #D6DEEB">  </span><span style="color: #C792EA">always_comb</span><span style="color: #D6DEEB"> </span><span style="color: #C792EA">begin</span><span style="color: #D6DEEB"> </span><span style="color: #7FDBCA">:</span><span style="color: #D6DEEB"> blk</span></span>
<span><span style="color: #C792EA">    logic</span><span style="color: #D6DEEB"> secure;</span></span>
<span><span style="color: #D6DEEB">    secure </span><span style="color: #C792EA">=</span><span style="color: #D6DEEB"> window </span><span style="color: #C792EA">&amp;</span><span style="color: #D6DEEB"> door </span><span style="color: #C792EA">&amp;</span><span style="color: #D6DEEB"> garage;</span></span>
<span><span style="color: #D6DEEB">    alarm  </span><span style="color: #C792EA">=</span><span style="color: #D6DEEB"> panic </span><span style="color: #C792EA">|</span><span style="color: #D6DEEB"> (enable </span><span style="color: #C792EA">&amp;</span><span style="color: #D6DEEB"> </span><span style="color: #C792EA">~</span><span style="color: #D6DEEB">exiting </span><span style="color: #C792EA">&amp;</span><span style="color: #D6DEEB"> </span><span style="color: #C792EA">~</span><span style="color: #D6DEEB">secure);</span></span>
<span><span style="color: #D6DEEB">  </span><span style="color: #C792EA">end</span></span>
<span><span style="color: #C792EA">endmodule</span></span></code></pre></div></section>
<h4 id="赋值" class="heading"><a href="#赋值" class="heading-anchor" aria-label="章节： 赋值" tabindex="-1"></a><span>赋值</span></h4>
<p>procedural statement 中有两种赋值<span class="mojikumi-line-end">，</span>blocking 的 <code>=</code> 和 non-blocking 的 <code>&lt;=</code><span class="mojikumi-line-end">。</span><code>=</code> 表示立即赋值<span class="mojikumi-line-end">，</span>而 <code>&lt;=</code> 会将赋值推迟至整个 <code>always</code> 的结尾<span class="mojikumi-line-start">（</span>右侧表达式的计算是立刻进行的<span class="mojikumi">）</span><span class="mojikumi-line-end">，</span>从而在 <code>always</code> 剩下的部分中左侧变量的值依然是赋值前的<span class="mojikumi-line-end">。</span></p>
<p>赋值最好遵循下面的规则<span class="mojikumi-line-end">：</span></p>
<ul>
<li>在组合逻辑中<span class="mojikumi-line-end">，</span>只使用 <code>=</code></li>
<li>在时序逻辑中<span class="mojikumi-line-end">，</span>只使用 <code>&lt;=</code></li>
<li>不要在同一个 block 中混合使用两种赋值</li>
<li>不要在不同的 <code>always</code> 中对同一个变量赋值</li>
</ul>
<h4 id="if-else-语句" class="heading"><a href="#if-else-语句" class="heading-anchor" aria-label="章节： if-else 语句" tabindex="-1"></a><span><code>if</code>-<code>else</code> 语句</span></h4>
<p>和 C 的语法是一样的<span class="mojikumi-line-end">，</span>唯一的不同就是大括号变成 <code>begin</code> - <code>end</code><span class="mojikumi-line-end">。</span></p>
<h4 id="case-语句" class="heading"><a href="#case-语句" class="heading-anchor" aria-label="章节： case 语句" tabindex="-1"></a><span><code>case</code> 语句</span></h4>
<section class="code-block relative my-6 shadow" itemprop="hasPart" itemscope="" itemtype="https://schema.org/SoftwareSourceCode" data-v-c675dba6=""><div class="h-6 items-center rd-t-1 bg-area px-4 dark:bg-#2A313A media-screen:important-flex" style="display:none;" data-v-c675dba6=""><h5 class="text-3 text-footer" itemprop="programmingLanguage" aria-label="SystemVerilog 代码块" data-v-c675dba6="">SystemVerilog</h5><ile-root id="ile-13"><button title="复制到剪贴板" class="copy-button b-footer text-footer" data-v-9288569d=""><span class="i-mdi-content-copy" data-v-9288569d=""></span><span class="sr-only" role="status" data-v-9288569d=""></span></button></ile-root><script></script><script type="module" async="">var s=(i,a)=>()=>(a||i((a={exports:{}}).exports,a),a.exports);var r=(i,a,o)=>new Promise((c,n)=>{var f=t=>{try{_(o.next(t))}catch(e){n(e)}},l=t=>{try{_(o.throw(t))}catch(e){n(e)}},_=t=>t.done?c(t.value):Promise.resolve(t.value).then(f,l);_((o=o.apply(i,a)).next())});import{_ as d}from"/assets/vite.5ce4fca4.js";import{b as p}from"/assets/iles.e30597ee.js";import"/assets/vendor-vue.f543892e.js";var E=s(m=>{const u=()=>r(m,null,function*(){return(yield d(()=>import("/assets/iles.e30597ee.js").then(i=>i.v),["assets/iles.e30597ee.js","assets/vendor-vue.f543892e.js","assets/vite.5ce4fca4.js"])).default}),v=()=>r(m,null,function*(){return(yield d(()=>import("/assets/CopyButton.1e9a24a4.js"),["assets/CopyButton.1e9a24a4.js","assets/vendor-vue.f543892e.js","assets/vite.5ce4fca4.js"])).default});p(u,v,"ile-13",{},{})});export default E();
</script></div><div class="dark:hidden" itemprop="text" data-v-c675dba6=""><pre class="shiki light" style="background-color: #FBFBFB" tabindex="0"><code><span><span style="color: #994CC3">module</span><span style="color: #403F53"> prime (</span></span>
<span><span style="color: #4876D6">    input</span><span style="color: #403F53"> [</span><span style="color: #AA0982">3</span><span style="color: #994CC3">:</span><span style="color: #AA0982">0</span><span style="color: #403F53">] n,</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">output</span><span style="color: #403F53"> </span><span style="color: #994CC3">logic</span><span style="color: #403F53"> f</span></span>
<span><span style="color: #403F53">);</span></span>
<span><span style="color: #403F53">  </span><span style="color: #994CC3">always_comb</span></span>
<span><span style="color: #403F53">    </span><span style="color: #994CC3">case</span><span style="color: #403F53"> (n)</span></span>
<span><span style="color: #403F53">      </span><span style="color: #AA0982">4'd2</span><span style="color: #403F53">, </span><span style="color: #AA0982">4'd3</span><span style="color: #403F53">, </span><span style="color: #AA0982">4'd5</span><span style="color: #403F53">, </span><span style="color: #AA0982">4'd7</span><span style="color: #403F53">, </span><span style="color: #AA0982">4'd11</span><span style="color: #403F53">, </span><span style="color: #AA0982">4'd13</span><span style="color: #994CC3">:</span><span style="color: #403F53"> f </span><span style="color: #994CC3">=</span><span style="color: #403F53"> </span><span style="color: #AA0982">1</span><span style="color: #403F53">;</span></span>
<span><span style="color: #403F53">      </span><span style="color: #994CC3">default:</span><span style="color: #403F53"> f </span><span style="color: #994CC3">=</span><span style="color: #403F53"> </span><span style="color: #AA0982">0</span><span style="color: #403F53">;</span></span>
<span><span style="color: #403F53">    </span><span style="color: #994CC3">endcase</span></span>
<span><span style="color: #994CC3">endmodule</span></span></code></pre></div><div class="dark:important-block" style="display:none;" data-v-c675dba6=""><pre class="shiki dark" style="background-color: #011627" tabindex="0"><code><span><span style="color: #C792EA">module</span><span style="color: #D6DEEB"> prime (</span></span>
<span><span style="color: #C5E478">    input</span><span style="color: #D6DEEB"> [</span><span style="color: #F78C6C">3</span><span style="color: #C792EA">:</span><span style="color: #F78C6C">0</span><span style="color: #D6DEEB">] n,</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C5E478">output</span><span style="color: #D6DEEB"> </span><span style="color: #C792EA">logic</span><span style="color: #D6DEEB"> f</span></span>
<span><span style="color: #D6DEEB">);</span></span>
<span><span style="color: #D6DEEB">  </span><span style="color: #C792EA">always_comb</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C792EA">case</span><span style="color: #D6DEEB"> (n)</span></span>
<span><span style="color: #D6DEEB">      </span><span style="color: #F78C6C">4'd2</span><span style="color: #D6DEEB">, </span><span style="color: #F78C6C">4'd3</span><span style="color: #D6DEEB">, </span><span style="color: #F78C6C">4'd5</span><span style="color: #D6DEEB">, </span><span style="color: #F78C6C">4'd7</span><span style="color: #D6DEEB">, </span><span style="color: #F78C6C">4'd11</span><span style="color: #D6DEEB">, </span><span style="color: #F78C6C">4'd13</span><span style="color: #C792EA">:</span><span style="color: #D6DEEB"> f </span><span style="color: #C792EA">=</span><span style="color: #D6DEEB"> </span><span style="color: #F78C6C">1</span><span style="color: #D6DEEB">;</span></span>
<span><span style="color: #D6DEEB">      </span><span style="color: #C792EA">default:</span><span style="color: #D6DEEB"> f </span><span style="color: #C792EA">=</span><span style="color: #D6DEEB"> </span><span style="color: #F78C6C">0</span><span style="color: #D6DEEB">;</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C792EA">endcase</span></span>
<span><span style="color: #C792EA">endmodule</span></span></code></pre></div></section>
<p>虽然并非必须<span class="mojikumi-line-end">，</span>但一般来说<span class="mojikumi-line-end">，</span>选项应当是不重复且指定了宽度的字面量<span class="mojikumi-line-end">。</span></p>
<p>即使选项覆盖了所有可能<span class="mojikumi-line-end">，</span>加上一个 <code>default</code> 可以在 simulation 中正确处理带 <code>x</code> 的值<span class="mojikumi-line-end">。</span></p>
<p><code>casez</code> 是允许使用通配符 <code>?</code> 的匹配<span class="mojikumi-line-end">，</span>例如选项可以是 <code>4'b10??</code><span class="mojikumi-line-end">。</span></p>
<h4 id="循环语句" class="heading"><a href="#循环语句" class="heading-anchor" aria-label="章节： 循环语句" tabindex="-1"></a><span>循环语句</span></h4>
<p>有很多种循环语句<span class="mojikumi-line-end">，</span>但推荐使用的只有一种<span class="mojikumi-line-end">，</span>就是 <code>for (integer i = 0; i &lt;= 7; i = i + 1)</code><span class="mojikumi-line-end">。</span></p>
<h4 id="function-和-task" class="heading"><a href="#function-和-task" class="heading-anchor" aria-label="章节： function 和 task" tabindex="-1"></a><span>function 和 task</span></h4>
<p>function 和 task 是一段可复用的 procedural statement<span class="mojikumi-line-end">，</span>写起来和 module 差不多<span class="mojikumi-line-end">，</span>需要定义在 module 内部<span class="mojikumi-line-start">（</span>可以通过 <code>`include</code> 来在不同 module 中复用<span class="mojikumi">）</span><span class="mojikumi-line-end">。</span></p>
<p>function 有单个返回值<span class="mojikumi-line-start">（</span>可以在函数名的前面给返回值设置类型<span class="mojikumi-line-end">，</span>也可以省略<span class="mojikumi-line-end">，</span>默认类型是 1-bit<span class="mojikumi">）</span><span class="mojikumi-line-end">，</span>但不能有 <code>output</code> / <code>inout</code> port<span class="mojikumi-line-end">，</span>而是以 function 自身的名字作为返回值的名字<span class="mojikumi-line-end">，</span>代码中需要对这个函数名进行赋值<span class="mojikumi-line-end">。</span>function 中不能设置延时<span class="mojikumi-line-end">。</span></p>
<section class="code-block relative my-6 shadow" itemprop="hasPart" itemscope="" itemtype="https://schema.org/SoftwareSourceCode" data-v-c675dba6=""><div class="h-6 items-center rd-t-1 bg-area px-4 dark:bg-#2A313A media-screen:important-flex" style="display:none;" data-v-c675dba6=""><h5 class="text-3 text-footer" itemprop="programmingLanguage" aria-label="SystemVerilog 代码块" data-v-c675dba6="">SystemVerilog</h5><ile-root id="ile-14"><button title="复制到剪贴板" class="copy-button b-footer text-footer" data-v-9288569d=""><span class="i-mdi-content-copy" data-v-9288569d=""></span><span class="sr-only" role="status" data-v-9288569d=""></span></button></ile-root><script></script><script type="module" async="">var s=(i,a)=>()=>(a||i((a={exports:{}}).exports,a),a.exports);var r=(i,a,o)=>new Promise((c,n)=>{var f=t=>{try{_(o.next(t))}catch(e){n(e)}},l=t=>{try{_(o.throw(t))}catch(e){n(e)}},_=t=>t.done?c(t.value):Promise.resolve(t.value).then(f,l);_((o=o.apply(i,a)).next())});import{_ as d}from"/assets/vite.5ce4fca4.js";import{b as p}from"/assets/iles.e30597ee.js";import"/assets/vendor-vue.f543892e.js";var E=s(m=>{const u=()=>r(m,null,function*(){return(yield d(()=>import("/assets/iles.e30597ee.js").then(i=>i.v),["assets/iles.e30597ee.js","assets/vendor-vue.f543892e.js","assets/vite.5ce4fca4.js"])).default}),v=()=>r(m,null,function*(){return(yield d(()=>import("/assets/CopyButton.1e9a24a4.js"),["assets/CopyButton.1e9a24a4.js","assets/vendor-vue.f543892e.js","assets/vite.5ce4fca4.js"])).default});p(u,v,"ile-14",{},{})});export default E();
</script></div><div class="dark:hidden" itemprop="text" data-v-c675dba6=""><pre class="shiki light" style="background-color: #FBFBFB" tabindex="0"><code><span><span style="color: #994CC3">module</span><span style="color: #403F53"> sillier_xor (</span></span>
<span><span style="color: #4876D6">    input</span><span style="color: #403F53"> in1,</span></span>
<span><span style="color: #4876D6">    input</span><span style="color: #403F53"> in2,</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">output</span><span style="color: #403F53"> </span><span style="color: #994CC3">logic</span><span style="color: #403F53"> out</span></span>
<span><span style="color: #403F53">);</span></span>
<span><span style="color: #403F53">  </span><span style="color: #994CC3">function</span><span style="color: #403F53"> </span><span style="color: #4876D6">inhibit</span><span style="color: #403F53">(</span><span style="color: #4876D6">input</span><span style="color: #403F53"> in,</span><span style="color: #4876D6"> input</span><span style="color: #403F53"> inv_in);</span></span>
<span><span style="color: #403F53">    inhibit </span><span style="color: #994CC3">=</span><span style="color: #403F53"> in </span><span style="color: #994CC3">&amp;</span><span style="color: #403F53"> </span><span style="color: #994CC3">~</span><span style="color: #403F53">inv_in;</span></span>
<span><span style="color: #403F53">  </span><span style="color: #994CC3">endfunction</span></span>
<span></span>
<span><span style="color: #403F53">  </span><span style="color: #994CC3">always_comb</span><span style="color: #403F53"> </span><span style="color: #994CC3">begin</span></span>
<span><span style="color: #994CC3">    logic</span><span style="color: #403F53"> inh1, inh2;</span></span>
<span><span style="color: #403F53">    inh1 </span><span style="color: #994CC3">=</span><span style="color: #403F53"> </span><span style="color: #4876D6">inhibit</span><span style="color: #403F53">(in1, in2);</span></span>
<span><span style="color: #403F53">    inh2 </span><span style="color: #994CC3">=</span><span style="color: #403F53"> </span><span style="color: #4876D6">inhibit</span><span style="color: #403F53">(in2, in1);</span></span>
<span><span style="color: #403F53">    out  </span><span style="color: #994CC3">=</span><span style="color: #403F53"> </span><span style="color: #994CC3">~</span><span style="color: #4876D6">inhibit</span><span style="color: #403F53">(</span><span style="color: #994CC3">~</span><span style="color: #403F53">inh2, inh1);</span></span>
<span><span style="color: #403F53">  </span><span style="color: #994CC3">end</span></span>
<span><span style="color: #994CC3">endmodule</span></span></code></pre></div><div class="dark:important-block" style="display:none;" data-v-c675dba6=""><pre class="shiki dark" style="background-color: #011627" tabindex="0"><code><span><span style="color: #C792EA">module</span><span style="color: #D6DEEB"> sillier_xor (</span></span>
<span><span style="color: #C5E478">    input</span><span style="color: #D6DEEB"> in1,</span></span>
<span><span style="color: #C5E478">    input</span><span style="color: #D6DEEB"> in2,</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C5E478">output</span><span style="color: #D6DEEB"> </span><span style="color: #C792EA">logic</span><span style="color: #D6DEEB"> out</span></span>
<span><span style="color: #D6DEEB">);</span></span>
<span><span style="color: #D6DEEB">  </span><span style="color: #C792EA">function</span><span style="color: #D6DEEB"> </span><span style="color: #82AAFF">inhibit</span><span style="color: #D6DEEB">(</span><span style="color: #C5E478">input</span><span style="color: #D6DEEB"> in,</span><span style="color: #C5E478"> input</span><span style="color: #D6DEEB"> inv_in);</span></span>
<span><span style="color: #D6DEEB">    inhibit </span><span style="color: #C792EA">=</span><span style="color: #D6DEEB"> in </span><span style="color: #C792EA">&amp;</span><span style="color: #D6DEEB"> </span><span style="color: #C792EA">~</span><span style="color: #D6DEEB">inv_in;</span></span>
<span><span style="color: #D6DEEB">  </span><span style="color: #C792EA">endfunction</span></span>
<span></span>
<span><span style="color: #D6DEEB">  </span><span style="color: #C792EA">always_comb</span><span style="color: #D6DEEB"> </span><span style="color: #C792EA">begin</span></span>
<span><span style="color: #C792EA">    logic</span><span style="color: #D6DEEB"> inh1, inh2;</span></span>
<span><span style="color: #D6DEEB">    inh1 </span><span style="color: #C792EA">=</span><span style="color: #D6DEEB"> </span><span style="color: #C5E478">inhibit</span><span style="color: #D6DEEB">(in1, in2);</span></span>
<span><span style="color: #D6DEEB">    inh2 </span><span style="color: #C792EA">=</span><span style="color: #D6DEEB"> </span><span style="color: #C5E478">inhibit</span><span style="color: #D6DEEB">(in2, in1);</span></span>
<span><span style="color: #D6DEEB">    out  </span><span style="color: #C792EA">=</span><span style="color: #D6DEEB"> </span><span style="color: #C792EA">~</span><span style="color: #C5E478">inhibit</span><span style="color: #D6DEEB">(</span><span style="color: #C792EA">~</span><span style="color: #D6DEEB">inh2, inh1);</span></span>
<span><span style="color: #D6DEEB">  </span><span style="color: #C792EA">end</span></span>
<span><span style="color: #C792EA">endmodule</span></span></code></pre></div></section>
<p>task 没有返回值<span class="mojikumi-line-end">，</span>但可以有 <code>output</code> / <code>inout</code> port<span class="mojikumi">，</span><wbr><span class="mojikumi-line-start">（</span>用于 simulation 时<span class="mojikumi-line-end">）</span>可以设置延时<span class="mojikumi-line-end">。</span></p>
<section class="code-block relative my-6 shadow" itemprop="hasPart" itemscope="" itemtype="https://schema.org/SoftwareSourceCode" data-v-c675dba6=""><div class="h-6 items-center rd-t-1 bg-area px-4 dark:bg-#2A313A media-screen:important-flex" style="display:none;" data-v-c675dba6=""><h5 class="text-3 text-footer" itemprop="programmingLanguage" aria-label="SystemVerilog 代码块" data-v-c675dba6="">SystemVerilog</h5><ile-root id="ile-15"><button title="复制到剪贴板" class="copy-button b-footer text-footer" data-v-9288569d=""><span class="i-mdi-content-copy" data-v-9288569d=""></span><span class="sr-only" role="status" data-v-9288569d=""></span></button></ile-root><script></script><script type="module" async="">var s=(i,a)=>()=>(a||i((a={exports:{}}).exports,a),a.exports);var r=(i,a,o)=>new Promise((c,n)=>{var f=t=>{try{_(o.next(t))}catch(e){n(e)}},l=t=>{try{_(o.throw(t))}catch(e){n(e)}},_=t=>t.done?c(t.value):Promise.resolve(t.value).then(f,l);_((o=o.apply(i,a)).next())});import{_ as d}from"/assets/vite.5ce4fca4.js";import{b as p}from"/assets/iles.e30597ee.js";import"/assets/vendor-vue.f543892e.js";var E=s(m=>{const u=()=>r(m,null,function*(){return(yield d(()=>import("/assets/iles.e30597ee.js").then(i=>i.v),["assets/iles.e30597ee.js","assets/vendor-vue.f543892e.js","assets/vite.5ce4fca4.js"])).default}),v=()=>r(m,null,function*(){return(yield d(()=>import("/assets/CopyButton.1e9a24a4.js"),["assets/CopyButton.1e9a24a4.js","assets/vendor-vue.f543892e.js","assets/vite.5ce4fca4.js"])).default});p(u,v,"ile-15",{},{})});export default E();
</script></div><div class="dark:hidden" itemprop="text" data-v-c675dba6=""><pre class="shiki light" style="background-color: #FBFBFB" tabindex="0"><code><span><span style="color: #994CC3">module</span><span style="color: #403F53"> lock_sim;</span></span>
<span></span>
<span><span style="color: #403F53">  ...</span></span>
<span></span>
<span><span style="color: #403F53">  </span><span style="color: #994CC3">task</span><span style="color: #403F53"> </span><span style="color: #4876D6">clock</span><span style="color: #403F53">();</span></span>
<span><span style="color: #403F53">    </span><span style="color: #0C969B">#</span><span style="color: #AA0982">500</span><span style="color: #403F53">;</span></span>
<span><span style="color: #403F53">    clk </span><span style="color: #994CC3">=</span><span style="color: #403F53"> </span><span style="color: #AA0982">1</span><span style="color: #403F53">;</span></span>
<span><span style="color: #403F53">    </span><span style="color: #0C969B">#</span><span style="color: #AA0982">500</span><span style="color: #403F53">;</span></span>
<span><span style="color: #403F53">    clk </span><span style="color: #994CC3">=</span><span style="color: #403F53"> </span><span style="color: #AA0982">0</span><span style="color: #403F53">;</span></span>
<span><span style="color: #403F53">  </span><span style="color: #994CC3">endtask</span></span>
<span></span>
<span><span style="color: #403F53">  ...</span></span>
<span></span>
<span><span style="color: #994CC3">endmodule</span></span></code></pre></div><div class="dark:important-block" style="display:none;" data-v-c675dba6=""><pre class="shiki dark" style="background-color: #011627" tabindex="0"><code><span><span style="color: #C792EA">module</span><span style="color: #D6DEEB"> lock_sim;</span></span>
<span></span>
<span><span style="color: #D6DEEB">  ...</span></span>
<span></span>
<span><span style="color: #D6DEEB">  </span><span style="color: #C792EA">task</span><span style="color: #D6DEEB"> </span><span style="color: #82AAFF">clock</span><span style="color: #D6DEEB">();</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #7FDBCA">#</span><span style="color: #F78C6C">500</span><span style="color: #D6DEEB">;</span></span>
<span><span style="color: #D6DEEB">    clk </span><span style="color: #C792EA">=</span><span style="color: #D6DEEB"> </span><span style="color: #F78C6C">1</span><span style="color: #D6DEEB">;</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #7FDBCA">#</span><span style="color: #F78C6C">500</span><span style="color: #D6DEEB">;</span></span>
<span><span style="color: #D6DEEB">    clk </span><span style="color: #C792EA">=</span><span style="color: #D6DEEB"> </span><span style="color: #F78C6C">0</span><span style="color: #D6DEEB">;</span></span>
<span><span style="color: #D6DEEB">  </span><span style="color: #C792EA">endtask</span></span>
<span></span>
<span><span style="color: #D6DEEB">  ...</span></span>
<span></span>
<span><span style="color: #C792EA">endmodule</span></span></code></pre></div></section>
<p>有一些内置的 task 和 function<span class="mojikumi-line-end">，</span>用于 simulation<span class="mojikumi-line-end">：</span></p>
<ul>
<li><code>$write</code><span class="mojikumi-line-end">：</span>和 <code>printf</code> 差不多<span class="mojikumi-line-end">。</span></li>
<li><code>$display</code><span class="mojikumi-line-end">：</span>在 <code>$write</code> 的基础上多个换行<span class="mojikumi-line-end">。</span></li>
<li><code>$monitor</code><span class="mojikumi-line-end">：</span>每次信号发生改变时都输出<span class="mojikumi-line-end">，</span>后指定的 monitor 会覆盖之前的<span class="mojikumi-line-end">。</span></li>
<li><code>$<wbr>monitoroff</code> / <code>$monitoron</code></li>
<li><code>$fflush</code><span class="mojikumi-line-end">：</span>flush 输出<span class="mojikumi-line-end">。</span></li>
<li><code>$time</code><span class="mojikumi-line-end">：</span>输出当前的 simulated time<span class="mojikumi-line-end">。</span></li>
<li><code>$random</code><span class="mojikumi-line-end">：</span>返回一个随机数<span class="mojikumi-line-end">，</span>接受种子作为参数<span class="mojikumi-line-end">，</span>不指定种子的话初次运行的种子是固定的<span class="mojikumi-line-end">。</span></li>
<li><code>$stop</code><span class="mojikumi-line-end">：</span>停止模拟<span class="mojikumi-line-end">，</span>如果传参 <code>(1)</code> 则会显示当前的 simulated time 和代码位置<span class="mojikumi-line-end">。</span></li>
</ul>
<h2 id="timescale-指定延迟" class="heading"><a href="#timescale-指定延迟" class="heading-anchor" aria-label="章节： timescale &amp; 指定延迟" tabindex="-1"></a><span>timescale &amp; 指定延迟</span></h2>
<p><code>`timescale 1ns / 10ps</code> 指定以 1ns 作为延时的单位<span class="mojikumi-line-end">，</span>以 10ps 作为模拟的精度<span class="mojikumi-line-end">。</span></p>
<p><code>assign</code> 时可以指定延迟<span class="mojikumi-line-end">：</span><code>assign #5 a = b &amp; c;</code></p>
<p>procedural model 中可以用 delay statement (<code>#500;</code>) 来暂停<span class="mojikumi-line-end">。</span></p>
<h2 id="simulation-test-bench" class="heading"><a href="#simulation-test-bench" class="heading-anchor" aria-label="章节： simulation (test bench)" tabindex="-1"></a><span>simulation (test bench)</span></h2>
<p>语法上和 synthesizable module 没有区别<span class="mojikumi-line-start">（</span>只不过有个 <code>initial</code><span class="mojikumi-line-end">，</span>就是只执行一遍的 <code>always</code><span class="mojikumi-line-end">，</span>一般不用于 synthesizable module<span class="mojikumi">）</span><span class="mojikumi-line-end">。</span>写起来一般是一个没有输入输出<span class="mojikumi-line-end">、</span>有一个被测试 module 的实例<span class="mojikumi-line-end">、</span>有一个 <code>initial</code> block 的 module<span class="mojikumi-line-end">，</span>看看例子就行<span class="mojikumi-line-end">。</span></p>
<p>懒得改 DDPP 上的代码了<span class="mojikumi-line-end">，</span>直接复制一份数字逻辑实验的代码<span class="mojikumi-line-start">（</span></p>
<section class="code-block relative my-6 shadow" itemprop="hasPart" itemscope="" itemtype="https://schema.org/SoftwareSourceCode" data-v-c675dba6=""><div class="h-6 items-center rd-t-1 bg-area px-4 dark:bg-#2A313A media-screen:important-flex" style="display:none;" data-v-c675dba6=""><h3 class="text-3 text-footer" itemprop="programmingLanguage" aria-label="SystemVerilog 代码块" data-v-c675dba6="">SystemVerilog</h3><ile-root id="ile-16"><button title="复制到剪贴板" class="copy-button b-footer text-footer" data-v-9288569d=""><span class="i-mdi-content-copy" data-v-9288569d=""></span><span class="sr-only" role="status" data-v-9288569d=""></span></button></ile-root><script></script><script type="module" async="">var s=(i,a)=>()=>(a||i((a={exports:{}}).exports,a),a.exports);var r=(i,a,o)=>new Promise((c,n)=>{var f=t=>{try{_(o.next(t))}catch(e){n(e)}},l=t=>{try{_(o.throw(t))}catch(e){n(e)}},_=t=>t.done?c(t.value):Promise.resolve(t.value).then(f,l);_((o=o.apply(i,a)).next())});import{_ as d}from"/assets/vite.5ce4fca4.js";import{b as p}from"/assets/iles.e30597ee.js";import"/assets/vendor-vue.f543892e.js";var E=s(m=>{const u=()=>r(m,null,function*(){return(yield d(()=>import("/assets/iles.e30597ee.js").then(i=>i.v),["assets/iles.e30597ee.js","assets/vendor-vue.f543892e.js","assets/vite.5ce4fca4.js"])).default}),v=()=>r(m,null,function*(){return(yield d(()=>import("/assets/CopyButton.1e9a24a4.js"),["assets/CopyButton.1e9a24a4.js","assets/vendor-vue.f543892e.js","assets/vite.5ce4fca4.js"])).default});p(u,v,"ile-16",{},{})});export default E();
</script></div><div class="dark:hidden" itemprop="text" data-v-c675dba6=""><pre class="shiki light" style="background-color: #FBFBFB" tabindex="0"><code><span><span style="color: #4876D6">`timescale</span><span style="color: #403F53"> </span><span style="color: #AA0982">1ns</span><span style="color: #403F53"> </span><span style="color: #994CC3">/</span><span style="color: #403F53"> </span><span style="color: #AA0982">1ps</span></span>
<span></span>
<span><span style="color: #994CC3">module</span><span style="color: #403F53"> lock_sim;</span></span>
<span><span style="color: #994CC3">  logic</span><span style="color: #403F53"> clk </span><span style="color: #994CC3">=</span><span style="color: #403F53"> </span><span style="color: #AA0982">0</span><span style="color: #403F53">;</span></span>
<span><span style="color: #994CC3">  logic</span><span style="color: #403F53"> rst </span><span style="color: #994CC3">=</span><span style="color: #403F53"> </span><span style="color: #AA0982">0</span><span style="color: #403F53">;</span></span>
<span><span style="color: #994CC3">  logic</span><span style="color: #403F53"> mode </span><span style="color: #994CC3">=</span><span style="color: #403F53"> </span><span style="color: #AA0982">1</span><span style="color: #403F53">;</span></span>
<span><span style="color: #994CC3">  logic</span><span style="color: #403F53"> [</span><span style="color: #AA0982">3</span><span style="color: #994CC3">:</span><span style="color: #AA0982">0</span><span style="color: #403F53">] digit_input </span><span style="color: #994CC3">=</span><span style="color: #403F53"> </span><span style="color: #AA0982">0</span><span style="color: #403F53">;</span></span>
<span><span style="color: #994CC3">  wire</span><span style="color: #403F53"> unlocked, incorrect, alert;</span></span>
<span></span>
<span><span style="color: #403F53">  </span><span style="color: #994CC3">lock</span><span style="color: #403F53"> </span><span style="color: #0C969B">#</span><span style="color: #403F53">(</span></span>
<span><span style="color: #403F53">      .</span><span style="color: #4876D6">ADMIN_PASSWORD</span><span style="color: #403F53">(</span><span style="color: #AA0982">16'ha73f</span><span style="color: #403F53">)</span></span>
<span><span style="color: #403F53">  ) lock_inst (</span></span>
<span><span style="color: #403F53">      .</span><span style="color: #4876D6">clk</span><span style="color: #403F53">(clk),</span></span>
<span><span style="color: #403F53">      .</span><span style="color: #4876D6">rst</span><span style="color: #403F53">(rst),</span></span>
<span><span style="color: #403F53">      .</span><span style="color: #4876D6">mode</span><span style="color: #403F53">(mode),</span></span>
<span><span style="color: #403F53">      .</span><span style="color: #4876D6">digit_input</span><span style="color: #403F53">(digit_input),</span></span>
<span><span style="color: #403F53">      .</span><span style="color: #4876D6">unlocked</span><span style="color: #403F53">(unlocked),</span></span>
<span><span style="color: #403F53">      .</span><span style="color: #4876D6">incorrect</span><span style="color: #403F53">(incorrect),</span></span>
<span><span style="color: #403F53">      .</span><span style="color: #4876D6">alert</span><span style="color: #403F53">(alert)</span></span>
<span><span style="color: #403F53">  );</span></span>
<span></span>
<span><span style="color: #403F53">  </span><span style="color: #994CC3">task</span><span style="color: #403F53"> </span><span style="color: #4876D6">clock</span><span style="color: #403F53">();</span></span>
<span><span style="color: #403F53">    </span><span style="color: #0C969B">#</span><span style="color: #AA0982">500</span><span style="color: #403F53">;</span></span>
<span><span style="color: #403F53">    clk </span><span style="color: #994CC3">=</span><span style="color: #403F53"> </span><span style="color: #AA0982">1</span><span style="color: #403F53">;</span></span>
<span><span style="color: #403F53">    </span><span style="color: #0C969B">#</span><span style="color: #AA0982">500</span><span style="color: #403F53">;</span></span>
<span><span style="color: #403F53">    clk </span><span style="color: #994CC3">=</span><span style="color: #403F53"> </span><span style="color: #AA0982">0</span><span style="color: #403F53">;</span></span>
<span><span style="color: #403F53">  </span><span style="color: #994CC3">endtask</span></span>
<span></span>
<span><span style="color: #403F53">  </span><span style="color: #994CC3">task</span><span style="color: #403F53"> </span><span style="color: #4876D6">reset</span><span style="color: #403F53">();</span></span>
<span><span style="color: #403F53">    rst </span><span style="color: #994CC3">=</span><span style="color: #403F53"> </span><span style="color: #AA0982">1</span><span style="color: #403F53">;</span></span>
<span><span style="color: #403F53">    </span><span style="color: #0C969B">#</span><span style="color: #AA0982">500</span><span style="color: #403F53">;</span></span>
<span><span style="color: #403F53">    rst </span><span style="color: #994CC3">=</span><span style="color: #403F53"> </span><span style="color: #AA0982">0</span><span style="color: #403F53">;</span></span>
<span><span style="color: #403F53">    </span><span style="color: #0C969B">#</span><span style="color: #AA0982">500</span><span style="color: #403F53">;</span></span>
<span><span style="color: #403F53">  </span><span style="color: #994CC3">endtask</span></span>
<span></span>
<span><span style="color: #403F53">  </span><span style="color: #994CC3">task</span><span style="color: #403F53"> </span><span style="color: #4876D6">input_password</span><span style="color: #403F53">(</span><span style="color: #4876D6">input</span><span style="color: #403F53"> [</span><span style="color: #AA0982">15</span><span style="color: #994CC3">:</span><span style="color: #AA0982">0</span><span style="color: #403F53">] password);</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">reset</span><span style="color: #403F53">();</span></span>
<span><span style="color: #403F53">    digit_input </span><span style="color: #994CC3">=</span><span style="color: #403F53"> password[</span><span style="color: #AA0982">15</span><span style="color: #994CC3">:</span><span style="color: #AA0982">12</span><span style="color: #403F53">];</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">clock</span><span style="color: #403F53">();</span></span>
<span><span style="color: #403F53">    digit_input </span><span style="color: #994CC3">=</span><span style="color: #403F53"> password[</span><span style="color: #AA0982">11</span><span style="color: #994CC3">:</span><span style="color: #AA0982">8</span><span style="color: #403F53">];</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">clock</span><span style="color: #403F53">();</span></span>
<span><span style="color: #403F53">    digit_input </span><span style="color: #994CC3">=</span><span style="color: #403F53"> password[</span><span style="color: #AA0982">7</span><span style="color: #994CC3">:</span><span style="color: #AA0982">4</span><span style="color: #403F53">];</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">clock</span><span style="color: #403F53">();</span></span>
<span><span style="color: #403F53">    digit_input </span><span style="color: #994CC3">=</span><span style="color: #403F53"> password[</span><span style="color: #AA0982">3</span><span style="color: #994CC3">:</span><span style="color: #AA0982">0</span><span style="color: #403F53">];</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">clock</span><span style="color: #403F53">();</span></span>
<span><span style="color: #403F53">  </span><span style="color: #994CC3">endtask</span></span>
<span></span>
<span><span style="color: #403F53">  </span><span style="color: #994CC3">initial</span><span style="color: #403F53"> </span><span style="color: #994CC3">begin</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">input_password</span><span style="color: #403F53">(</span><span style="color: #AA0982">16'ha73f</span><span style="color: #403F53">);  </span><span style="color: #939DBB">// admin password</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">input_password</span><span style="color: #403F53">(</span><span style="color: #AA0982">16'h1234</span><span style="color: #403F53">);  </span><span style="color: #939DBB">// incorrect</span></span>
<span></span>
<span><span style="color: #403F53">    mode </span><span style="color: #994CC3">=</span><span style="color: #403F53"> </span><span style="color: #AA0982">0</span><span style="color: #403F53">;</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">input_password</span><span style="color: #403F53">(</span><span style="color: #AA0982">16'h1234</span><span style="color: #403F53">);  </span><span style="color: #939DBB">// set password</span></span>
<span></span>
<span><span style="color: #403F53">    mode </span><span style="color: #994CC3">=</span><span style="color: #403F53"> </span><span style="color: #AA0982">1</span><span style="color: #403F53">;</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">input_password</span><span style="color: #403F53">(</span><span style="color: #AA0982">16'h4321</span><span style="color: #403F53">);  </span><span style="color: #939DBB">// incorrect</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">input_password</span><span style="color: #403F53">(</span><span style="color: #AA0982">16'h1234</span><span style="color: #403F53">);  </span><span style="color: #939DBB">// correct</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">input_password</span><span style="color: #403F53">(</span><span style="color: #AA0982">16'ha73f</span><span style="color: #403F53">);  </span><span style="color: #939DBB">// admin password</span></span>
<span></span>
<span><span style="color: #403F53">    </span><span style="color: #939DBB">// incorrect three times</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">input_password</span><span style="color: #403F53">(</span><span style="color: #AA0982">16'h4321</span><span style="color: #403F53">);</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">input_password</span><span style="color: #403F53">(</span><span style="color: #AA0982">16'h4321</span><span style="color: #403F53">);</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">input_password</span><span style="color: #403F53">(</span><span style="color: #AA0982">16'h4321</span><span style="color: #403F53">);</span></span>
<span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">input_password</span><span style="color: #403F53">(</span><span style="color: #AA0982">16'h1234</span><span style="color: #403F53">);  </span><span style="color: #939DBB">// locked</span></span>
<span></span>
<span><span style="color: #403F53">    mode </span><span style="color: #994CC3">=</span><span style="color: #403F53"> </span><span style="color: #AA0982">0</span><span style="color: #403F53">;</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">input_password</span><span style="color: #403F53">(</span><span style="color: #AA0982">16'h4321</span><span style="color: #403F53">);  </span><span style="color: #939DBB">// cannot set password</span></span>
<span></span>
<span><span style="color: #403F53">    mode </span><span style="color: #994CC3">=</span><span style="color: #403F53"> </span><span style="color: #AA0982">1</span><span style="color: #403F53">;</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">input_password</span><span style="color: #403F53">(</span><span style="color: #AA0982">16'h1234</span><span style="color: #403F53">);  </span><span style="color: #939DBB">// locked</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">input_password</span><span style="color: #403F53">(</span><span style="color: #AA0982">16'h4321</span><span style="color: #403F53">);  </span><span style="color: #939DBB">// incorrect</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">input_password</span><span style="color: #403F53">(</span><span style="color: #AA0982">16'ha73f</span><span style="color: #403F53">);  </span><span style="color: #939DBB">// admin password</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">input_password</span><span style="color: #403F53">(</span><span style="color: #AA0982">16'h1234</span><span style="color: #403F53">);  </span><span style="color: #939DBB">// correct</span></span>
<span><span style="color: #403F53">    </span><span style="color: #4876D6">input_password</span><span style="color: #403F53">(</span><span style="color: #AA0982">16'h4321</span><span style="color: #403F53">);  </span><span style="color: #939DBB">// incorrect</span></span>
<span><span style="color: #403F53">  </span><span style="color: #994CC3">end</span></span>
<span><span style="color: #994CC3">endmodule</span></span></code></pre></div><div class="dark:important-block" style="display:none;" data-v-c675dba6=""><pre class="shiki dark" style="background-color: #011627" tabindex="0"><code><span><span style="color: #82AAFF">`timescale</span><span style="color: #D6DEEB"> </span><span style="color: #F78C6C">1ns</span><span style="color: #D6DEEB"> </span><span style="color: #C792EA">/</span><span style="color: #D6DEEB"> </span><span style="color: #F78C6C">1ps</span></span>
<span></span>
<span><span style="color: #C792EA">module</span><span style="color: #D6DEEB"> lock_sim;</span></span>
<span><span style="color: #C792EA">  logic</span><span style="color: #D6DEEB"> clk </span><span style="color: #C792EA">=</span><span style="color: #D6DEEB"> </span><span style="color: #F78C6C">0</span><span style="color: #D6DEEB">;</span></span>
<span><span style="color: #C792EA">  logic</span><span style="color: #D6DEEB"> rst </span><span style="color: #C792EA">=</span><span style="color: #D6DEEB"> </span><span style="color: #F78C6C">0</span><span style="color: #D6DEEB">;</span></span>
<span><span style="color: #C792EA">  logic</span><span style="color: #D6DEEB"> mode </span><span style="color: #C792EA">=</span><span style="color: #D6DEEB"> </span><span style="color: #F78C6C">1</span><span style="color: #D6DEEB">;</span></span>
<span><span style="color: #C792EA">  logic</span><span style="color: #D6DEEB"> [</span><span style="color: #F78C6C">3</span><span style="color: #C792EA">:</span><span style="color: #F78C6C">0</span><span style="color: #D6DEEB">] digit_input </span><span style="color: #C792EA">=</span><span style="color: #D6DEEB"> </span><span style="color: #F78C6C">0</span><span style="color: #D6DEEB">;</span></span>
<span><span style="color: #C792EA">  wire</span><span style="color: #D6DEEB"> unlocked, incorrect, alert;</span></span>
<span></span>
<span><span style="color: #D6DEEB">  </span><span style="color: #C792EA">lock</span><span style="color: #D6DEEB"> </span><span style="color: #7FDBCA">#</span><span style="color: #D6DEEB">(</span></span>
<span><span style="color: #D6DEEB">      .</span><span style="color: #C5E478">ADMIN_PASSWORD</span><span style="color: #D6DEEB">(</span><span style="color: #F78C6C">16'ha73f</span><span style="color: #D6DEEB">)</span></span>
<span><span style="color: #D6DEEB">  ) lock_inst (</span></span>
<span><span style="color: #D6DEEB">      .</span><span style="color: #C5E478">clk</span><span style="color: #D6DEEB">(clk),</span></span>
<span><span style="color: #D6DEEB">      .</span><span style="color: #C5E478">rst</span><span style="color: #D6DEEB">(rst),</span></span>
<span><span style="color: #D6DEEB">      .</span><span style="color: #C5E478">mode</span><span style="color: #D6DEEB">(mode),</span></span>
<span><span style="color: #D6DEEB">      .</span><span style="color: #C5E478">digit_input</span><span style="color: #D6DEEB">(digit_input),</span></span>
<span><span style="color: #D6DEEB">      .</span><span style="color: #C5E478">unlocked</span><span style="color: #D6DEEB">(unlocked),</span></span>
<span><span style="color: #D6DEEB">      .</span><span style="color: #C5E478">incorrect</span><span style="color: #D6DEEB">(incorrect),</span></span>
<span><span style="color: #D6DEEB">      .</span><span style="color: #C5E478">alert</span><span style="color: #D6DEEB">(alert)</span></span>
<span><span style="color: #D6DEEB">  );</span></span>
<span></span>
<span><span style="color: #D6DEEB">  </span><span style="color: #C792EA">task</span><span style="color: #D6DEEB"> </span><span style="color: #82AAFF">clock</span><span style="color: #D6DEEB">();</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #7FDBCA">#</span><span style="color: #F78C6C">500</span><span style="color: #D6DEEB">;</span></span>
<span><span style="color: #D6DEEB">    clk </span><span style="color: #C792EA">=</span><span style="color: #D6DEEB"> </span><span style="color: #F78C6C">1</span><span style="color: #D6DEEB">;</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #7FDBCA">#</span><span style="color: #F78C6C">500</span><span style="color: #D6DEEB">;</span></span>
<span><span style="color: #D6DEEB">    clk </span><span style="color: #C792EA">=</span><span style="color: #D6DEEB"> </span><span style="color: #F78C6C">0</span><span style="color: #D6DEEB">;</span></span>
<span><span style="color: #D6DEEB">  </span><span style="color: #C792EA">endtask</span></span>
<span></span>
<span><span style="color: #D6DEEB">  </span><span style="color: #C792EA">task</span><span style="color: #D6DEEB"> </span><span style="color: #82AAFF">reset</span><span style="color: #D6DEEB">();</span></span>
<span><span style="color: #D6DEEB">    rst </span><span style="color: #C792EA">=</span><span style="color: #D6DEEB"> </span><span style="color: #F78C6C">1</span><span style="color: #D6DEEB">;</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #7FDBCA">#</span><span style="color: #F78C6C">500</span><span style="color: #D6DEEB">;</span></span>
<span><span style="color: #D6DEEB">    rst </span><span style="color: #C792EA">=</span><span style="color: #D6DEEB"> </span><span style="color: #F78C6C">0</span><span style="color: #D6DEEB">;</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #7FDBCA">#</span><span style="color: #F78C6C">500</span><span style="color: #D6DEEB">;</span></span>
<span><span style="color: #D6DEEB">  </span><span style="color: #C792EA">endtask</span></span>
<span></span>
<span><span style="color: #D6DEEB">  </span><span style="color: #C792EA">task</span><span style="color: #D6DEEB"> </span><span style="color: #82AAFF">input_password</span><span style="color: #D6DEEB">(</span><span style="color: #C5E478">input</span><span style="color: #D6DEEB"> [</span><span style="color: #F78C6C">15</span><span style="color: #C792EA">:</span><span style="color: #F78C6C">0</span><span style="color: #D6DEEB">] password);</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C5E478">reset</span><span style="color: #D6DEEB">();</span></span>
<span><span style="color: #D6DEEB">    digit_input </span><span style="color: #C792EA">=</span><span style="color: #D6DEEB"> password[</span><span style="color: #F78C6C">15</span><span style="color: #C792EA">:</span><span style="color: #F78C6C">12</span><span style="color: #D6DEEB">];</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C5E478">clock</span><span style="color: #D6DEEB">();</span></span>
<span><span style="color: #D6DEEB">    digit_input </span><span style="color: #C792EA">=</span><span style="color: #D6DEEB"> password[</span><span style="color: #F78C6C">11</span><span style="color: #C792EA">:</span><span style="color: #F78C6C">8</span><span style="color: #D6DEEB">];</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C5E478">clock</span><span style="color: #D6DEEB">();</span></span>
<span><span style="color: #D6DEEB">    digit_input </span><span style="color: #C792EA">=</span><span style="color: #D6DEEB"> password[</span><span style="color: #F78C6C">7</span><span style="color: #C792EA">:</span><span style="color: #F78C6C">4</span><span style="color: #D6DEEB">];</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C5E478">clock</span><span style="color: #D6DEEB">();</span></span>
<span><span style="color: #D6DEEB">    digit_input </span><span style="color: #C792EA">=</span><span style="color: #D6DEEB"> password[</span><span style="color: #F78C6C">3</span><span style="color: #C792EA">:</span><span style="color: #F78C6C">0</span><span style="color: #D6DEEB">];</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C5E478">clock</span><span style="color: #D6DEEB">();</span></span>
<span><span style="color: #D6DEEB">  </span><span style="color: #C792EA">endtask</span></span>
<span></span>
<span><span style="color: #D6DEEB">  </span><span style="color: #C792EA">initial</span><span style="color: #D6DEEB"> </span><span style="color: #C792EA">begin</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C5E478">input_password</span><span style="color: #D6DEEB">(</span><span style="color: #F78C6C">16'ha73f</span><span style="color: #D6DEEB">);  </span><span style="color: #637777">// admin password</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C5E478">input_password</span><span style="color: #D6DEEB">(</span><span style="color: #F78C6C">16'h1234</span><span style="color: #D6DEEB">);  </span><span style="color: #637777">// incorrect</span></span>
<span></span>
<span><span style="color: #D6DEEB">    mode </span><span style="color: #C792EA">=</span><span style="color: #D6DEEB"> </span><span style="color: #F78C6C">0</span><span style="color: #D6DEEB">;</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C5E478">input_password</span><span style="color: #D6DEEB">(</span><span style="color: #F78C6C">16'h1234</span><span style="color: #D6DEEB">);  </span><span style="color: #637777">// set password</span></span>
<span></span>
<span><span style="color: #D6DEEB">    mode </span><span style="color: #C792EA">=</span><span style="color: #D6DEEB"> </span><span style="color: #F78C6C">1</span><span style="color: #D6DEEB">;</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C5E478">input_password</span><span style="color: #D6DEEB">(</span><span style="color: #F78C6C">16'h4321</span><span style="color: #D6DEEB">);  </span><span style="color: #637777">// incorrect</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C5E478">input_password</span><span style="color: #D6DEEB">(</span><span style="color: #F78C6C">16'h1234</span><span style="color: #D6DEEB">);  </span><span style="color: #637777">// correct</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C5E478">input_password</span><span style="color: #D6DEEB">(</span><span style="color: #F78C6C">16'ha73f</span><span style="color: #D6DEEB">);  </span><span style="color: #637777">// admin password</span></span>
<span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #637777">// incorrect three times</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C5E478">input_password</span><span style="color: #D6DEEB">(</span><span style="color: #F78C6C">16'h4321</span><span style="color: #D6DEEB">);</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C5E478">input_password</span><span style="color: #D6DEEB">(</span><span style="color: #F78C6C">16'h4321</span><span style="color: #D6DEEB">);</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C5E478">input_password</span><span style="color: #D6DEEB">(</span><span style="color: #F78C6C">16'h4321</span><span style="color: #D6DEEB">);</span></span>
<span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C5E478">input_password</span><span style="color: #D6DEEB">(</span><span style="color: #F78C6C">16'h1234</span><span style="color: #D6DEEB">);  </span><span style="color: #637777">// locked</span></span>
<span></span>
<span><span style="color: #D6DEEB">    mode </span><span style="color: #C792EA">=</span><span style="color: #D6DEEB"> </span><span style="color: #F78C6C">0</span><span style="color: #D6DEEB">;</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C5E478">input_password</span><span style="color: #D6DEEB">(</span><span style="color: #F78C6C">16'h4321</span><span style="color: #D6DEEB">);  </span><span style="color: #637777">// cannot set password</span></span>
<span></span>
<span><span style="color: #D6DEEB">    mode </span><span style="color: #C792EA">=</span><span style="color: #D6DEEB"> </span><span style="color: #F78C6C">1</span><span style="color: #D6DEEB">;</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C5E478">input_password</span><span style="color: #D6DEEB">(</span><span style="color: #F78C6C">16'h1234</span><span style="color: #D6DEEB">);  </span><span style="color: #637777">// locked</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C5E478">input_password</span><span style="color: #D6DEEB">(</span><span style="color: #F78C6C">16'h4321</span><span style="color: #D6DEEB">);  </span><span style="color: #637777">// incorrect</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C5E478">input_password</span><span style="color: #D6DEEB">(</span><span style="color: #F78C6C">16'ha73f</span><span style="color: #D6DEEB">);  </span><span style="color: #637777">// admin password</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C5E478">input_password</span><span style="color: #D6DEEB">(</span><span style="color: #F78C6C">16'h1234</span><span style="color: #D6DEEB">);  </span><span style="color: #637777">// correct</span></span>
<span><span style="color: #D6DEEB">    </span><span style="color: #C5E478">input_password</span><span style="color: #D6DEEB">(</span><span style="color: #F78C6C">16'h4321</span><span style="color: #D6DEEB">);  </span><span style="color: #637777">// incorrect</span></span>
<span><span style="color: #D6DEEB">  </span><span style="color: #C792EA">end</span></span>
<span><span style="color: #C792EA">endmodule</span></span></code></pre></div></section>
<p>通过使用 <code>$display</code><span class="mojikumi-line-end">，</span>可以更直观地输出结果<span class="mojikumi-line-end">，</span>从而不需要对着波形图看<span class="mojikumi-line-end">；</span>或者自动检查结果是否正确<span class="mojikumi-line-end">，</span>在出错时输出<span class="mojikumi-line-end">。</span></p>
<p>有时可以通过文件读写来更方便地编写测试数据<span class="mojikumi-line-end">、</span>检查输出结果<span class="mojikumi-line-end">。</span></p>
<h2 id="有关-synthesize-的一些注意事项" class="heading"><a href="#有关-synthesize-的一些注意事项" class="heading-anchor" aria-label="章节： 有关 synthesize 的一些注意事项" tabindex="-1"></a><span>有关 synthesize 的一些注意事项</span></h2>
<ul>
<li>长串的 <code>if</code><span class="mojikumi-line-end">、</span><code>else if</code><span class="mojikumi-line-end">、</span><code>else if</code>……可能导致电路也有一长串<span class="mojikumi-line-end">，</span>使用 <code>case</code> 可能会更优<span class="mojikumi-line-end">。</span></li>
<li>组合逻辑中的循环可能会创建同一套电路的多个副本<span class="mojikumi-line-end">，</span>如果要用同一个电路<span class="mojikumi-line-end">，</span>可能需要改写成时序逻辑<span class="mojikumi-line-end">。</span></li>
<li>根据具体使用的 tool<span class="mojikumi-line-end">，</span>有些 language feature 是不能被 synthesize 的<span class="mojikumi-line-end">。</span></li>
<li>为了更好的 synthesize 结果而需要把代码写成什么样<span class="mojikumi-line-end">，</span>需要依具体使用的 tool 而定<span class="mojikumi-line-end">。</span></li>
</ul></section><div class="article-style my-9"><hr></div><footer><div class="my-6 b-l-6 b-gray-4 bg-area p-6 shadow dark:b-gray-11" itemprop="copyrightNotice"><ul class="flex flex-col gap-1"><li class="flex gap-1"><span class="shrink-0">文章作者:</span><a href="https://github.com/ouuan" rel="author">ouuan</a></li><li class="flex gap-1"><span class="shrink-0">原文链接:</span><a href="https://ouuan.moe/post/2023/04/ddpp-5" rel="canonical" class="break-all">https://ouuan.moe/post/2023/04/ddpp-5</a></li><li class="flex gap-1"><span class="shrink-0">许可协议:</span><span> 本文采用 <span class="article-style"><a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/deed.zh" class="font-sans" itemprop="license">CC BY-SA 4.0</a></span> 许可协议进行授权，未满足 <span class="underline decoration-dotted" title="简而言之，转载时必须标明出处（本文的链接），标明是转载而非原创，标明作了哪些修改，并使用相同的许可协议，但无需私信征求许可">许可协议要求</span> 不得转载。 </span></li></ul></div></footer></article><div class="my-6 print:hidden" itemprop="comment" itemscope="" itemtype="https://schema.org/Comment"><ile-root id="ile-17"></ile-root><script></script><script type="module" async="">import{h as r,c as m}from"/assets/iles.e30597ee.js";import{_ as o}from"/assets/GiscusCommentsInner.cc959b9e.js";import"/assets/vendor-vue.f543892e.js";import"/assets/vite.5ce4fca4.js";import"/assets/useTheme.84274661.js";import"/assets/site.0440d0dc.js";r(m,o,"ile-17",{term:"DDPP 第五章学习笔记",lang:void 0},{});
</script></div><nav class="my-6 flex justify-between gap-6 print:hidden lg:text-justify"><div class="flex flex-1"><a class="flex items-center gap-1 hover:text-hover" href="/post/2023/03/thuse"><span class="i-mdi-chevron-left"></span><span class="sr-only">上一篇</span><span class="break-anywhere">当你的技术栈与软工交集为空（x</span></a></div><div class="flex flex-1 justify-end"><a class="flex flex-row-reverse items-center gap-1 hover:text-hover" href="/post/2023/06/cnatda-2"><span class="i-mdi-chevron-right"></span><span class="sr-only">下一篇</span><span class="break-anywhere">CNATDA 第二章学习笔记</span></a></div></nav></div><ile-root id="ile-18"><div class="flex print:hidden"><aside style="max-height:calc(100vh - 10rem);" id="__toc" class="sticky top-16 m-4 hidden w-72 rd-2 bg-card py-6 shadow xl:block 2xl:w-84 3xl:w-96" aria-label="文章目录" itemprop="hasPart" itemscope="" itemtype="https://schema.org/WPSideBar"><div class="mb-3 flex flex-wrap items-center justify-between gap-2 pl-8 pr-4"><div class="flex items-center"><h2 class="text-xl font-bold"> 文章目录 </h2><button id="__toc-close" class="flex items-center px-1 text-xl" title="关闭目录" aria-controls="__toc" aria-expanded="true"><span class="i-mdi-close"></span></button></div><div><label class="ml-auto flex items-center gap-1"><span>展开全部</span><input type="checkbox"></label></div></div><div style="max-height:calc(100% - 2rem);" class="overflow-auto overscroll-contain pl-8 pr-4"><ol data-v-c5806953=""><li id="__toc-item-neovim-配置" class="relative my-1" data-v-c5806953=""><span class="absolute top-1.2 left--4
                   motion-safe:transition-transform ease-out i-mdi-circle-medium" data-v-c5806953=""></span><a class="transition-color ease-out" href="#neovim-配置" data-v-c5806953=""><span data-v-c5806953="">neovim 配置</span></a></li><li id="__toc-item-基础语法" class="relative my-1" data-v-c5806953=""><span class="absolute top-1.2 left--4
                   motion-safe:transition-transform ease-out i-mdi-chevron-right" data-v-c5806953=""></span><span class="sr-only" data-v-c5806953="">已折叠</span><a class="transition-color ease-out" href="#基础语法" data-v-c5806953=""><span data-v-c5806953="">基础语法</span></a></li><li id="__toc-item-model" class="relative my-1" data-v-c5806953=""><span class="absolute top-1.2 left--4
                   motion-safe:transition-transform ease-out i-mdi-chevron-right" data-v-c5806953=""></span><span class="sr-only" data-v-c5806953="">已折叠</span><a class="transition-color ease-out" href="#model" data-v-c5806953=""><span data-v-c5806953="">model</span></a></li><li id="__toc-item-timescale-指定延迟" class="relative my-1" data-v-c5806953=""><span class="absolute top-1.2 left--4
                   motion-safe:transition-transform ease-out i-mdi-circle-medium" data-v-c5806953=""></span><a class="transition-color ease-out" href="#timescale-指定延迟" data-v-c5806953=""><span data-v-c5806953="">timescale &amp; 指定延迟</span></a></li><li id="__toc-item-simulation-test-bench" class="relative my-1" data-v-c5806953=""><span class="absolute top-1.2 left--4
                   motion-safe:transition-transform ease-out i-mdi-circle-medium" data-v-c5806953=""></span><a class="transition-color ease-out" href="#simulation-test-bench" data-v-c5806953=""><span data-v-c5806953="">simulation (test bench)</span></a></li><li id="__toc-item-有关-synthesize-的一些注意事项" class="relative my-1" data-v-c5806953=""><span class="absolute top-1.2 left--4
                   motion-safe:transition-transform ease-out i-mdi-circle-medium" data-v-c5806953=""></span><a class="transition-color ease-out" href="#有关-synthesize-的一些注意事项" data-v-c5806953=""><span data-v-c5806953="">有关 synthesize 的一些注意事项</span></a></li></ol></div></aside><button style="display:none;" id="__toc-open" title="显示文章目录" class="bottom-24 text-lg floating-button" aria-haspopup="dialog" aria-controls="__toc" aria-expanded="true"><span class="i-mdi-menu"></span></button></div></ile-root><script></script><script type="module" async="">import{h as g,c as n}from"/assets/iles.e30597ee.js";import{_ as m}from"/assets/TableOfContents.a1f1ec5b.js";import"/assets/vendor-vue.f543892e.js";import"/assets/vite.5ce4fca4.js";g(n,m,"ile-18",function(e,l,t,i,s,u,a,o,v,r){return{headings:[{level:l,title:"neovim 配置",slug:"neovim-配置"},{level:l,title:i,slug:i},{level:e,title:s,slug:s},{level:e,title:"signal (net & variable)",slug:"signal-net-variable"},{level:e,title:"数字字面量 & parameter",slug:"数字字面量-parameter"},{level:e,title:"vector & 算术运算",slug:"vector-算术运算"},{level:e,title:u,slug:u},{level:e,title:a,slug:a},{level:e,title:"compiler directives",slug:"compiler-directives"},{level:l,title:o,slug:o},{level:e,title:"structural model",slug:"structural-model"},{level:e,title:"dataflow model",slug:"dataflow-model"},{level:e,title:"behavioral model",slug:"behavioral-model"},{level:t,title:"always & begin-end block",slug:"always-begin-end-block"},{level:t,title:v,slug:v},{level:t,title:"if-else 语句",slug:"if-else-语句"},{level:t,title:"case 语句",slug:"case-语句"},{level:t,title:r,slug:r},{level:t,title:"function 和 task",slug:"function-和-task"},{level:l,title:"timescale & 指定延迟",slug:"timescale-指定延迟"},{level:l,title:"simulation (test bench)",slug:"simulation-test-bench"},{level:l,title:"有关 synthesize 的一些注意事项",slug:"有关-synthesize-的一些注意事项"}]}}(3,2,4,"基础语法","module","array","逻辑运算","model","赋值","循环语句"),{});
</script></div></main><footer class="flex flex-col gap-1 bg-card p-6 text-footer" itemprop="hasPart" itemscope="" itemtype="https://schema.org/WPFooter"><div class="flex flex-wrap items-center justify-center gap-x-1" itemprop="copyrightNotice"><span>Copyright ©</span><span>2022 - 2024</span><a class="flex items-center" href="/sponsor" title="赞赏支持"><span class="i-mdi-heart text-red dark:text-red-7"></span></a><span>ouuan</span></div><div class="flex flex-wrap items-center justify-center gap-x-1 print:hidden"><span> 当前有 <ile-root id="ile-19"><span><span class="i-mdi-loading motion-safe:animate-spin"></span><span class="sr-only">加载中</span></span></ile-root><script></script><script type="module" async="">var p=(o,a)=>()=>(a||o((a={exports:{}}).exports,a),a.exports);var r=(o,a,_)=>new Promise((c,n)=>{var f=t=>{try{e(_.next(t))}catch(i){n(i)}},l=t=>{try{e(_.throw(t))}catch(i){n(i)}},e=t=>t.done?c(t.value):Promise.resolve(t.value).then(f,l);e((_=_.apply(o,a)).next())});import{_ as d}from"/assets/vite.5ce4fca4.js";import{a as s}from"/assets/iles.e30597ee.js";import"/assets/vendor-vue.f543892e.js";var E=p(m=>{const u=()=>r(m,null,function*(){return(yield d(()=>import("/assets/iles.e30597ee.js").then(o=>o.v),["assets/iles.e30597ee.js","assets/vendor-vue.f543892e.js","assets/vite.5ce4fca4.js"])).default}),v=()=>r(m,null,function*(){return(yield d(()=>import("/assets/VisitorCountRealtime.44b7ccfd.js"),["assets/VisitorCountRealtime.44b7ccfd.js","assets/vendor-vue.f543892e.js","assets/vite.5ce4fca4.js"])).default});s(u,v,"ile-19",{},{})});export default E();
</script> 人在线 </span><span class="i-mdi-circle-small"></span><span title="实际上，为了保护用户隐私，同一用户的多次访问只有在同一天内使用同一浏览器在同一ip下才会被算作同一人"> 共有 <ile-root id="ile-20"><span><span class="i-mdi-loading motion-safe:animate-spin"></span><span class="sr-only">加载中</span></span></ile-root><script></script><script type="module" async="">var p=(o,a)=>()=>(a||o((a={exports:{}}).exports,a),a.exports);var r=(o,a,_)=>new Promise((c,n)=>{var f=t=>{try{e(_.next(t))}catch(i){n(i)}},l=t=>{try{e(_.throw(t))}catch(i){n(i)}},e=t=>t.done?c(t.value):Promise.resolve(t.value).then(f,l);e((_=_.apply(o,a)).next())});import{_ as d}from"/assets/vite.5ce4fca4.js";import{a as s}from"/assets/iles.e30597ee.js";import"/assets/vendor-vue.f543892e.js";var E=p(m=>{const u=()=>r(m,null,function*(){return(yield d(()=>import("/assets/iles.e30597ee.js").then(o=>o.v),["assets/iles.e30597ee.js","assets/vendor-vue.f543892e.js","assets/vite.5ce4fca4.js"])).default}),v=()=>r(m,null,function*(){return(yield d(()=>import("/assets/VisitorCount.7062fe22.js"),["assets/VisitorCount.7062fe22.js","assets/VisitorCount.b65d15cd.js","assets/vendor-vue.f543892e.js","assets/vite.5ce4fca4.js"])).default});s(u,v,"ile-20",{},{})});export default E();
</script> 人到访过这里 </span></div><div class="flex flex-wrap items-center justify-center gap-x-1 print:hidden"> 基于 <a class="underline" href="https://github.com/ElMassimo/iles">îles</a><a class="underline" href="https://github.com/ouuan/iles-blog/blob/master/package.json">等项目</a><span class="i-mdi-circle-small"></span><span>由 ouuan 设计/制作</span><span class="i-mdi-circle-small"></span><a class="underline" href="https://github.com/ouuan/iles-blog">源代码</a></div></footer><meta itemprop="copyrightYear" content="2022"><meta itemprop="copyrightYear" content="2023"><meta itemprop="copyrightYear" content="2024"><div class="hidden" itemscope="" itemtype="https://schema.org/Person" itemprop="copyrightHolder"><meta itemprop="name" content="ouuan"><meta itemprop="givenName" content="Yufan"><meta itemprop="familyName" content="You"><meta itemprop="url" content="https://github.com/ouuan"><link itemprop="gender" href="https://schema.org/Male"><meta itemprop="image" content="/android-chrome-512x512.png"></div><ile-root id="ile-21"><button class="group bottom-10 flex-col floating-button" title="前往底部"><div aria-hidden="true" class="flex justify-center"><span class="i-mdi-chevron-double-up motion-safe:transition-font-size text-0"></span></div><div aria-hidden="true" class="text-0 group-hover:text-3.5 motion-safe:transition-font-size"></div><div aria-hidden="false" class="flex justify-center"><span class="i-mdi-chevron-double-down motion-safe:transition-font-size text-5 group-hover:text-3"></span></div></button></ile-root><script></script><script type="module" async="">var p=(o,a)=>()=>(a||o((a={exports:{}}).exports,a),a.exports);var r=(o,a,_)=>new Promise((c,n)=>{var f=t=>{try{e(_.next(t))}catch(i){n(i)}},l=t=>{try{e(_.throw(t))}catch(i){n(i)}},e=t=>t.done?c(t.value):Promise.resolve(t.value).then(f,l);e((_=_.apply(o,a)).next())});import{_ as d}from"/assets/vite.5ce4fca4.js";import{a as s}from"/assets/iles.e30597ee.js";import"/assets/vendor-vue.f543892e.js";var E=p(m=>{const u=()=>r(m,null,function*(){return(yield d(()=>import("/assets/iles.e30597ee.js").then(o=>o.v),["assets/iles.e30597ee.js","assets/vendor-vue.f543892e.js","assets/vite.5ce4fca4.js"])).default}),v=()=>r(m,null,function*(){return(yield d(()=>import("/assets/BackToTop.173a6e5e.js"),["assets/BackToTop.173a6e5e.js","assets/vendor-vue.f543892e.js","assets/vite.5ce4fca4.js"])).default});s(u,v,"ile-21",{},{})});export default E();
</script><div class="hidden"></div><ile-root id="ile-22"></ile-root><script></script><script type="module" async="">var p=(t,a)=>()=>(a||t((a={exports:{}}).exports,a),a.exports);var e=(t,a,_)=>new Promise((c,n)=>{var f=o=>{try{i(_.next(o))}catch(r){n(r)}},l=o=>{try{i(_.throw(o))}catch(r){n(r)}},i=o=>o.done?c(o.value):Promise.resolve(o.value).then(f,l);i((_=_.apply(t,a)).next())});import{_ as d}from"/assets/vite.5ce4fca4.js";import{a as s}from"/assets/iles.e30597ee.js";import"/assets/vendor-vue.f543892e.js";var u=p(m=>{const E=()=>e(m,null,function*(){return(yield d(()=>import("/assets/iles.e30597ee.js").then(t=>t.d),["assets/iles.e30597ee.js","assets/vendor-vue.f543892e.js","assets/vite.5ce4fca4.js"])).default}),h=()=>e(m,null,function*(){return(yield d(()=>import("/assets/PlausibleTrigger.eac998da.js"),["assets/PlausibleTrigger.eac998da.js","assets/plausible.3552d806.js","assets/vendor-vue.f543892e.js","assets/vite.5ce4fca4.js"])).onLoad});s(E,h,"ile-22",{},{})});export default u();
</script><div></div><ile-root id="ile-23"></ile-root><script></script><script type="module" async="">var p=(t,a)=>()=>(a||t((a={exports:{}}).exports,a),a.exports);var e=(t,a,_)=>new Promise((c,n)=>{var f=o=>{try{i(_.next(o))}catch(r){n(r)}},l=o=>{try{i(_.throw(o))}catch(r){n(r)}},i=o=>o.done?c(o.value):Promise.resolve(o.value).then(f,l);i((_=_.apply(t,a)).next())});import{_ as d}from"/assets/vite.5ce4fca4.js";import{a as s}from"/assets/iles.e30597ee.js";import"/assets/vendor-vue.f543892e.js";var u=p(m=>{const E=()=>e(m,null,function*(){return(yield d(()=>import("/assets/iles.e30597ee.js").then(t=>t.d),["assets/iles.e30597ee.js","assets/vendor-vue.f543892e.js","assets/vite.5ce4fca4.js"])).default}),h=()=>e(m,null,function*(){return(yield d(()=>import("/assets/TextJustifyFix.4fa5e997.js"),[])).onLoad});s(E,h,"ile-23",{},{})});export default u();
</script></div>
  
</body></html>