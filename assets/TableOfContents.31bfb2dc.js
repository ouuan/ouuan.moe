import{d as x,M as L,q as T,N as I,j as $,o as i,e as d,O as D,f as l,Q as U,F as k,x as W,n as M,y as b,g as z,u as j,b as q,r as v,w as F,m as Q,s as J,l as K,R as Y,J as G,S as X,A}from"./vendor-vue.cceed686.js";import{a as V}from"./vite.5ce4fca4.js";const Z=["aria-expanded"],ee=l("span",{class:"i-mdi-menu"},null,-1),te=[ee],P=x({__name:"TableOfContentsButton",props:{showToc:{type:Boolean}},emits:["update:showToc"],setup(a,{emit:e}){const n=L(a,"showToc",e);function o(){n.value=!0,D(()=>{var s;(s=document.getElementById("__toc-close"))==null||s.focus()})}return(s,t)=>T((i(),d("button",{id:"__toc-open",title:"显示文章目录",class:"floating-button text-lg bottom-24","aria-haspopup":"dialog","aria-controls":"__toc","aria-expanded":$(n),onClick:o},te,8,Z)),[[I,!$(n)]])}}),ne=["id"],oe=["href"],se=["innerHTML"],le={key:0,class:"animate-appear pl-4 b-l-2 b-area"},ae=x({__name:"TableOfContentsNode",props:{nodes:null,showAll:{type:Boolean}},setup(a){const e=a;function u(n){return n.children.length===0?n.level===6?"i-mdi-square-medium":"i-mdi-circle-medium":n.open||e.showAll?"i-mdi-chevron-right rotate-90":"i-mdi-chevron-right"}return(n,o)=>{const s=U("table-of-contents-node",!0);return i(),d("ol",null,[(i(!0),d(k,null,W(a.nodes,t=>(i(),d("li",{id:`__toc-item-${t.slug}`,key:t.slug,class:"my-1 relative"},[l("a",{class:M(["transition-color ease-out",t.current&&"text-link"]),href:`#${t.slug}`},[l("span",{class:M(`absolute top-1.2 left--4
                   motion-safe:transition-transform ease-out ${u(t)}`)},null,2),l("span",{innerHTML:t.title},null,8,se)],10,oe),(t.open||a.showAll)&&t.children.length>0?(i(),d("div",le,[b(s,{nodes:t.children,"show-all":a.showAll},null,8,["nodes","show-all"])])):z("v-if",!0)],8,ne))),128))])}}});const ce=V(ae,[["__scopeId","data-v-84d105d6"]]),ie={class:"flex flex-wrap gap-2 justify-between items-center pr-4 pl-8 mb-3"},re=l("h2",{class:"text-xl font-bold"}," 文章目录 ",-1),de=l("span",{class:"i-mdi-close"},null,-1),ue=[de],_e={key:0},pe={class:"ml-auto flex gap-1 items-center"},he=l("span",null,"展开全部",-1),H=x({__name:"TableOfContentsCommon",props:{headings:null},emits:["close"],setup(a,{emit:e}){const u=a;function n(){e("close"),D(()=>{var _;(_=document.getElementById("__toc-open"))==null||_.focus()})}const{y:o}=j(),{height:s}=q(),t=v(!1),h=v(),S=v(!0),B=v("");function E(){let _=1/0,r="";u.headings.forEach(({slug:y})=>{var g,w;const C=(w=(g=document.getElementById(y))==null?void 0:g.getBoundingClientRect().top)!=null?w:-1/0,f=C<s.value/3?Math.abs(C):C+1e8;f<_&&(_=f,r=y)}),B.value=r;const p={level:0,title:"",slug:"",open:!0,current:!1,children:[],parent:null};let c=p,R=!0;return u.headings.forEach(({level:y,title:C,slug:f})=>{var N;for(;y<=c.level&&c.parent;)c=c.parent;let g=f===r;if(!g){const m=(N=document.getElementById(f))==null?void 0:N.getBoundingClientRect().top;m&&m>0&&m<s.value&&(g=!0)}const w={level:y,title:C,slug:f,open:g,current:f===r,children:[],parent:c};if(g)for(let m=w;m.parent;m=m.parent)m.parent.open=!0;c.children.push(w),c.parent&&(R=!1),c=w}),S.value=R,p.children}const O=v(E());return F([o,t,s],()=>{O.value=E()},{throttle:100}),Q([o,t,s,B],()=>{const _=document.getElementById(`__toc-item-${B.value}`);if(_&&h.value){const r=_.getBoundingClientRect().top,p=h.value.getBoundingClientRect(),c=(r-p.top)/p.height;(c<.2||c>.8)&&(h.value.scrollTop+=r-p.top-p.height/2)}},{debounce:50}),(_,r)=>{const p=ce;return i(),d(k,null,[l("div",ie,[l("div",{class:"flex items-center"},[re,l("button",{id:"__toc-close",class:"px-1 text-xl flex items-center",title:"关闭目录","aria-controls":"__toc","aria-expanded":"true",onClick:n},ue)]),S.value?z("v-if",!0):(i(),d("div",_e,[l("label",pe,[he,T(l("input",{"onUpdate:modelValue":r[0]||(r[0]=c=>t.value=c),type:"checkbox"},null,512),[[J,t.value]])])]))]),l("div",{ref_key:"tocRoot",ref:h,style:{"max-height":"calc(100% - 2rem)"},class:"overflow-auto overscroll-contain pr-4 pl-8"},[b(p,{nodes:O.value,"show-all":t.value},null,8,["nodes","show-all"])],512)],64)}}}),me={id:"__toc",class:"sticky top-16 bg-card py-6 m-4 rd-2 w-72 2xl:w-84 3xl:w-96 shadow hidden xl:block","aria-label":"文章目录",style:{"max-height":"calc(100vh - 10rem)"},itemprop:"hasPart",itemscope:"",itemtype:"https://schema.org/WPSideBar"},fe=x({__name:"TableOfContentsSidebar",props:{headings:null},setup(a){const e=v(!0);return(u,n)=>{const o=H,s=P;return i(),d(k,null,[T(l("aside",me,[b(o,{headings:a.headings,onClose:n[0]||(n[0]=t=>e.value=!1)},null,8,["headings"])],512),[[I,e.value]]),b(s,{"show-toc":e.value,"onUpdate:showToc":n[1]||(n[1]=t=>e.value=t)},null,8,["show-toc"])],64)}}}),ge=["aria-hidden"],ve=x({__name:"TableOfContentsDrawer",props:{headings:null},setup(a){const e=v(!1),u=K(()=>e.value?"0":"calc(-5px - var(--toc-width))");return Y("Escape",()=>{e.value=!1}),(n,o)=>{const s=H,t=P;return i(),d(k,null,[l("div",{id:"__toc",class:"toc-drawer bg-card py-6 shadow-lg fixed inset-y-0 z-15","aria-label":"文章目录",role:"dialog",style:G({right:$(u)}),"aria-hidden":!e.value},[b(s,{headings:a.headings,onClose:o[0]||(o[0]=h=>e.value=!1)},null,8,["headings"])],12,ge),b(t,{"show-toc":e.value,"onUpdate:showToc":o[1]||(o[1]=h=>e.value=h),"aria-haspopup":"dialog"},null,8,["show-toc"]),T(l("div",{"aria-hidden":"true",class:"fixed top-0 bottom-0 left-0 right-0 bg-gray-8 opacity-50 z-10",onClick:o[2]||(o[2]=h=>e.value=!1)},null,512),[[I,e.value]])],64)}}});const we=V(ve,[["__scopeId","data-v-a66e88d8"]]),be={class:"flex print:hidden"},Ce=x({__name:"TableOfContents",props:{headings:null},setup(a){const e=X("(max-width: 79.9em)");return(u,n)=>{const o=we,s=fe;return i(),d("div",be,[$(e)?(i(),A(o,{key:0,headings:a.headings},null,8,["headings"])):(i(),A(s,{key:1,headings:a.headings},null,8,["headings"]))])}}});export{Ce as _};
