import{d as x,M as L,l as T,N as E,g as k,o as i,e as u,O as A,f as o,Q as U,F as B,p as W,n as M,t as j,x as I,q as y,u as q,b as F,r as w,w as Q,k as J,m as K,j as Y,R as G,J as X,S as Z,y as z}from"./vendor-vue.6a98ea6c.js";import{a as V}from"./vite.5ce4fca4.js";const ee=["aria-expanded"],te=o("span",{class:"i-mdi-menu"},null,-1),ne=[te],P=x({__name:"TableOfContentsButton",props:{showToc:{type:Boolean}},emits:["update:showToc"],setup(s,{emit:e}){const l=L(s,"showToc",e);function n(){l.value=!0,A(()=>{var t;(t=document.getElementById("__toc-close"))==null||t.focus()})}return(t,r)=>T((i(),u("button",{id:"__toc-open",title:"显示文章目录",class:"bottom-24 text-lg floating-button","aria-haspopup":"dialog","aria-controls":"__toc","aria-expanded":k(l),onClick:n},ne,8,ee)),[[E,!k(l)]])}}),oe=["id"],se={key:0,class:"sr-only"},le=["href"],ae=["innerHTML"],ce={key:1,class:"animate-appear b-l-2 b-area pl-4"},ie=x({__name:"TableOfContentsNode",props:{nodes:null,showAll:{type:Boolean}},setup(s){const e=s;function d(t){return t.children.length===0?t.level===6?"card":"leaf":t.open||e.showAll?"open":"closed"}const l={card:"i-mdi-square-medium",leaf:"i-mdi-circle-medium",open:"i-mdi-chevron-right rotate-90",closed:"i-mdi-chevron-right"},n={card:"卡片",leaf:null,open:"已展开",closed:"已折叠"};return(t,r)=>{const _=U("table-of-contents-node",!0);return i(),u("ol",null,[(i(!0),u(B,null,W(s.nodes,a=>(i(),u("li",{id:`__toc-item-${a.slug}`,key:a.slug,class:"relative my-1"},[o("span",{class:M(`absolute top-1.2 left--4
                   motion-safe:transition-transform ease-out ${l[d(a)]}`)},null,2),n[d(a)]?(i(),u("span",se,j(n[d(a)]),1)):I("v-if",!0),o("a",{class:M(["transition-color ease-out",a.current&&"text-link"]),href:`#${a.slug}`},[o("span",{innerHTML:a.title},null,8,ae)],10,le),(a.open||s.showAll)&&a.children.length>0?(i(),u("div",ce,[y(_,{nodes:a.children,"show-all":s.showAll},null,8,["nodes","show-all"])])):I("v-if",!0)],8,oe))),128))])}}});const re=V(ie,[["__scopeId","data-v-c5806953"]]),de={class:"mb-3 flex flex-wrap items-center justify-between gap-2 pl-8 pr-4"},ue=o("h2",{class:"text-xl font-bold"}," 文章目录 ",-1),_e=o("span",{class:"i-mdi-close"},null,-1),pe=[_e],he={key:0},me={class:"ml-auto flex items-center gap-1"},fe=o("span",null,"展开全部",-1),H=x({__name:"TableOfContentsCommon",props:{headings:null},emits:["close"],setup(s,{emit:e}){const d=s;function l(){e("close"),A(()=>{var h;(h=document.getElementById("__toc-open"))==null||h.focus()})}const{y:n}=q(),{height:t}=F(),r=w(!1),_=w(),a=w(!0),S=w("");function O(){let h=1/0,p="";d.headings.forEach(({slug:C})=>{var v,b;const $=(b=(v=document.getElementById(C))==null?void 0:v.getBoundingClientRect().top)!=null?b:-1/0,g=$<t.value/3?Math.abs($):$+1e8;g<h&&(h=g,p=C)}),S.value=p;const m={level:0,title:"",slug:"",open:!0,current:!1,children:[],parent:null};let c=m,N=!0;return d.headings.forEach(({level:C,title:$,slug:g})=>{var D;for(;C<=c.level&&c.parent;)c=c.parent;let v=g===p;if(!v){const f=(D=document.getElementById(g))==null?void 0:D.getBoundingClientRect().top;f&&f>0&&f<t.value&&(v=!0)}const b={level:C,title:$,slug:g,open:v,current:g===p,children:[],parent:c};if(v)for(let f=b;f.parent;f=f.parent)f.parent.open=!0;c.children.push(b),c.parent&&(N=!1),c=b}),a.value=N,m.children}const R=w(O());return Q([n,r,t],()=>{R.value=O()},{throttle:100}),J([n,r,t,S],()=>{const h=document.getElementById(`__toc-item-${S.value}`);if(h&&_.value){const p=h.getBoundingClientRect().top,m=_.value.getBoundingClientRect(),c=(p-m.top)/m.height;(c<.2||c>.8)&&(_.value.scrollTop+=p-m.top-m.height/2)}},{debounce:50}),(h,p)=>{const m=re;return i(),u(B,null,[o("div",de,[o("div",{class:"flex items-center"},[ue,o("button",{id:"__toc-close",class:"flex items-center px-1 text-xl",title:"关闭目录","aria-controls":"__toc","aria-expanded":"true",onClick:l},pe)]),a.value?I("v-if",!0):(i(),u("div",he,[o("label",me,[fe,T(o("input",{"onUpdate:modelValue":p[0]||(p[0]=c=>r.value=c),type:"checkbox"},null,512),[[K,r.value]])])]))]),o("div",{ref_key:"tocRoot",ref:_,style:{"max-height":"calc(100% - 2rem)"},class:"overflow-auto overscroll-contain pl-8 pr-4"},[y(m,{nodes:R.value,"show-all":r.value},null,8,["nodes","show-all"])],512)],64)}}}),ge={id:"__toc",class:"sticky top-16 m-4 hidden w-72 rd-2 bg-card py-6 shadow xl:block 2xl:w-84 3xl:w-96","aria-label":"文章目录",style:{"max-height":"calc(100vh - 10rem)"},itemprop:"hasPart",itemscope:"",itemtype:"https://schema.org/WPSideBar"},ve=x({__name:"TableOfContentsSidebar",props:{headings:null},setup(s){const e=w(!0);return(d,l)=>{const n=H,t=P;return i(),u(B,null,[T(o("aside",ge,[y(n,{headings:s.headings,onClose:l[0]||(l[0]=r=>e.value=!1)},null,8,["headings"])],512),[[E,e.value]]),y(t,{"show-toc":e.value,"onUpdate:showToc":l[1]||(l[1]=r=>e.value=r)},null,8,["show-toc"])],64)}}}),we=["aria-hidden"],be=x({__name:"TableOfContentsDrawer",props:{headings:null},setup(s){const e=w(!1),d=Y(()=>e.value?"0":"calc(-5px - var(--toc-width))");return G("Escape",()=>{e.value=!1}),(l,n)=>{const t=H,r=P;return i(),u(B,null,[o("div",{id:"__toc",class:"toc-drawer fixed inset-y-0 z-15 bg-card py-6 shadow-lg","aria-label":"文章目录",role:"dialog",style:X({right:k(d)}),"aria-hidden":!e.value},[y(t,{headings:s.headings,onClose:n[0]||(n[0]=_=>e.value=!1)},null,8,["headings"])],12,we),y(r,{"show-toc":e.value,"onUpdate:showToc":n[1]||(n[1]=_=>e.value=_),"aria-haspopup":"dialog"},null,8,["show-toc"]),T(o("div",{"aria-hidden":"true",class:"fixed bottom-0 left-0 right-0 top-0 z-10 bg-gray-8 opacity-50",onClick:n[2]||(n[2]=_=>e.value=!1)},null,512),[[E,e.value]])],64)}}});const ye=V(be,[["__scopeId","data-v-42f6c3e8"]]),xe={class:"flex print:hidden"},ke=x({__name:"TableOfContents",props:{headings:null},setup(s){const e=Z("(max-width: 79.9em)");return(d,l)=>{const n=ye,t=ve;return i(),u("div",xe,[k(e)?(i(),z(n,{key:0,headings:s.headings},null,8,["headings"])):(i(),z(t,{key:1,headings:s.headings},null,8,["headings"]))])}}});export{ke as _};
