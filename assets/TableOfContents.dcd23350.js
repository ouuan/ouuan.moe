import{d as x,N as L,g as k,k as E,i as S,o as i,e as d,O as M,f as n,Q as U,F as T,j as W,n as z,t as j,z as I,x as y,u as F,b as K,r as w,w as Q,p as q,s as Y,m as G,R as J,K as X,S as Z,A}from"./vendor-vue.d1fa473f.js";import{a as V}from"./vite.5ce4fca4.js";const ee=["aria-expanded"],te=n("span",{class:"i-mdi-menu"},null,-1),oe=[te],P=x({__name:"TableOfContentsButton",props:{showToc:{type:Boolean}},emits:["update:showToc"],setup(m,{emit:t}){const s=L(m,"showToc",t);function o(){s.value=!0,M(()=>{var e;(e=document.getElementById("__toc-close"))==null||e.focus()})}return(e,r)=>k((i(),d("button",{id:"__toc-open",title:"显示文章目录",class:"bottom-24 text-lg floating-button","aria-haspopup":"dialog","aria-controls":"__toc","aria-expanded":S(s),onClick:o},oe,8,ee)),[[E,!S(s)]])}}),ne=["id"],se={key:0,class:"sr-only"},ae=["href"],le=["innerHTML"],ce={key:1,class:"animate-appear b-l-2 b-area pl-4"},ie=x({__name:"TableOfContentsNode",props:{nodes:{},showAll:{type:Boolean}},setup(m){const t=m;function a(e){return e.children.length===0?e.level===6?"card":"leaf":e.open||t.showAll?"open":"closed"}const s={card:"i-mdi-square-medium",leaf:"i-mdi-circle-medium",open:"i-mdi-chevron-right rotate-90",closed:"i-mdi-chevron-right"},o={card:"卡片",leaf:null,open:"已展开",closed:"已折叠"};return(e,r)=>{const _=U("table-of-contents-node",!0);return i(),d("ol",null,[(i(!0),d(T,null,W(e.nodes,l=>(i(),d("li",{id:`__toc-item-${l.slug}`,key:l.slug,class:"relative my-1"},[n("span",{class:z(`absolute top-1.2 left--4
                   motion-safe:transition-transform ease-out ${s[a(l)]}`)},null,2),o[a(l)]?(i(),d("span",se,j(o[a(l)]),1)):I("v-if",!0),n("a",{class:z(["transition-color ease-out",l.current&&"text-link"]),href:`#${l.slug}`},[n("span",{innerHTML:l.title},null,8,le)],10,ae),(l.open||e.showAll)&&l.children.length>0?(i(),d("div",ce,[y(_,{nodes:l.children,"show-all":e.showAll},null,8,["nodes","show-all"])])):I("v-if",!0)],8,ne))),128))])}}});const re=V(ie,[["__scopeId","data-v-c5806953"]]),de={class:"mb-3 flex flex-wrap items-center justify-between gap-2 pl-8 pr-4"},_e=n("h2",{class:"text-xl font-bold"}," 文章目录 ",-1),ue=n("span",{class:"i-mdi-close"},null,-1),pe=[ue],he={key:0},me={class:"ml-auto flex items-center gap-1"},fe=n("span",null,"展开全部",-1),H=x({__name:"TableOfContentsCommon",props:{headings:{}},emits:["close"],setup(m,{emit:t}){const a=m;function s(){t("close"),M(()=>{var p;(p=document.getElementById("__toc-open"))==null||p.focus()})}const{y:o}=F(),{height:e}=K(),r=w(!1),_=w(),l=w(!0),B=w("");function O(){let p=1/0,u="";a.headings.forEach(({slug:C})=>{var v,b;const $=(b=(v=document.getElementById(C))==null?void 0:v.getBoundingClientRect().top)!=null?b:-1/0,g=$<e.value/3?Math.abs($):$+1e8;g<p&&(p=g,u=C)}),B.value=u;const h={level:0,title:"",slug:"",open:!0,current:!1,children:[],parent:null};let c=h,N=!0;return a.headings.forEach(({level:C,title:$,slug:g})=>{var D;for(;C<=c.level&&c.parent;)c=c.parent;let v=g===u;if(!v){const f=(D=document.getElementById(g))==null?void 0:D.getBoundingClientRect().top;f&&f>0&&f<e.value&&(v=!0)}const b={level:C,title:$,slug:g,open:v,current:g===u,children:[],parent:c};if(v)for(let f=b;f.parent;f=f.parent)f.parent.open=!0;c.children.push(b),c.parent&&(N=!1),c=b}),l.value=N,h.children}const R=w(O());return Q([o,r,e],()=>{R.value=O()},{throttle:100}),q([o,r,e,B],()=>{const p=document.getElementById(`__toc-item-${B.value}`);if(p&&_.value){const u=p.getBoundingClientRect().top,h=_.value.getBoundingClientRect(),c=(u-h.top)/h.height;(c<.2||c>.8)&&(_.value.scrollTop+=u-h.top-h.height/2)}},{debounce:50}),(p,u)=>{const h=re;return i(),d(T,null,[n("div",de,[n("div",{class:"flex items-center"},[_e,n("button",{id:"__toc-close",class:"flex items-center px-1 text-xl",title:"关闭目录","aria-controls":"__toc","aria-expanded":"true",onClick:s},pe)]),l.value?I("v-if",!0):(i(),d("div",he,[n("label",me,[fe,k(n("input",{"onUpdate:modelValue":u[0]||(u[0]=c=>r.value=c),type:"checkbox"},null,512),[[Y,r.value]])])]))]),n("div",{ref_key:"tocRoot",ref:_,style:{"max-height":"calc(100% - 2rem)"},class:"overflow-auto overscroll-contain pl-8 pr-4"},[y(h,{nodes:R.value,"show-all":r.value},null,8,["nodes","show-all"])],512)],64)}}}),ge={id:"__toc",class:"sticky top-16 m-4 hidden w-72 rd-2 bg-card py-6 shadow xl:block 2xl:w-84 3xl:w-96","aria-label":"文章目录",style:{"max-height":"calc(100vh - 10rem)"},itemprop:"hasPart",itemscope:"",itemtype:"https://schema.org/WPSideBar"},ve=x({__name:"TableOfContentsSidebar",props:{headings:{}},setup(m){const t=w(!0);return(a,s)=>{const o=H,e=P;return i(),d(T,null,[k(n("aside",ge,[y(o,{headings:a.headings,onClose:s[0]||(s[0]=r=>t.value=!1)},null,8,["headings"])],512),[[E,t.value]]),y(e,{"show-toc":t.value,"onUpdate:showToc":s[1]||(s[1]=r=>t.value=r)},null,8,["show-toc"])],64)}}}),we=["aria-hidden"],be=x({__name:"TableOfContentsDrawer",props:{headings:{}},setup(m){const t=w(!1),a=G(()=>t.value?"0":"calc(-5px - var(--toc-width))");return J("Escape",()=>{t.value=!1}),(s,o)=>{const e=H,r=P;return i(),d(T,null,[n("div",{id:"__toc",class:"toc-drawer fixed inset-y-0 z-15 bg-card py-6 shadow-lg","aria-label":"文章目录",role:"dialog",style:X({right:a.value}),"aria-hidden":!t.value},[y(e,{headings:s.headings,onClose:o[0]||(o[0]=_=>t.value=!1)},null,8,["headings"])],12,we),y(r,{"show-toc":t.value,"onUpdate:showToc":o[1]||(o[1]=_=>t.value=_),"aria-haspopup":"dialog"},null,8,["show-toc"]),k(n("div",{"aria-hidden":"true",class:"fixed bottom-0 left-0 right-0 top-0 z-10 bg-gray-8 opacity-50",onClick:o[2]||(o[2]=_=>t.value=!1)},null,512),[[E,t.value]])],64)}}});const ye=V(be,[["__scopeId","data-v-42f6c3e8"]]),xe={class:"flex print:hidden"},ke=x({__name:"TableOfContents",props:{headings:{}},setup(m){const t=Z("(max-width: 79.9em)");return(a,s)=>{const o=ye,e=ve;return i(),d("div",xe,[S(t)?(i(),A(o,{key:0,headings:a.headings},null,8,["headings"])):(i(),A(e,{key:1,headings:a.headings},null,8,["headings"]))])}}});export{ke as _};
