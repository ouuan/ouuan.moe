import{d as x,M as U,g as k,k as E,i as S,o as i,e as _,N as V,f as s,O as W,F as T,j,n as z,t as F,x as I,m as y,u as Q,b as q,r as w,w as G,G as K,Q as Y,D as J,R as X,z as Z,S as ee,s as A}from"./vendor-vue.231fc26c.js";import{a as P}from"./vite.5ce4fca4.js";const te=["aria-expanded"],oe=s("span",{class:"i-mdi-menu"},null,-1),ne=[oe],H=x({__name:"TableOfContentsButton",props:{showToc:{type:Boolean}},emits:["update:showToc"],setup(m,{emit:e}){const t=U(m,"showToc",e);function o(){t.value=!0,V(()=>{var l;(l=document.getElementById("__toc-close"))==null||l.focus()})}return(l,d)=>k((i(),_("button",{id:"__toc-open",title:"显示文章目录",class:"bottom-24 text-lg floating-button","aria-haspopup":"dialog","aria-controls":"__toc","aria-expanded":S(t),onClick:o},ne,8,te)),[[E,!S(t)]])}}),se=["id"],ae={key:0,class:"sr-only"},le=["href"],ce=["innerHTML"],ie={key:1,class:"animate-appear b-l-2 b-area pl-4"},re=x({__name:"TableOfContentsNode",props:{nodes:{},showAll:{type:Boolean}},setup(m){const e=m;function a(o){return o.children.length===0?o.level===6?"card":"leaf":o.open||e.showAll?"open":"closed"}const r={card:"i-mdi-square-medium",leaf:"i-mdi-circle-medium",open:"i-mdi-chevron-right rotate-90",closed:"i-mdi-chevron-right"},t={card:"卡片",leaf:null,open:"已展开",closed:"已折叠"};return(o,l)=>{const d=W("table-of-contents-node",!0);return i(),_("ol",null,[(i(!0),_(T,null,j(o.nodes,n=>(i(),_("li",{id:`__toc-item-${n.slug}`,key:n.slug,class:"relative my-1"},[s("span",{class:z(`absolute top-1.2 left--4
                   motion-safe:transition-transform ease-out ${r[a(n)]}`)},null,2),t[a(n)]?(i(),_("span",ae,F(t[a(n)]),1)):I("v-if",!0),s("a",{class:z(["transition-color ease-out",n.current&&"text-link"]),href:`#${n.slug}`},[s("span",{innerHTML:n.title},null,8,ce)],10,le),(n.open||o.showAll)&&n.children.length>0?(i(),_("div",ie,[y(d,{nodes:n.children,"show-all":o.showAll},null,8,["nodes","show-all"])])):I("v-if",!0)],8,se))),128))])}}});const de=P(re,[["__scopeId","data-v-c5806953"]]),_e={class:"mb-3 flex flex-wrap items-center justify-between gap-2 pl-8 pr-4"},ue=s("h2",{class:"text-xl font-bold"}," 文章目录 ",-1),pe=s("span",{class:"i-mdi-close"},null,-1),he=[pe],me={key:0},fe={class:"ml-auto flex items-center gap-1"},ge=s("span",null,"展开全部",-1),L=x({__name:"TableOfContentsCommon",props:{headings:{}},emits:["close"],setup(m,{emit:e}){const a=m,r=e;function t(){r("close"),V(()=>{var p;(p=document.getElementById("__toc-open"))==null||p.focus()})}const{y:o}=Q(),{height:l}=q(),d=w(!1),n=w(),O=w(!0),B=w("");function R(){let p=1/0,u="";a.headings.forEach(({slug:C})=>{var v,b;const $=(b=(v=document.getElementById(C))==null?void 0:v.getBoundingClientRect().top)!=null?b:-1/0,g=$<l.value/3?Math.abs($):$+1e8;g<p&&(p=g,u=C)}),B.value=u;const h={level:0,title:"",slug:"",open:!0,current:!1,children:[],parent:null};let c=h,N=!0;return a.headings.forEach(({level:C,title:$,slug:g})=>{var M;for(;C<=c.level&&c.parent;)c=c.parent;let v=g===u;if(!v){const f=(M=document.getElementById(g))==null?void 0:M.getBoundingClientRect().top;f&&f>0&&f<l.value&&(v=!0)}const b={level:C,title:$,slug:g,open:v,current:g===u,children:[],parent:c};if(v)for(let f=b;f.parent;f=f.parent)f.parent.open=!0;c.children.push(b),c.parent&&(N=!1),c=b}),O.value=N,h.children}const D=w(R());return G([o,d,l],()=>{D.value=R()},{throttle:100}),K([o,d,l,B],()=>{const p=document.getElementById(`__toc-item-${B.value}`);if(p&&n.value){const u=p.getBoundingClientRect().top,h=n.value.getBoundingClientRect(),c=(u-h.top)/h.height;(c<.2||c>.8)&&(n.value.scrollTop+=u-h.top-h.height/2)}},{debounce:50}),(p,u)=>{const h=de;return i(),_(T,null,[s("div",_e,[s("div",{class:"flex items-center"},[ue,s("button",{id:"__toc-close",class:"flex items-center px-1 text-xl",title:"关闭目录","aria-controls":"__toc","aria-expanded":"true",onClick:t},he)]),O.value?I("v-if",!0):(i(),_("div",me,[s("label",fe,[ge,k(s("input",{"onUpdate:modelValue":u[0]||(u[0]=c=>d.value=c),type:"checkbox"},null,512),[[Y,d.value]])])]))]),s("div",{ref_key:"tocRoot",ref:n,style:{"max-height":"calc(100% - 2rem)"},class:"overflow-auto overscroll-contain pl-8 pr-4"},[y(h,{nodes:D.value,"show-all":d.value},null,8,["nodes","show-all"])],512)],64)}}}),ve={id:"__toc",class:"sticky top-16 m-4 hidden w-72 rd-2 bg-card py-6 shadow xl:block 2xl:w-84 3xl:w-96","aria-label":"文章目录",style:{"max-height":"calc(100vh - 10rem)"},itemprop:"hasPart",itemscope:"",itemtype:"https://schema.org/WPSideBar"},we=x({__name:"TableOfContentsSidebar",props:{headings:{}},setup(m){const e=w(!0);return(a,r)=>{const t=L,o=H;return i(),_(T,null,[k(s("aside",ve,[y(t,{headings:a.headings,onClose:r[0]||(r[0]=l=>e.value=!1)},null,8,["headings"])],512),[[E,e.value]]),y(o,{"show-toc":e.value,"onUpdate:showToc":r[1]||(r[1]=l=>e.value=l)},null,8,["show-toc"])],64)}}}),be=["aria-hidden"],ye=x({__name:"TableOfContentsDrawer",props:{headings:{}},setup(m){const e=w(!1),a=J(()=>e.value?"0":"calc(-5px - var(--toc-width))");return X("Escape",()=>{e.value=!1}),(r,t)=>{const o=L,l=H;return i(),_(T,null,[s("div",{id:"__toc",class:"toc-drawer fixed inset-y-0 z-15 bg-card py-6 shadow-lg","aria-label":"文章目录",role:"dialog",style:Z({right:a.value}),"aria-hidden":!e.value},[y(o,{headings:r.headings,onClose:t[0]||(t[0]=d=>e.value=!1)},null,8,["headings"])],12,be),y(l,{"show-toc":e.value,"onUpdate:showToc":t[1]||(t[1]=d=>e.value=d),"aria-haspopup":"dialog"},null,8,["show-toc"]),k(s("div",{"aria-hidden":"true",class:"fixed bottom-0 left-0 right-0 top-0 z-10 bg-gray-8 opacity-50",onClick:t[2]||(t[2]=d=>e.value=!1)},null,512),[[E,e.value]])],64)}}});const xe=P(ye,[["__scopeId","data-v-42f6c3e8"]]),Ce={class:"flex print:hidden"},Te=x({__name:"TableOfContents",props:{headings:{}},setup(m){const e=ee("(max-width: 79.9em)");return(a,r)=>{const t=xe,o=we;return i(),_("div",Ce,[S(e)?(i(),A(t,{key:0,headings:a.headings},null,8,["headings"])):(i(),A(o,{key:1,headings:a.headings},null,8,["headings"]))])}}});export{Te as _};
