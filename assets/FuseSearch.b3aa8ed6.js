var O=Object.defineProperty,W=Object.defineProperties;var X=Object.getOwnPropertyDescriptors;var P=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable;var V=(c,t,a)=>t in c?O(c,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):c[t]=a,I=(c,t)=>{for(var a in t||(t={}))J.call(t,a)&&V(c,a,t[a]);if(P)for(var a of P(t))K.call(t,a)&&V(c,a,t[a]);return c},j=(c,t)=>W(c,X(t));import Q from"./PostHead.946a4209.js";import{d as R,l as Y,m as Z,r as A,p as ee,e as n,f as s,g as B,q as te,i as D,s as se,F as z,j as C,o,x as ae,y as ne,n as U,t as $,z as oe}from"./vendor-vue.33f0ffe8.js";import{F as G}from"./fuse-js.6ab03eb8.js";const ce={class:"m-4 flex flex-col gap-6"},re={class:"flex flex-wrap gap-x-5 gap-y-2"},ie={role:"search",class:"max-w-100 flex grow items-center gap-2"},le=s("label",{class:"flex items-center",for:"__search_keywords"},[s("span",{class:"i-mdi-magnify text-xl"}),s("span",{class:"sr-only"},"搜索关键词")],-1),de=s("a",{class:"flex items-center text-link",href:"https://fusejs.io/examples.html#extended-search"}," 高级搜索语法 ",-1),me={class:"flex items-center gap-1"},he=s("label",{for:"__search_showmore"},"显示匹配程度较低的结果",-1),ue={key:0,class:"standard-card"},fe=["title"],pe={class:"mb-3 mt-6 max-h-72 overflow-auto whitespace-pre-wrap"},_e=["title"],ye={key:1,class:"standard-card"},xe=s("p",{class:"my-3"}," （匹配程度低，结果已隐藏） ",-1),ve=[xe],ge={key:1,class:"standard-card"},ke=s("p",{class:"my-3"}," 没有检索到任何结果 😢 要不试试缩短或者更换关键词？ ",-1),we=[ke],ze={key:2,class:"standard-card"},Me=s("p",{class:"my-3"}," 请输入关键词进行搜索 ",-1),be=[Me],M=50,qe=R({__name:"FuseSearch",props:{data:{},meta:{}},setup(c){const t=c,a={includeScore:!0,ignoreLocation:!0,useExtendedSearch:!0,fieldNormWeight:.2},H=new G(t.data,j(I({},a),{threshold:.4,includeMatches:!0,keys:[{name:"title",weight:2},"content","tags"]})),v=Y("history"),p=Z(()=>{var m;return(m=Array.isArray(v.q)?v.q.join(" "):v.q)==null?void 0:m.trim()}),E={miss:"未匹配",fuzzy:"模糊匹配",exact:"精确匹配",ellipsis:"省略"},S={miss:"text-footer",ellipsis:"text-footer",fuzzy:"fuzzy-matched",exact:"exact-matched"};function T(m){var e;if(p.value===void 0)return"fuzzy";const _=(e=new G([m],a).search(p.value)[0])==null?void 0:e.score;return _!==void 0&&_<.002?"exact":"fuzzy"}function q(){return p.value?H.search(p.value,{limit:20}).map(m=>{var N;const{refIndex:h,score:_}=m,e=t.meta[h];if(!e)return{};let k=[{type:"miss",content:e.frontmatter.title}],i=[{type:"miss",content:""}],y=!1;return(N=m.matches)==null||N.forEach(u=>{if(u.key==="tags"){y=!0;return}const{value:f}=u;if(!f)return;let w=u.indices.filter(([r,x])=>T(f.slice(r,x+1))==="exact");w.length===0&&(w=u.indices.slice()),w.sort((r,x)=>r[0]-x[0]);let l=[];const F=w[0];if(!F)return;let d=u.key==="title"?0:Math.max(0,F[0]-M);w.forEach(([r,x])=>{r-d>M*3?(l.push({type:"miss",content:f.slice(d,d+M)}),l.push({type:"ellipsis",content:`

……

`}),l.push({type:"miss",content:f.slice(r-M,r)})):l.push({type:"miss",content:f.slice(d,r)});const L=f.slice(Math.max(d,r),x+1);l.push({type:T(L),content:L}),d=Math.max(d,x+1)}),l.push({type:"miss",content:f.slice(d,u.key==="title"?f.length:d+M)}),l=l.filter(({content:r})=>r),u.key==="title"?k=l:u.key==="content"&&(i=l)}),{meta:e,titleParts:k,contentParts:i,refIndex:h,tagMatched:y,score:_}}):null}const g=A(q());ee(p,()=>{g.value=q()},{debounce:300});const b=A(!1);return(m,h)=>{const _=Q;return o(),n("div",ce,[s("div",re,[s("form",ie,[le,B(s("input",{id:"__search_keywords","onUpdate:modelValue":h[0]||(h[0]=e=>D(v).q=e),class:"w-full rd-1 bg-card p-1",type:"search",placeholder:"关键词"},null,512),[[te,D(v).q]])]),de,s("div",me,[B(s("input",{id:"__search_showmore","onUpdate:modelValue":h[1]||(h[1]=e=>b.value=e),type:"checkbox"},null,512),[[se,b.value]]),he])]),g.value&&g.value.length?(o(!0),n(z,{key:0},C(g.value,e=>{var k;return o(),n(z,{key:`${p.value}-${e.refIndex}`},[e.meta?(o(),n(z,{key:0},[((k=e.score)!=null?k:1)<.1||b.value?(o(),n("div",ue,[ae(_,{"title-link":"",href:e.meta.href,filename:e.meta.filename,frontmatter:e.meta.frontmatter,"tag-matched":e.tagMatched},{title:ne(()=>[(o(!0),n(z,null,C(e.titleParts,(i,y)=>(o(),n("span",{key:y,class:U(S[i.type]),title:E[i.type]},$(i.content),11,fe))),128))]),_:2},1032,["href","filename","frontmatter","tag-matched"]),s("pre",pe,[(o(!0),n(z,null,C(e.contentParts,(i,y)=>(o(),n("span",{key:y,class:U(S[i.type]),title:E[i.type]},$(i.content),11,_e))),128))])])):(o(),n("div",ye,ve))],64)):oe("v-if",!0)],64)}),128)):g.value?(o(),n("div",ge,we)):(o(),n("div",ze,be))])}}});export{qe as _};
