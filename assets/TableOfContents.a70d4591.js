import{d as y,M as L,m as T,N as S,i as $,o as r,e as _,O as z,f as o,Q as U,F as k,s as W,n as D,t as q,x as b,z as A,u as F,b as Q,r as v,w as j,l as J,q as K,k as Y,R as G,J as X,S as Z,A as M}from"./vendor-vue.74273b34.js";import{a as V}from"./vite.5ce4fca4.js";const ee=["aria-expanded"],te=o("span",{class:"i-mdi-menu"},null,-1),ne=[te],P=y({__name:"TableOfContentsButton",props:{showToc:{type:Boolean}},emits:["update:showToc"],setup(s,{emit:e}){const a=L(s,"showToc",e);function t(){a.value=!0,z(()=>{var l;(l=document.getElementById("__toc-close"))==null||l.focus()})}return(l,c)=>T((r(),_("button",{id:"__toc-open",title:"显示文章目录",class:"floating-button text-lg bottom-24","aria-haspopup":"dialog","aria-controls":"__toc","aria-expanded":$(a),onClick:t},ne,8,ee)),[[S,!$(a)]])}}),oe=["id"],se=["href"],le={class:"sr-only"},ae=["innerHTML"],ce={key:0,class:"animate-appear pl-4 b-l-2 b-area"},ie=y({__name:"TableOfContentsNode",props:{nodes:null,showAll:{type:Boolean}},setup(s){const e=s;function d(t){return t.children.length===0?t.level===6?"card":"leaf":t.open||e.showAll?"open":"closed"}const a={card:"i-mdi-square-medium",leaf:"i-mdi-circle-medium",open:"i-mdi-chevron-right rotate-90",closed:"i-mdi-chevron-right"};return(t,l)=>{const c=U("table-of-contents-node",!0);return r(),_("ol",null,[(r(!0),_(k,null,W(s.nodes,n=>(r(),_("li",{id:`__toc-item-${n.slug}`,key:n.slug,class:"my-1 relative"},[o("a",{class:D(["transition-color ease-out",n.current&&"text-link"]),href:`#${n.slug}`},[o("span",{class:D(`absolute top-1.2 left--4
                   motion-safe:transition-transform ease-out ${$(a)[d(n)]}`)},null,2),o("span",le,q(d(n))+":",1),o("span",{innerHTML:n.title},null,8,ae)],10,se),(n.open||s.showAll)&&n.children.length>0?(r(),_("div",ce,[b(c,{nodes:n.children,"show-all":s.showAll},null,8,["nodes","show-all"])])):A("v-if",!0)],8,oe))),128))])}}});const re=V(ie,[["__scopeId","data-v-2697c1f9"]]),de={class:"flex flex-wrap gap-2 justify-between items-center pr-4 pl-8 mb-3"},ue=o("h2",{class:"text-xl font-bold"}," 文章目录 ",-1),_e=o("span",{class:"i-mdi-close"},null,-1),pe=[_e],he={key:0},me={class:"ml-auto flex gap-1 items-center"},fe=o("span",null,"展开全部",-1),H=y({__name:"TableOfContentsCommon",props:{headings:null},emits:["close"],setup(s,{emit:e}){const d=s;function a(){e("close"),z(()=>{var p;(p=document.getElementById("__toc-open"))==null||p.focus()})}const{y:t}=F(),{height:l}=Q(),c=v(!1),n=v(),I=v(!0),B=v("");function E(){let p=1/0,u="";d.headings.forEach(({slug:x})=>{var g,w;const C=(w=(g=document.getElementById(x))==null?void 0:g.getBoundingClientRect().top)!=null?w:-1/0,f=C<l.value/3?Math.abs(C):C+1e8;f<p&&(p=f,u=x)}),B.value=u;const h={level:0,title:"",slug:"",open:!0,current:!1,children:[],parent:null};let i=h,R=!0;return d.headings.forEach(({level:x,title:C,slug:f})=>{var N;for(;x<=i.level&&i.parent;)i=i.parent;let g=f===u;if(!g){const m=(N=document.getElementById(f))==null?void 0:N.getBoundingClientRect().top;m&&m>0&&m<l.value&&(g=!0)}const w={level:x,title:C,slug:f,open:g,current:f===u,children:[],parent:i};if(g)for(let m=w;m.parent;m=m.parent)m.parent.open=!0;i.children.push(w),i.parent&&(R=!1),i=w}),I.value=R,h.children}const O=v(E());return j([t,c,l],()=>{O.value=E()},{throttle:100}),J([t,c,l,B],()=>{const p=document.getElementById(`__toc-item-${B.value}`);if(p&&n.value){const u=p.getBoundingClientRect().top,h=n.value.getBoundingClientRect(),i=(u-h.top)/h.height;(i<.2||i>.8)&&(n.value.scrollTop+=u-h.top-h.height/2)}},{debounce:50}),(p,u)=>{const h=re;return r(),_(k,null,[o("div",de,[o("div",{class:"flex items-center"},[ue,o("button",{id:"__toc-close",class:"px-1 text-xl flex items-center",title:"关闭目录","aria-controls":"__toc","aria-expanded":"true",onClick:a},pe)]),I.value?A("v-if",!0):(r(),_("div",he,[o("label",me,[fe,T(o("input",{"onUpdate:modelValue":u[0]||(u[0]=i=>c.value=i),type:"checkbox"},null,512),[[K,c.value]])])]))]),o("div",{ref_key:"tocRoot",ref:n,style:{"max-height":"calc(100% - 2rem)"},class:"overflow-auto overscroll-contain pr-4 pl-8"},[b(h,{nodes:O.value,"show-all":c.value},null,8,["nodes","show-all"])],512)],64)}}}),ge={id:"__toc",class:"sticky top-16 bg-card py-6 m-4 rd-2 w-72 2xl:w-84 3xl:w-96 shadow hidden xl:block","aria-label":"文章目录",style:{"max-height":"calc(100vh - 10rem)"},itemprop:"hasPart",itemscope:"",itemtype:"https://schema.org/WPSideBar"},ve=y({__name:"TableOfContentsSidebar",props:{headings:null},setup(s){const e=v(!0);return(d,a)=>{const t=H,l=P;return r(),_(k,null,[T(o("aside",ge,[b(t,{headings:s.headings,onClose:a[0]||(a[0]=c=>e.value=!1)},null,8,["headings"])],512),[[S,e.value]]),b(l,{"show-toc":e.value,"onUpdate:showToc":a[1]||(a[1]=c=>e.value=c)},null,8,["show-toc"])],64)}}}),we=["aria-hidden"],be=y({__name:"TableOfContentsDrawer",props:{headings:null},setup(s){const e=v(!1),d=Y(()=>e.value?"0":"calc(-5px - var(--toc-width))");return G("Escape",()=>{e.value=!1}),(a,t)=>{const l=H,c=P;return r(),_(k,null,[o("div",{id:"__toc",class:"toc-drawer bg-card py-6 shadow-lg fixed inset-y-0 z-15","aria-label":"文章目录",role:"dialog",style:X({right:$(d)}),"aria-hidden":!e.value},[b(l,{headings:s.headings,onClose:t[0]||(t[0]=n=>e.value=!1)},null,8,["headings"])],12,we),b(c,{"show-toc":e.value,"onUpdate:showToc":t[1]||(t[1]=n=>e.value=n),"aria-haspopup":"dialog"},null,8,["show-toc"]),T(o("div",{"aria-hidden":"true",class:"fixed top-0 bottom-0 left-0 right-0 bg-gray-8 opacity-50 z-10",onClick:t[2]||(t[2]=n=>e.value=!1)},null,512),[[S,e.value]])],64)}}});const ye=V(be,[["__scopeId","data-v-a66e88d8"]]),xe={class:"flex print:hidden"},Te=y({__name:"TableOfContents",props:{headings:null},setup(s){const e=Z("(max-width: 79.9em)");return(d,a)=>{const t=ye,l=ve;return r(),_("div",xe,[$(e)?(r(),M(t,{key:0,headings:s.headings},null,8,["headings"])):(r(),M(l,{key:1,headings:s.headings},null,8,["headings"]))])}}});export{Te as _};
