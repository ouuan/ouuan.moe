var d=[" daum[ /]"," deusu/"," yadirectfetcher","(?:^| )site","(?:^|[^g])news","(?<! (?:channel/|google/))google(?!(app|/google| pixel))","(?<! cu)bot(?:[^\\w]|_|$)","(?<! ya(?:yandex)?)search","(?<!(?:lib))http","(?<![hg]m)score","@[a-z]","\\(at\\)[a-z]","\\[at\\][a-z]","^12345","^<","^[\\w \\.\\-\\(?:\\):]+(?:/v?\\d+(\\.\\d+)?(?:\\.\\d{1,10})?)?(?:,|$)","^[^ ]{50,}$","^active","^ad muncher","^amaya","^anglesharp/","^avsdevicesdk/","^bidtellect/","^biglotron","^bot","^btwebclient/","^clamav[ /]","^client/","^cobweb/","^coccoc","^custom","^ddg[_-]android","^discourse","^dispatch/\\d","^downcast/","^duckduckgo","^facebook","^fdm[ /]\\d","^getright/","^gozilla/","^hatena","^hobbit","^hotzonu","^hwcdn/","^jeode/","^jetty/","^jigsaw","^linkdex","^metauri","^microsoft bits","^movabletype","^mozilla/\\d\\.\\d \\(compatible;?\\)$","^mozilla/\\d\\.\\d \\w*$","^navermailapp","^netsurf","^nuclei","^offline explorer","^php","^postman","^postrank","^python","^rank","^read","^reed","^rest","^serf","^snapchat","^space bison","^svn","^swcd ","^taringa","^thumbor/","^track","^tumblr/","^user-agent:","^valid","^venus/fedoraplanet","^w3c","^webbandit/","^webcopier","^wget","^whatsapp","^xenu link sleuth","^yahoo","^yandex","^zdm/\\d","^zoom marketplace/","^{{.*}}$","adbeat\\.com","appinsights","archive","ask jeeves/teoma","bit\\.ly/","bluecoat drtr","browsex","burpcollaborator","capture","catch","check","chrome-lighthouse","chromeframe","classifier","cloud","crawl","cryptoapi","dareboost","datanyze","dataprovider","dejaclick","dmbrowser","download","evc-batch/","feed","firephp","freesafeip","gomezagent","headless","httrack","hubspot marketing grader","hydra","ibisbrowser","images","inspect","iplabel","ips-agent","java(?!;)","library","mail\\.ru/","manager","monitor","neustar wpm","node","nutch","offbyone","optimize","pageburst","parser","perl","phantom","pingdom","powermarks","preview","proxy","ptst[ /]\\d","reader","reputation","resolver","retriever","rexx;","rigor","robot","rss","scan","scrape","server","sogou","sparkler/","speedcurve","spider","splash","statuscake","stumbleupon\\.com","supercleaner","synapse","synthetic","tools","torrent","trace","transcoder","twingly recon","url","virtuoso","wappalyzer","webglance","webkit2png","whatcms/","wordpress","zgrab"];var h=d;var l=e=>h.map(a=>e?.match(new RegExp(a,"i"))?.[0]).filter(Boolean);var u="feed.ouuan.moe",b="https://plausible.ouuan.moe";async function m(e){let a=new TextEncoder().encode(e),t=await crypto.subtle.digest("SHA-1",a);return Array.from(new Uint8Array(t)).map(o=>o.toString(16).padStart(2,"0")).join("")}async function g(e){let a=e.headers.get("Referer"),t=e.headers.get("User-Agent")||"Unknown UA",s=e.headers.get("CF-Connecting-IP")||"Unknown IP",n=await m(`${t}-${s}`),o=l(t).join(" ");async function i(p,c){try{let r=await fetch(`${b}/api/event`,{method:"POST",headers:{"User-Agent":`${o?"Mozilla/5.0 (X11; Linux x86_64; rv:107.0) Gecko/20100101 Firefox/107.0":t} (${n})`,"Content-Type":"application/json"},body:JSON.stringify({domain:u,name:p,url:e.url,...a&&{referer:a},...c&&{props:JSON.stringify(c)}})});r.ok||console.log(`${r.status}: ${await r.text()}`)}catch(r){console.log(r)}}await i("pageview"),await i("Feed",{bot:o||"Not A Bot"})}var v=e=>{let{request:a}=e;return/\/feed\.(xml|atom|json)\/*$/.test(new URL(a.url).pathname)&&e.waitUntil(g(a)),e.next()};export{v as onRequestGet};
